
     EncTeX -- roz¹íøení TeXu o mo¾nost pøekódování -- popis instalace
     =================================================================
     1. 9. 1997                                             Petr Ol¹ák
     3. 1. 2003

Nejprve popí¹u postup pøi instalaci encTeXu na web2c verze 7.3, kde ji¾
pùvodnì byl originální program TeX kompilován, nebo byl aspoò spu¹tìn
configure (podle pokynù pro instalaci web2c TeXu) a jsou pøipraveny
knihovny TeXu (*.tfm, *.tex apod.) v /usr/local/share/texmf.

V balíku jsou dodáván patch pro verzi web2c 7.3.7 

1. pøejdeme do adresáøe, kde je tex.ch a tex.web:

   $ cd source/TeX/texk/web2c

2. Rozbalíme enctex.tar.gz:

   $ zcat /zdroj/enctex.tar.gz | tar xvf -

3. Aplikujeme zmìnu souboru tex.ch:

   $ patch -p0 <./enctex/enctex.patch-to-7.3.7

   nebo

   $ patch -p0 <./enctex/enctex.patch-to-7.5

   v závislosti na verzi web2c, kterou máme. 
   Soubor enctex.patch-to-7.5 je mo¾né pou¾ít i na web2c 7.4.5,
   co¾ byla aktuální stabilní verze teTeXu. 

   Pokud máte verzi web2c 7.5, pak mù¾ete navíc 
   po aplikaci tohoto patche pou¾ít je¹tì patch
   enc-option.patch-to-7.5, který pøidává pøepínaè -enc do
   pøíkazového øádku (bez nìho není encTeX inicializován) a
   øe¹í spolupráci s TCX tabulkami. Tato dvojice patchù byla zaslána
   Olafu Weberovi k zaøazení do standardní distribuce web2c.

   Doporuèuji pøejít z verze encTeXu Feb. 2003 na verzi Jun. 2004,
   která opravuje nìkteré chyby:

   $ patch -p0 <./enctex/enctex.patch-jun2004

   Pokud tento krok ohlásí chybu pro Hunk #1, je potøeba v souboru
   tex.ch nahradit øetìzec "Feb. 2003" textem "Jun. 2004" manuálnì.
   Ostatní èásti záplaty (hunks) by mìly projít bez problémù.

4. Pøekompilujeme TeX:

   $ make tex

Tento povel v sobì zahrnuje jednak
tangle tex.web tex.ch
co¾ vytvoøí Pascalský kód TeXu tex.p. Dále se provede
./web2c/convert tex.p
tak¾e vznikají jednotlivé moduly tex?.c v jazyce C. Potom se tyto moduly
kompilují kompilátorem jazyka C a nakonec linkují do spustitelného programu
tex. Výsledkem je tedy nový program tex a dále nový inicializaèní soubor
tex.pool.

5. Instalujeme binární program tex a soubor tex.pool do systému
(cesty se ve Va¹em systému mohou mírnì li¹it):

   $ strip tex
   $ su   
   # cp tex /usr/local/bin
   # cp tex.pool /usr/local/share/texmf/web2c

6. Instalujeme vstupní tabulky *.tex z balíku encTeX. Doporuèuji je zaøadit
do adresáøe enctex:

   # mkdir /usr/local/share/texmf/tex/generic/enctex
   # cp enctex/*.tex /usr/local/share/texmf/tex/generic/enctex
   # texhash

7. Inicializujeme znovu formáty. Pro verzi encTeXu z oficiální
web2c-7.5.3 je nutné pou¾ít pøi generování formátù (nikoli pøi pou¾ití
formátu) pøepínaè -enc. Význam tohoto pøepínaèe je vysvìtlen 
v dokumentaci encdoc.tex|dvi|pdf.
Pøíklady proto uvádím s tímto pøepínaèem.

   # cd /usr/local/share/texmf/web2c
   # tex -ini -enc plain
   *\dump
   # tex -ini -enc csplain.ini
   # tex -ini -enc -jobname cslatex cslatex.ini

Pokud chcete hned vyu¾ít nových vlastností TeXu, zkuste instalovat
nìkterý z formátù plain-x-y, napøíklad:

   # tex -ini -enc plain-1250-cs

Viz soubory enctex/plain-*-*.tex a enctex/kam-latex.tex.

8. Pozmìnìný tex.ch ète tangle i pøi kompilaci programù pdftex a
etex. Tyto programy budou tedy po kompilaci také obsahovat encTeX.
Pøi po¾ití enctex.patch-to-7.3 se kromì tex.ch pozmìnil v drobné 
malièkosti i soubor pdftexdir/tex.pch, co¾ je nutné pro zdárnou
kompilaci. Staèí tedy vytvoøit pdftex obvyklým zpùsobem:

   $ make pdftex
   $ strip pdftex
   $ su
   # cp pdftex /usr/local/bin
   # cp pdftex.pool /usr/local/share/texmf/web2c
   # cd /usr/local/share/texmf/web2c
   # pdftex -ini -enc -jobname pdfplain plain
   *\dump
   # pdftex -ini -enc -jobname pdfcsplain csplain.ini
   # pdftex -ini -enc -jobname pdfcslatex cslatex.ini

9. Program Omega není encTeXem pozmìnìn, proto¾e pøi své kompilaci
nenaèítá tex.ch. Taky by to nemìlo ¾ádnou logiku, proto¾e omega má
svùj vlastní konfigurovatelný input procesor.   

--------------

Proto¾e encTeX pozmìòuje pouze velmi málo vìcí ve zmìnovém souboru
tex.ch, je mo¾né jej pøi tro¹e ruèní práce instalovat i na jiných
implementacích TeXu, kde jsou k dispozici zdrojové texty TeXu tex.web
a tex.ch.  Staèí se podívat do souboru enctex.ch, kde je patrné, jaké
zmìny se mají provést. Ve¹kerý kód encTeXu se opírá o standardní
èásti programu tex.web s výjimkou ukládání vektorù xord a xchr do
formátu.  Zde jsem s výhodou pou¾il ji¾ hotové pomocné funkce
dump_things a undump_things napsané pro web2c pøímo v jazyce C. Pokud
by to nìkdo potøeboval v jiné implementaci, musel by zøejmì pou¾ít
analogii k dump_four_ASCII z tex.web.


