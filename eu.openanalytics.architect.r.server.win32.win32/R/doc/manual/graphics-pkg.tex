
\chapter{The \texttt{graphics} package}
\HeaderA{graphics-package}{The R Graphics Package}{graphics.Rdash.package}
\aliasA{graphics}{graphics-package}{graphics}
\keyword{package}{graphics-package}
%
\begin{Description}\relax
R functions for base graphics
\end{Description}
%
\begin{Details}\relax
This package contains functions for `base' graphics.  Base graphics
are traditional S-like graphics, as opposed to the more recent
\LinkA{grid}{grid.Rdash.package} graphics. 

For a complete list of functions with individual help pages,
use \code{library(help="graphics")}.
\end{Details}
%
\begin{Author}\relax
R Core Team and contributors worldwide

Maintainer: R Core Team \email{R-core@r-project.org}
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
\HeaderA{abline}{Add Straight Lines to a Plot}{abline}
\keyword{aplot}{abline}
%
\begin{Description}\relax
This function adds one or more straight lines through the current plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
abline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{a, b}] the intercept and slope, single values.
\item[\code{untf}] logical asking whether to \emph{untransform}.  See
`Details'.
\item[\code{h}] the y-value(s) for horizontal line(s).
\item[\code{v}] the x-value(s) for vertical line(s).
\item[\code{coef}] a vector of length two giving the intercept and slope.
\item[\code{reg}] an object with a \code{\LinkA{coef}{coef}} method.  See `Details'.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} such as
\code{col}, \code{lty} and  \code{lwd} (possibly as vectors: see
`Details') and \code{xpd} and the line characteristics
\code{lend}, \code{ljoin} and \code{lmitre}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Typical usages are
\begin{alltt}abline(a, b, untf = FALSE, ...)
abline(h=, untf = FALSE, ...)
abline(v=, untf = FALSE, ...)
abline(coef=, untf = FALSE, ...)
abline(reg=, untf = FALSE, ...)
\end{alltt}

The first form specifies the line in intercept/slope form
(alternatively \code{a} can be specified on its own and is taken to
contain the slope and intercept in vector form).

The \code{h=} and \code{v=} forms draw horizontal and vertical lines
at the specified coordinates.

The \code{coef} form specifies the line by a vector containing the
slope and intercept.

\code{reg} is a regression object with a \code{\LinkA{coef}{coef}} method.
If this returns a vector of length 1 then the value is taken to be the
slope of a line through the origin, otherwise, the first 2 values are
taken to be the intercept and slope.

If \code{untf} is true, and one or both axes are log-transformed, then
a curve is drawn corresponding to a line in original coordinates,
otherwise a line is drawn in the transformed coordinate system. The
\code{h} and \code{v} parameters always refer to original coordinates.

The \LinkA{graphical parameters}{graphical parameters} \code{col}, \code{lty} and \code{lwd}
can be specified; see \code{\LinkA{par}{par}} for details.  For the
\code{h=} and \code{v=} usages they can be vectors of length greater
than one, recycled as necessary.

Specifying an \code{xpd} argument for clipping overrides
the global \code{\LinkA{par}{par}("xpd")} setting used otherwise.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{lines}{lines}} and \code{\LinkA{segments}{segments}} for connected and
arbitrary lines given by their \emph{endpoints}.
\code{\LinkA{par}{par}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Setup up coordinate system (with x==y aspect ratio):
plot(c(-2,3), c(-1,5), type = "n", xlab="x", ylab="y", asp = 1)
## the x- and y-axis, and an integer grid
abline(h=0, v=0, col = "gray60")
text(1,0, "abline( h = 0 )", col = "gray60", adj = c(0, -.1))
abline(h = -1:5, v = -2:3, col = "lightgray", lty=3)
abline(a=1, b=2, col = 2)
text(1,3, "abline( 1, 2 )", col=2, adj=c(-.1,-.1))

## Simple Regression Lines:
require(stats)
sale5 <- c(6, 4, 9, 7, 6, 12, 8, 10, 9, 13)
plot(sale5)
abline(lsfit(1:10,sale5))
abline(lsfit(1:10,sale5, intercept = FALSE), col= 4) # less fitting

z <- lm(dist ~ speed, data = cars)
plot(cars)
abline(z) # equivalent to abline(reg = z) or
abline(coef = coef(z))

## trivial intercept model
abline(mC <- lm(dist ~ 1, data = cars)) ## the same as
abline(a = coef(mC), b = 0, col = "blue")
\end{ExampleCode}
\end{Examples}
\HeaderA{arrows}{Add Arrows to a Plot}{arrows}
\keyword{aplot}{arrows}
%
\begin{Description}\relax
Draw arrows between pairs of points.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
arrows(x0, y0, x1 = x0, y1 = y0, length = 0.25, angle = 30,
       code = 2, col = par("fg"), lty = par("lty"),
       lwd = par("lwd"), ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x0, y0}] coordinates of points \bold{from} which to draw.
\item[\code{x1, y1}] coordinates of points \bold{to} which to draw.  At least
one must the supplied
\item[\code{length}] length of the edges of the arrow head (in inches).
\item[\code{angle}] angle from the shaft of the arrow to the edge of the
arrow head.
\item[\code{code}] integer code, determining \emph{kind} of arrows to be
drawn.
\item[\code{col, lty, lwd}] \LinkA{graphical parameters}{graphical parameters}, possible vectors.
\code{NA} values in \code{col} cause the arrow to be omitted.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} such as \code{xpd} and the line
characteristics \code{lend}, \code{ljoin} and \code{lmitre}:
see \code{\LinkA{par}{par}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For each \code{i}, an arrow is drawn between the point \code{(x0[i],
    y0[i])} and the point \code{(x1[i],y1[i])}.  The coordinate vectors
will be recycled to the length of the longest.

If \code{code=1} an arrowhead is drawn at \code{(x0[i],y0[i])} and if
\code{code=2} an arrowhead is drawn at \code{(x1[i],y1[i])}.  If
\code{code=3} a head is drawn at both ends of the arrow.  Unless
\code{length = 0}, when no head is drawn.

The \LinkA{graphical parameters}{graphical parameters} \code{col}, \code{lty} and \code{lwd}
can be vectors of length greater than one and will be recycled if
necessary.


The direction of a zero-length arrow is indeterminate, and hence so is
the direction of the arrowheads.  To allow for rounding error,
arrowheads are omitted (with a warning) on any arrow of length less
than 1/1000 inch.
\end{Details}
%
\begin{Note}\relax
The first four arguments in the comparable S function are named
\code{x1,y1,x2,y2}.
\end{Note}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{segments}{segments}} to draw segments.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- stats::runif(12); y <- stats::rnorm(12)
i <- order(x,y); x <- x[i]; y <- y[i]
plot(x,y, main="arrows(.) and segments(.)")
## draw arrows from point to point :
s <- seq(length(x)-1)# one shorter than data
arrows(x[s], y[s], x[s+1], y[s+1], col= 1:3)
s <- s[-length(s)]
segments(x[s], y[s], x[s+2], y[s+2], col= 'pink')
\end{ExampleCode}
\end{Examples}
\HeaderA{assocplot}{Association Plots}{assocplot}
\keyword{hplot}{assocplot}
%
\begin{Description}\relax
Produce a Cohen-Friendly association plot indicating deviations from
independence of rows and columns in a 2-dimensional contingency
table.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
assocplot(x, col = c("black", "red"), space = 0.3,
          main = NULL, xlab = NULL, ylab = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a two-dimensional contingency table in matrix form.
\item[\code{col}] a character vector of length two giving the colors used for
drawing positive and negative Pearson residuals, respectively.
\item[\code{space}] the amount of space (as a fraction of the average
rectangle width and height) left between each rectangle.
\item[\code{main}] overall title for the plot.
\item[\code{xlab}] a label for the x axis.  Defaults to the name (if any) of
the row dimension in \code{x}.
\item[\code{ylab}] a label for the y axis.  Defaults to the name (if any) of
the column dimension in \code{x}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For a two-way contingency table, the signed contribution to Pearson's
\eqn{\chi^2}{} for cell \eqn{i, j}{} is \eqn{d_{ij} = (f_{ij} -
    e_{ij}) / \sqrt{e_{ij}}}{},
where \eqn{f_{ij}}{} and \eqn{e_{ij}}{} are the observed and expected
counts corresponding to the cell.  In the Cohen-Friendly association
plot, each cell is represented by a rectangle that has (signed) height
proportional to \eqn{d_{ij}}{} and width proportional to
\eqn{\sqrt{e_{ij}}}{}, so that the area of the box is
proportional to the difference in observed and expected frequencies.
The rectangles in each row are positioned relative to a baseline
indicating independence (\eqn{d_{ij} = 0}{}).  If the observed frequency
of a cell is greater than the expected one, the box rises above the
baseline and is shaded in the color specified by the first element of
\code{col}, which defaults to black; otherwise, the box falls below
the baseline and is shaded in the color specified by the second
element of \code{col}, which defaults to red.

A more flexible and extensible implementation of association plots
written in the grid graphics system is provided in the function
\code{\LinkA{assoc}{assoc}} in the contributed package \Rhref{http://CRAN.R-project.org/package=vcd}{\pkg{vcd}}
(Meyer, Zeileis and Hornik, 2005).
\end{Details}
%
\begin{References}\relax
Cohen, A. (1980),
On the graphical display of the significant components in a two-way
contingency table.
\emph{Communications in Statistics---Theory and Methods}, \bold{A9},
1025--1041.

Friendly, M. (1992),
Graphical methods for categorical data.
\emph{SAS User Group International Conference Proceedings}, \bold{17},
190--200.
\url{http://www.math.yorku.ca/SCS/sugi/sugi17-paper.html}

Meyer, D., Zeileis, A., and Hornik, K. (2005)
The strucplot framework: Visualizing multi-way contingency tables with vcd.
\emph{Report 22}, Department of Statistics and Mathematics, 
WirtschaftsuniversitÃ¤t Wien, Research Report Series.
\url{http://epub.wu.ac.at/dyn/openURL?id=oai:epub.wu-wien.ac.at:epub-wu-01_8a1}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{mosaicplot}{mosaicplot}}, \code{\LinkA{chisq.test}{chisq.test}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Aggregate over sex:
x <- margin.table(HairEyeColor, c(1, 2))
x
assocplot(x, main = "Relation between hair and eye color")
\end{ExampleCode}
\end{Examples}
\HeaderA{Axis}{Generic Function to Add an Axis to a Plot}{Axis}
\keyword{aplot}{Axis}
%
\begin{Description}\relax
Generic function to add a suitable axis to the current plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
Axis(x = NULL, at = NULL, ..., side, labels = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an object which indicates the range over which an axis should
be drawn
\item[\code{at}] the points at which tick-marks are to be drawn.
\item[\code{side}] an integer specifying which side of the plot the axis is
to be drawn on.  The axis is placed as follows: 1=below,
2=left, 3=above and 4=right.
\item[\code{labels}] this can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a
character or expression vector of labels to be placed at the
tickpoints. If this is specified as a character or expression
vector, \code{at} should be supplied and they should be the same
length.
\item[\code{...}] Arguments to be passed to methods and perhaps then to
\code{\LinkA{axis}{axis}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This is a generic function.  It works in a slightly non-standard way:
if \code{x} is supplied and non-NULL it dispatches on \code{x},
otherwise if \code{at} is supplied and non-NULL it dispatches on \code{at},
and the default action is to call \code{\LinkA{axis}{axis}}, omitting argument
\code{x}.

The idea is that for plots for which either or both of the axes are
numerical but with a special interpretation, the standard plotting
functions (including \code{\LinkA{boxplot}{boxplot}}, \code{\LinkA{contour}{contour}},
\code{\LinkA{coplot}{coplot}}, \code{\LinkA{filled.contour}{filled.contour}},
\code{\LinkA{pairs}{pairs}}, \code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{rug}{rug}} and
\code{\LinkA{stripchart}{stripchart}}) will set up user coordinates and \code{Axis}
will be called to label them appropriately.

There are \code{"Date"} and \code{"POSIXt"} methods which can pass an
argument \code{format} on to the appropriate \code{axis} method (see
\code{\LinkA{axis.POSIXct}{axis.POSIXct}}).
\end{Details}
%
\begin{Value}
The numeric locations on the axis scale at which tick marks were drawn
when the plot was first drawn (see `Details').

This function is usually invoked for its side effect, which is to add
an axis to an already existing plot.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{axis}{axis}}.
\end{SeeAlso}
\HeaderA{axis}{Add an Axis to a Plot}{axis}
\keyword{aplot}{axis}
%
\begin{Description}\relax
Adds an axis to the current plot, allowing the
specification of the side, position, labels, and other options.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
axis(side, at = NULL, labels = TRUE, tick = TRUE, line = NA,
     pos = NA, outer = FALSE, font = NA, lty = "solid",
     lwd = 1, lwd.ticks = lwd, col = NULL, col.ticks = NULL,
     hadj = NA, padj = NA, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{side}] an integer specifying which side of the plot the axis is
to be drawn on.  The axis is placed as follows: 1=below,
2=left, 3=above and 4=right.
\item[\code{at}] the points at which tick-marks are to be drawn.  Non-finite
(infinite, \code{NaN} or \code{NA}) values are omitted.  By default
(when \code{NULL}) tickmark locations are computed, see
`Details' below.
\item[\code{labels}] this can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a
character or expression vector of labels to be placed at the
tickpoints.  (Other objects are coerced by \code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}.)
If this is not logical, \code{at} should also be supplied and of the
same length.  If \code{labels} is of length zero after coercion,
it has the same effect as supplying \code{TRUE}.
\item[\code{tick}] a logical value specifying whether tickmarks and an axis line
should be drawn.
\item[\code{line}] the number of lines into the margin at which the axis line
will be drawn, if not \code{NA}.
\item[\code{pos}] the coordinate at which the axis line is to be drawn:
if not \code{NA} this overrides the value of \code{line}.
\item[\code{outer}] a logical value indicating whether the axis should be
drawn in the outer plot margin, rather than the standard plot
margin.
\item[\code{font}] font for text.  Defaults to \code{par("font")}.
\item[\code{lty}] line type for both the axis line and the tick marks.
\item[\code{lwd, lwd.ticks}] line widths for the axis line and the tick
marks. Zero or negative values will suppress the line or ticks.
\item[\code{col, col.ticks}] colors for the axis line and the tick marks
respectively.  \code{col = NULL} means to use \code{par("fg")},
possibly specified inline, and \code{col.ticks = NULL} means to use
whatever color \code{col} resolved to.
\item[\code{hadj}] adjustment (see \code{\LinkA{par}{par}("adj")}) for all labels
\emph{parallel} (`horizontal') to the reading direction.  If
this is not a finite value, the default is used (centring for
strings parallel to the axis, justification of the end nearest the
axis otherwise).
\item[\code{padj}] adjustment for each tick label \emph{perpendicular} to the
reading direction.  For labels parallel to the axes, \code{padj=0}
means right or top alignment, and \code{padj=1} means left or bottom
alignment.  This can be a vector given a value for each string, and
will be recycled as necessary.

If \code{padj} is not a finite value (the default), the value of
\code{par("las")} determines the adjustment.  For strings plotted
perpendicular to the axis the default is to centre the string.

\item[\code{...}] other \LinkA{graphical parameters}{graphical parameters} may also be passed as
arguments to this function, particularly, \code{cex.axis},
\code{col.axis} and \code{font.axis} for axis annotation, \code{mgp}
and \code{xaxp} or \code{yaxp} for positioning, \code{tck} or
\code{tcl} for tick mark length and direction, \code{las} for
vertical/horizontal label orientation, or \code{fg} instead of
\code{col}, and \code{xpd} for clipping.  See \code{\LinkA{par}{par}} on these.

Parameters \code{xaxt} (sides 1 and 3) and \code{yaxt} (sides 2 and
4) control if the axis is plotted at all.

Note that \code{lab} will partial match to argument
\code{labels} unless the latter is also supplied.  (Since the
default axes have already been set up by \code{\LinkA{plot.window}{plot.window}},
\code{lab} will not be acted on by \code{axis}.)
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The axis line is drawn from the lowest to the highest value of
\code{at}, but will be clipped at the plot region.  By default, only
ticks which are drawn from points within the plot region (up to a
tolerance for rounding error) are plotted, but the ticks and their
labels may well extend outside the plot region.  Use \code{xpd=TRUE}
or \code{xpd=NA} to allow axes to extend further.

When \code{at = NULL}, pretty tick mark locations are computed internally
(the same way \code{\LinkA{axTicks}{axTicks}(side)} would) from
\code{\LinkA{par}{par}("xaxp")} or \code{"yaxp"} and
\code{\LinkA{par}{par}("xlog")} (or \code{"ylog"}).  Note that these
locations may change if an on-screen plot is resized (for example, if
the \code{plot} argument \code{asp} (see \code{\LinkA{plot.window}{plot.window}}) is set.)

If \code{labels} is not specified, the numeric values supplied or
calculated for \code{at} are converted to character strings as if they
were a numeric vector printed by \code{\LinkA{print.default}{print.default}(digits=7)}.

The code tries hard not to draw overlapping tick labels, and so will
omit labels where they would abut or overlap previously drawn labels.
This can result in, for example, every other tick being labelled.
(The ticks are drawn left to right or bottom to top, and space at
least the size of an `m' is left between labels.)

If either \code{line} or \code{pos} is set, they (rather than
\code{par("mgp")[3]}) determine the position of the axis line and tick
marks, and the tick labels are placed \code{par("mgp")[2]} further
lines into (or towards for \code{pos}) the margin.

Several of the graphics parameters affect the way axes are drawn. The
vertical (for sides 1 and 3) positions of the axis and the tick labels
are controlled by \code{mgp[2:3]} and \code{mex}, the size and
direction of the ticks is controlled by \code{tck} and \code{tcl} and
the appearance of the tick labels by \code{cex.axis}, \code{col.axis}
and \code{font.axis} with orientation controlled by \code{las} (but
not \code{srt}, unlike S which uses \code{srt} if \code{at} is
supplied and \code{las} if it is not).  Note that \code{adj} is not
supported and labels are always centered.  See \code{\LinkA{par}{par}} for details.
\end{Details}
%
\begin{Value}
The numeric locations on the axis scale at which tick marks were drawn
when the plot was first drawn (see `Details').

This function is usually invoked for its side effect, which is to add
an axis to an already existing plot.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{Axis}{Axis}} for a generic interface.

\code{\LinkA{axTicks}{axTicks}} returns the axis tick locations
corresponding to \code{at=NULL}; \code{\LinkA{pretty}{pretty}} is more flexible
for computing pretty tick coordinates and does \emph{not} depend on
(nor adapt to) the coordinate system in use.

Several graphics parameters affecting the appearance are documented
in \code{\LinkA{par}{par}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats) # for rnorm
plot(1:4, rnorm(4), axes = FALSE)
axis(1, 1:4, LETTERS[1:4])
axis(2)
box() #- to make it look "as usual"

plot(1:7, rnorm(7), main = "axis() examples",
     type = "s", xaxt = "n", frame = FALSE, col = "red")
axis(1, 1:7, LETTERS[1:7], col.axis = "blue")
# unusual options:
axis(4, col = "violet", col.axis="dark violet", lwd = 2)
axis(3, col = "gold", lty = 2, lwd = 0.5)

# one way to have a custom x axis
plot(1:10, xaxt = "n")
axis(1, xaxp=c(2, 9, 7))
\end{ExampleCode}
\end{Examples}
\HeaderA{axis.POSIXct}{Date and Date-time Plotting Functions}{axis.POSIXct}
\aliasA{axis.Date}{axis.POSIXct}{axis.Date}
\keyword{utilities}{axis.POSIXct}
\keyword{chron}{axis.POSIXct}
%
\begin{Description}\relax
Functions to plot objects of classes \code{"POSIXlt"},
\code{"POSIXct"} and \code{"Date"} representing calendar dates and times. 
\end{Description}
%
\begin{Usage}
\begin{verbatim}
axis.POSIXct(side, x, at, format, labels = TRUE, ...)
axis.Date(side, x, at, format, labels = TRUE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, at}] A date-time or date object.
\item[\code{side}] See \code{\LinkA{axis}{axis}}.
\item[\code{format}] See \code{\LinkA{strptime}{strptime}}.
\item[\code{labels}] Either a logical value specifying whether
annotations are to be made at the tickmarks, or a vector of character
strings to be placed at the tickpoints.
\item[\code{...}] Further arguments to be passed from or to other methods,
typically \LinkA{graphical parameters}{graphical parameters}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{axis.POSIXct} and \code{axis.Date} work quite hard to choose
suitable time units (years, months, days, hours, minutes or seconds)
and a sensible output format, but this can be overridden by supplying
a \code{format} specification.

If \code{at} is supplied it specifies the locations of the ticks
and labels whereas if \code{x} is specified a suitable grid of labels
is chosen. Printing of tick labels can be suppressed by using
\code{labels = FALSE}.

The date-times for a \code{"POSIXct"} input are interpreted in the
timezone give by the \code{"tzone"} attribute if there is one,
otherwise the current timezone.

The way the date-times are rendered (especially month names) is
controlled by the locale setting of category \code{"LC\_TIME"} (see
\code{\LinkA{Sys.setlocale}{Sys.setlocale}}.
\end{Details}
%
\begin{Value}
The locations on the axis scale at which tick marks were drawn.
\end{Value}
%
\begin{Note}\relax
These functions are the workhorse for methods for \code{\LinkA{Axis}{Axis}}.
Prior to \R{} 2.12.0 there were also \code{plot} methods for the
date-time classes, but the default method has also handled those for a
long time.
\end{Note}
%
\begin{SeeAlso}\relax
\LinkA{DateTimeClasses}{DateTimeClasses}, \LinkA{Dates}{Dates} for details of the classes.

\code{\LinkA{Axis}{Axis}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
with(beaver1, {
time <- strptime(paste(1990, day, time %/% 100, time %% 100),
                 "%Y %j %H %M")
plot(time, temp, type="l") # axis at 4-hour intervals.
# now label every hour on the time axis
plot(time, temp, type="l", xaxt="n")
r <- as.POSIXct(round(range(time), "hours"))
axis.POSIXct(1, at=seq(r[1], r[2], by="hour"), format="%H")
})

plot(.leap.seconds, seq_along(.leap.seconds), type="n", yaxt="n",
     xlab="leap seconds", ylab="", bty="n")
rug(.leap.seconds)
## or as dates
lps <- as.Date(.leap.seconds)
plot(lps, seq_along(.leap.seconds),
     type = "n", yaxt = "n", xlab = "leap seconds",
     ylab = "", bty = "n")
rug(lps)

## 100 random dates in a 10-week period
random.dates <- as.Date("2001/1/1") + 70*sort(stats::runif(100))
plot(random.dates, 1:100)
# or for a better axis labelling
plot(random.dates, 1:100, xaxt="n")
axis.Date(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "weeks"))
axis.Date(1, at=seq(as.Date("2001/1/1"), max(random.dates)+6, "days"),
     labels = FALSE, tcl = -0.2)
\end{ExampleCode}
\end{Examples}
\HeaderA{axTicks}{Compute Axis Tickmark Locations}{axTicks}
\keyword{dplot}{axTicks}
%
\begin{Description}\relax
Compute pretty tickmark locations, the same way as \R{} does internally.
This is only non-trivial when \bold{log} coordinates are active.
By default, gives the \code{at} values which
\code{\LinkA{axis}{axis}(side)} would use.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
axTicks(side, axp = NULL, usr = NULL, log = NULL, nintLog = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{side}] integer in 1:4, as for \code{\LinkA{axis}{axis}}.
\item[\code{axp}] numeric vector of length three, defaulting to
\code{\LinkA{par}{par}("xaxp")} or \code{\LinkA{par}{par}("yaxp")}
depending on the \code{side} argument (\code{par("xaxp")}
if \code{side} is 1 or 3, \code{par("yaxp")} if side is 2 or 4).
\item[\code{usr}] numeric vector of length two giving user coordinate
limits, defaulting to the relevant portion of
\code{\LinkA{par}{par}("usr")} (\code{par("usr")[1:2]} or
\code{par("usr")[3:4]} for \code{side} in (1,3) or (2,4)
respectively).
\item[\code{log}] logical indicating if log coordinates are active; defaults
to \code{\LinkA{par}{par}("xlog")} or \code{\LinkA{par}{par}("ylog")}
depending on \code{side}.
\item[\code{nintLog}] (only used when \code{log} is true): approximate (lower
bound for the) number of tick intervals; defaults to
\code{\LinkA{par}{par}("lab")[j]} where \code{j} is 1 or 2 depending on
\code{side}.  Set this to \code{Inf} if you want the same behavior
as in earlier \R{} versions (than 2.14.x).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The \code{axp}, \code{usr}, and \code{log} arguments must be consistent
as their default values (the \code{par(..)} results) are.  If you
specify all three (as non-NULL), the graphics environment is not used
at all.  Note that the meaning of \code{axp} differs significantly
when \code{log} is \code{TRUE}; see the documentation on
\code{\LinkA{par}{par}(xaxp=.)}.

\code{axTicks()} can be used an \R{} interface to the C function
\code{CreateAtVector()} in \file{..../src/main/plot.c}
which is called by \code{\LinkA{axis}{axis}(side,*)} when no argument
\code{at} is specified.
The delicate case, \code{log = TRUE}, now makes use of
\code{\LinkA{axisTicks}{axisTicks}} (in package \pkg{grDevices}) unless
\code{nintLog = Inf} which exists for back compatibility.
\end{Details}
%
\begin{Value}
numeric vector of coordinate values at which axis tickmarks can be
drawn.  By default, when only the first argument is specified,
these values should be identical to those that
\code{\LinkA{axis}{axis}(side)} would use or has used.  Note that the values
are decreasing when \code{usr} is (``reverse axis'' case).
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{axis}{axis}}, \code{\LinkA{par}{par}}.  \code{\LinkA{pretty}{pretty}}
uses the same algorithm (but independently of the graphics
environment) and has more options.  However it is not available for
\code{log = TRUE.}

\code{\LinkA{axisTicks}{axisTicks}()} (package \pkg{grDevices}).
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
 plot(1:7, 10*21:27)
 axTicks(1)
 axTicks(2)
 stopifnot(identical(axTicks(1), axTicks(3)),
           identical(axTicks(2), axTicks(4)))

## Show how axTicks() and axis() correspond :
op <- par(mfrow = c(3,1))
for(x in 9999*c(1,2,8)) {
    plot(x,9, log = "x")
    cat(formatC(par("xaxp"), width=5),";", T <- axTicks(1),"\n")
    rug(T, col= adjustcolor("red", 0.5), lwd = 4)
}
par(op)

x <- 9.9*10^(-3:10)
plot(x, 1:14, log = "x")
axTicks(1) # now length 5, in R <= 2.13.x gave the following
axTicks(1, nintLog=Inf) # rather too many

## An example using axTicks() without reference to an existing plot
## (copying R's internal procedures for setting axis ranges etc.),
## You do need to supply _all_ of axp, usr, log, nintLog
## standard logarithmic y axis labels
ylims <- c(0.2, 88)
get_axp <- function(x) 10^c(ceiling(x[1]), floor(x[2]))
## mimic par("yaxs")=="i"
usr.i <- log10(ylims)
(aT.i <- axTicks(side=2, usr=usr.i,
                 axp=c(get_axp(usr.i), n=3), log=TRUE, nintLog=5))
## mimic (default) par("yaxs")=="r"
usr.r <- extendrange(r = log10(ylims), f = 0.04)
(aT.r <- axTicks(side=2, usr=usr.r,
                 axp=c(get_axp(usr.r),3), log=TRUE, nintLog=5))

## Prove that we got it right :
plot(0:1,ylims,log="y",yaxs="i")
stopifnot(all.equal(aT.i, axTicks(side=2)))

plot(0:1,ylims,log="y",yaxs="r")
stopifnot(all.equal(aT.r, axTicks(side=2)))
\end{ExampleCode}
\end{Examples}
\HeaderA{barplot}{Bar Plots}{barplot}
\methaliasA{barplot.default}{barplot}{barplot.default}
\keyword{hplot}{barplot}
%
\begin{Description}\relax
Creates a bar plot with vertical or horizontal bars.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
barplot(height, ...)

## Default S3 method:
barplot(height, width = 1, space = NULL,
        names.arg = NULL, legend.text = NULL, beside = FALSE,
        horiz = FALSE, density = NULL, angle = 45,
        col = NULL, border = par("fg"),
        main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
        xlim = NULL, ylim = NULL, xpd = TRUE, log = "",
        axes = TRUE, axisnames = TRUE,
        cex.axis = par("cex.axis"), cex.names = par("cex.axis"),
        inside = TRUE, plot = TRUE, axis.lty = 0, offset = 0,
        add = FALSE, args.legend = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{height}] either a vector or matrix of values describing the
bars which make up the plot.  If \code{height} is a vector, the
plot consists of a sequence of rectangular bars with heights
given by the values in the vector.  If \code{height} is a matrix
and \code{beside} is \code{FALSE} then each bar of the plot
corresponds to a column of \code{height}, with the values in the
column giving the heights of stacked sub-bars making up the
bar.  If \code{height} is a matrix and \code{beside} is
\code{TRUE}, then the values in each column are juxtaposed
rather than stacked.
\item[\code{width}] optional vector of bar widths. Re-cycled to length the
number of bars drawn.  Specifying a single value will have no 
visible effect unless \code{xlim} is specified.
\item[\code{space}] the amount of space (as a fraction of the average bar
width) left before each bar.  May be given as a single number or
one number per bar.  If \code{height} is a matrix and
\code{beside} is \code{TRUE}, \code{space} may be specified by
two numbers, where the first is the space between bars in the
same group, and the second the space between the groups.  If not
given explicitly, it defaults to \code{c(0,1)} if \code{height}
is a matrix and \code{beside} is \code{TRUE}, and to 0.2
otherwise.
\item[\code{names.arg}] a vector of names to be plotted below each bar or
group of bars.  If this argument is omitted, then the names are
taken from the \code{names} attribute of \code{height} if this
is a vector, or the column names if it is a matrix.
\item[\code{legend.text}] a vector of text used to construct a legend for
the plot, or a logical indicating whether a legend should be
included.  This is only useful when \code{height} is a matrix.
In that case given legend labels should correspond to the rows of
\code{height}; if \code{legend.text} is true, the row names of
\code{height} will be used as labels if they are non-null.
\item[\code{beside}] a logical value.  If \code{FALSE}, the columns of
\code{height} are portrayed as stacked bars, and if \code{TRUE}
the columns are portrayed as juxtaposed bars.
\item[\code{horiz}] a logical value.  If \code{FALSE}, the bars are drawn
vertically with the first bar to the left.  If \code{TRUE}, the
bars are drawn horizontally with the first at the bottom.
\item[\code{density}] a vector giving the density of shading lines, in
lines per inch, for the bars or bar components.
The default value of \code{NULL} means that no shading lines
are drawn. Non-positive values of \code{density} also inhibit the
drawing of shading lines.
\item[\code{angle}] the slope of shading lines, given as an angle in
degrees (counter-clockwise), for the bars or bar components.
\item[\code{col}] a vector of colors for the bars or bar components.
By default, grey is used if \code{height} is a vector, and a
gamma-corrected grey palette if \code{height} is a matrix.
\item[\code{border}] the color to be used for the border of the bars.
Use \code{border = NA} to omit borders.  If there are shading
lines, \code{border = TRUE} means use the same colour for
the border as for the shading lines.
\item[\code{main,sub}] overall and sub title for the plot.
\item[\code{xlab}] a label for the x axis.
\item[\code{ylab}] a label for the y axis.
\item[\code{xlim}] limits for the x axis.
\item[\code{ylim}] limits for the y axis.
\item[\code{xpd}] logical. Should bars be allowed to go outside region?
\item[\code{log}] string specifying if axis scales should be logarithmic; see
\code{\LinkA{plot.default}{plot.default}}.
\item[\code{axes}] logical.  If \code{TRUE}, a vertical (or horizontal, if
\code{horiz} is true) axis is drawn.
\item[\code{axisnames}] logical.  If \code{TRUE}, and if there are
\code{names.arg} (see above), the
other axis is drawn (with \code{lty=0}) and labeled.
\item[\code{cex.axis}] expansion factor for numeric axis labels.
\item[\code{cex.names}] expansion factor for axis names (bar labels).
\item[\code{inside}] logical.  If \code{TRUE}, the lines which divide
adjacent (non-stacked!) bars will be drawn.  Only applies when
\code{space = 0} (which it partly is when \code{beside = TRUE}).


\item[\code{plot}] logical.  If \code{FALSE}, nothing is plotted.
\item[\code{axis.lty}] the graphics parameter \code{lty} applied to the axis
and tick marks of the categorical (default horizontal) axis.  Note
that by default the axis is suppressed.
\item[\code{offset}] a vector indicating how much the bars should be shifted
relative to the x axis.
\item[\code{add}] logical specifying if bars should be added to an already
existing plot; defaults to \code{FALSE}.
\item[\code{args.legend}] list of additional arguments to pass to
\code{\LinkA{legend}{legend}()}; names of the list are used as argument
names.  Only used if \code{legend.text} is supplied.
\item[\code{...}] arguments to be passed to/from other methods.  For the
default method these can include further arguments (such as
\code{axes}, \code{asp} and \code{main}) and
\LinkA{graphical parameters}{graphical parameters} (see \code{\LinkA{par}{par}}) which are passed to
\code{\LinkA{plot.window}{plot.window}()}, \code{\LinkA{title}{title}()} and
\code{\LinkA{axis}{axis}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This is a generic function, it currently only has a default method.
A formula interface may be added eventually.
\end{Details}
%
\begin{Value}
A numeric vector (or matrix, when \code{beside = TRUE}), say
\code{mp}, giving the coordinates of \emph{all} the bar midpoints
drawn, useful for adding to the graph.

If \code{beside} is true, use \code{colMeans(mp)} for the
midpoints of each \emph{group} of bars, see example.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot}{plot}(..., type="h")}, \code{\LinkA{dotchart}{dotchart}},
\code{\LinkA{hist}{hist}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices) # for colours
tN <- table(Ni <- stats::rpois(100, lambda=5))
r <- barplot(tN, col=rainbow(20))
#- type = "h" plotting *is* 'bar'plot
lines(r, tN, type='h', col='red', lwd=2)

barplot(tN, space = 1.5, axisnames=FALSE,
        sub = "barplot(..., space= 1.5, axisnames = FALSE)")

barplot(VADeaths, plot = FALSE)
barplot(VADeaths, plot = FALSE, beside = TRUE)

mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
        col = c("lightblue", "mistyrose", "lightcyan",
                "lavender", "cornsilk"),
        legend = rownames(VADeaths), ylim = c(0, 100))
title(main = "Death Rates in Virginia", font.main = 4)

hh <- t(VADeaths)[, 5:1]
mybarcol <- "gray20"
mp <- barplot(hh, beside = TRUE,
        col = c("lightblue", "mistyrose",
                "lightcyan", "lavender"),
        legend = colnames(VADeaths), ylim= c(0,100),
        main = "Death Rates in Virginia", font.main = 4,
        sub = "Faked upper 2*sigma error bars", col.sub = mybarcol,
        cex.names = 1.5)
segments(mp, hh, mp, hh + 2*sqrt(1000*hh/100), col = mybarcol, lwd = 1.5)
stopifnot(dim(mp) == dim(hh))# corresponding matrices
mtext(side = 1, at = colMeans(mp), line = -2,
      text = paste("Mean", formatC(colMeans(hh))), col = "red")

# Bar shading example
barplot(VADeaths, angle = 15+10*1:5, density = 20, col = "black",
        legend = rownames(VADeaths))
title(main = list("Death Rates in Virginia", font = 4))

# border :
barplot(VADeaths, border = "dark blue") 


# log scales (not much sense here):
barplot(tN, col=heat.colors(12), log = "y")
barplot(tN, col=gray.colors(20), log = "xy")

# args.legend
barplot(height = cbind(x = c(465, 91) / 465 * 100,
                       y = c(840, 200) / 840 * 100,
                       z = c(37, 17) / 37 * 100),
        beside = FALSE,
        width = c(465, 840, 37),
        col = c(1, 2),
        legend.text = c("A", "B"),
        args.legend = list(x = "topleft"))
\end{ExampleCode}
\end{Examples}
\HeaderA{box}{Draw a Box around a Plot}{box}
\keyword{aplot}{box}
%
\begin{Description}\relax
This function draws a box around the current plot in the given color
and linetype.  The \code{bty} parameter determines
the type of box drawn.  See \code{\LinkA{par}{par}} for details.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
box(which = "plot", lty = "solid", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{which}] character, one of \code{"plot"}, \code{"figure"},
\code{"inner"} and \code{"outer"}.
\item[\code{lty}] line type of the box.
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters}, such as \code{bty},
\code{col}, or \code{lwd}, see \code{\LinkA{par}{par}}.  Note that
\code{xpd} is not accepted as clipping is always to the device
region.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The choice of colour is complicated.  If \code{col} was supplied
and is not \code{NA}, it is used.  Otherwise, if \code{fg} was supplied
and is not \code{NA}, it is used.  The final default is \code{par("col")}.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{rect}{rect}} for drawing of arbitrary rectangles.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(1:7, abs(stats::rnorm(7)), type = 'h', axes = FALSE)
axis(1, at = 1:7, labels = letters[1:7])
box(lty = '1373', col = 'red')
\end{ExampleCode}
\end{Examples}
\HeaderA{boxplot}{Box Plots}{boxplot}
\methaliasA{boxplot.default}{boxplot}{boxplot.default}
\methaliasA{boxplot.formula}{boxplot}{boxplot.formula}
\keyword{hplot}{boxplot}
%
\begin{Description}\relax
Produce box-and-whisker plot(s) of the given (grouped) values.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
boxplot(x, ...)

## S3 method for class 'formula'
boxplot(formula, data = NULL, ..., subset, na.action = NULL)

## Default S3 method:
boxplot(x, ..., range = 1.5, width = NULL, varwidth = FALSE,
        notch = FALSE, outline = TRUE, names, plot = TRUE,
        border = par("fg"), col = NULL, log = "",
        pars = list(boxwex = 0.8, staplewex = 0.5, outwex = 0.5),
        horizontal = FALSE, add = FALSE, at = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{formula}] a formula, such as \code{y \textasciitilde{} grp}, where \code{y} is a
numeric vector of data values to be split into groups according to
the grouping variable \code{grp} (usually a factor).
\item[\code{data}] a data.frame (or list) from which the variables in
\code{formula} should be taken.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used for plotting.
\item[\code{na.action}] a function which indicates what should happen
when the data contain \code{NA}s.  The default is to ignore missing
values in either the response or the group.
\item[\code{x}] for specifying data from which the boxplots are to be
produced. Either a numeric vector, or a single list containing such
vectors. Additional unnamed arguments specify further data
as separate vectors (each corresponding to a component boxplot).
\code{\LinkA{NA}{NA}}s are allowed in the data.
\item[\code{...}] For the \code{formula} method, named arguments to be passed to
the default method.

For the default method, unnamed arguments are additional data
vectors (unless \code{x} is a list when they are ignored), and named
arguments are arguments and \LinkA{graphical parameters}{graphical parameters} to be passed
to \code{\LinkA{bxp}{bxp}} in addition to the ones given by argument
\code{pars} (and override those in \code{pars}). Note that
\code{bxp} may or may not make use of graphical parameters it is
passed: see its documentation.

\item[\code{range}] this determines how far the plot whiskers extend out
from the box.  If \code{range} is positive, the whiskers extend
to the most extreme data point which is no more than
\code{range} times the interquartile range from the box. A value
of zero causes the whiskers to extend to the data extremes.
\item[\code{width}] a vector giving the relative widths of the boxes making
up the plot.
\item[\code{varwidth}] if \code{varwidth} is \code{TRUE}, the boxes are
drawn with widths proportional to the square-roots of the number
of observations in the groups.
\item[\code{notch}] if \code{notch} is \code{TRUE}, a notch is drawn in
each side of the boxes.  If the notches of two plots do not
overlap this is `strong evidence' that the two medians differ
(Chambers \emph{et al.}, 1983, p. 62).  See \code{\LinkA{boxplot.stats}{boxplot.stats}}
for the calculations used.
\item[\code{outline}] if \code{outline} is not true, the outliers are
not drawn (as points whereas S+ uses lines).
\item[\code{names}] group labels which will be printed under each boxplot.
Can be a character vector or an \LinkA{expression}{expression} (see
\LinkA{plotmath}{plotmath}).
\item[\code{boxwex}] a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved
by making the boxes narrower.
\item[\code{staplewex}] staple line width expansion, proportional to box
width.
\item[\code{outwex}] outlier line width expansion, proportional to box
width.
\item[\code{plot}] if \code{TRUE} (the default) then a boxplot is
produced.  If not, the summaries which the boxplots are based on
are returned.
\item[\code{border}] an optional vector of colors for the outlines of the
boxplots.  The values in \code{border} are recycled if the
length of \code{border} is less than the number of plots.
\item[\code{col}] if \code{col} is non-null it is assumed to contain colors
to be used to colour the bodies of the box plots. By default they
are in the background colour.
\item[\code{log}] character indicating if x or y or both coordinates should
be plotted in log scale.
\item[\code{pars}] a list of (potentially many) more graphical parameters,
e.g., \code{boxwex} or \code{outpch}; these are passed to
\code{\LinkA{bxp}{bxp}} (if \code{plot} is true); for details, see there.
\item[\code{horizontal}] logical indicating if the boxplots should be
horizontal; default \code{FALSE} means vertical boxes.
\item[\code{add}] logical, if true \emph{add} boxplot to current plot.
\item[\code{at}] numeric vector giving the locations where the boxplots should
be drawn, particularly when \code{add = TRUE};
defaults to \code{1:n} where \code{n} is the number of boxes.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The generic function \code{boxplot} currently has a default method
(\code{boxplot.default}) and a formula interface (\code{boxplot.formula}).

If multiple groups are supplied either as multiple arguments or via a
formula, parallel boxplots will be plotted, in the order of the
arguments or the order of the levels of the factor (see
\code{\LinkA{factor}{factor}}).

Missing values are ignored when forming boxplots.
\end{Details}
%
\begin{Value}
List with the following components:
\begin{ldescription}
\item[\code{stats}] a matrix, each column contains the extreme of the lower
whisker, the lower hinge, the median, the upper hinge and the
extreme of the upper whisker for one group/plot.  If all the inputs
have the same class attribute, so will this component.
\item[\code{n}] a vector with the number of observations in each group.
\item[\code{conf}] a matrix where each column contains the lower and upper
extremes of the notch.
\item[\code{out}] the values of any data points which lie beyond the
extremes of the whiskers.
\item[\code{group}] a vector of the same length as \code{out} whose elements
indicate to which group the outlier belongs.
\item[\code{names}] a vector of names for the groups.
\end{ldescription}
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983)
\emph{Graphical Methods for Data Analysis.}  Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.

See also \code{\LinkA{boxplot.stats}{boxplot.stats}}.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{boxplot.stats}{boxplot.stats}} which does the computation,
\code{\LinkA{bxp}{bxp}} for the plotting and more examples;
and \code{\LinkA{stripchart}{stripchart}} for an alternative (with small data
sets).
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## boxplot on a formula:
boxplot(count ~ spray, data = InsectSprays, col = "lightgray")
# *add* notches (somewhat funny here):
boxplot(count ~ spray, data = InsectSprays,
        notch = TRUE, add = TRUE, col = "blue")

boxplot(decrease ~ treatment, data = OrchardSprays,
        log = "y", col = "bisque")

rb <- boxplot(decrease ~ treatment, data = OrchardSprays, col="bisque")
title("Comparing boxplot()s and non-robust mean +/- SD")

mn.t <- tapply(OrchardSprays$decrease, OrchardSprays$treatment, mean)
sd.t <- tapply(OrchardSprays$decrease, OrchardSprays$treatment, sd)
xi <- 0.3 + seq(rb$n)
points(xi, mn.t, col = "orange", pch = 18)
arrows(xi, mn.t - sd.t, xi, mn.t + sd.t,
       code = 3, col = "pink", angle = 75, length = .1)

## boxplot on a matrix:
mat <- cbind(Uni05 = (1:100)/21, Norm = rnorm(100),
             `5T` = rt(100, df = 5), Gam2 = rgamma(100, shape = 2))
boxplot(as.data.frame(mat),
        main = "boxplot(as.data.frame(mat), main = ...)")
par(las=1)# all axis labels horizontal
boxplot(as.data.frame(mat), main = "boxplot(*, horizontal = TRUE)",
        horizontal = TRUE)

## Using 'at = ' and adding boxplots -- example idea by Roger Bivand :

boxplot(len ~ dose, data = ToothGrowth,
        boxwex = 0.25, at = 1:3 - 0.2,
        subset = supp == "VC", col = "yellow",
        main = "Guinea Pigs' Tooth Growth",
        xlab = "Vitamin C dose mg",
        ylab = "tooth length",
        xlim = c(0.5, 3.5), ylim = c(0, 35), yaxs = "i")
boxplot(len ~ dose, data = ToothGrowth, add = TRUE,
        boxwex = 0.25, at = 1:3 + 0.2,
        subset = supp == "OJ", col = "orange")
legend(2, 9, c("Ascorbic acid", "Orange juice"),
       fill = c("yellow", "orange"))

## more examples in  help(bxp)
\end{ExampleCode}
\end{Examples}
\HeaderA{boxplot.matrix}{Draw a Boxplot for each Column (Row) of a Matrix}{boxplot.matrix}
\keyword{hplot}{boxplot.matrix}
%
\begin{Description}\relax
Interpreting the columns (or rows) of a matrix as different groups, draw a
boxplot for each.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'matrix'
boxplot(x, use.cols = TRUE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a numeric matrix.
\item[\code{use.cols}] logical indicating if columns (by default) or rows
(\code{use.cols=FALSE}) should be plotted.
\item[\code{...}] Further arguments to \code{\LinkA{boxplot}{boxplot}}.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list as for \code{\LinkA{boxplot}{boxplot}}.
\end{Value}
%
\begin{Author}\relax
Martin Maechler, 1995, for S+, then \R{} package \Rhref{http://CRAN.R-project.org/package=sfsmisc}{\pkg{sfsmisc}}.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{boxplot.default}{boxplot.default}} which already works nowadays with
data.frames; \code{\LinkA{boxplot.formula}{boxplot.formula}}, \code{\LinkA{plot.factor}{plot.factor}} which
work with (the more general concept) of a grouping factor.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Very similar to the example in ?boxplot
mat <- cbind(Uni05 = (1:100)/21, Norm = rnorm(100),
             T5 = rt(100, df = 5), Gam2 = rgamma(100, shape = 2))
boxplot(mat, main = "boxplot.matrix(...., main = ...)",
        notch = TRUE, col = 1:4)
\end{ExampleCode}
\end{Examples}
\HeaderA{bxp}{Draw Box Plots from Summaries}{bxp}
\keyword{aplot}{bxp}
%
\begin{Description}\relax
\code{bxp} draws box plots based on the given summaries in \code{z}.
It is usually called from within \code{\LinkA{boxplot}{boxplot}}, but can be
invoked directly.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
bxp(z, notch = FALSE, width = NULL, varwidth = FALSE,
    outline = TRUE, notch.frac = 0.5, log = "",
    border = par("fg"), pars = NULL, frame.plot = axes,
    horizontal = FALSE, add = FALSE, at = NULL, show.names = NULL,
    ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{z}] a list containing data summaries to be used in constructing
the plots.  These are usually the result of a call to
\code{\LinkA{boxplot}{boxplot}}, but can be generated in any fashion.
\item[\code{notch}] if \code{notch} is \code{TRUE}, a notch is drawn in each
side of the boxes.  If the notches of two plots do not overlap then
the medians are significantly different at the 5 percent level.
\item[\code{width}] a vector giving the relative widths of the boxes making
up the plot.
\item[\code{varwidth}] if \code{varwidth} is \code{TRUE}, the boxes are drawn
with widths proportional to the square-roots of the number of
observations in the groups.
\item[\code{outline}] if \code{outline} is not true, the outliers are not
drawn.
\item[\code{notch.frac}] numeric in (0,1). When \code{notch=TRUE}, the
fraction of the box width that the notches should use.
\item[\code{border}] character or numeric (vector), the color of the box
borders.  Is recycled for multiple boxes.  Is used as default for
the \code{boxcol}, \code{medcol}, \code{whiskcol}, \code{staplecol},
and \code{outcol} options (see below).

\item[\code{log}] character, indicating if any axis should be drawn in
logarithmic scale, as in \code{\LinkA{plot.default}{plot.default}}.
\item[\code{frame.plot}] logical, indicating if a `frame'
(\code{\LinkA{box}{box}}) should be drawn; defaults to \code{TRUE}, unless
\code{axes = FALSE} is specified.
\item[\code{horizontal}] logical indicating if the  boxplots should be
horizontal; default \code{FALSE} means vertical boxes.
\item[\code{add}] logical, if true \emph{add} boxplot to current plot.
\item[\code{at}] numeric vector giving the locations where the boxplots
should be drawn, particularly when \code{add = TRUE}; defaults to
\code{1:n} where \code{n} is the number of boxes.
\item[\code{show.names}] Set to \code{TRUE} or \code{FALSE} to override the
defaults on whether an x-axis label is printed for each group.
\item[\code{pars,...}] \LinkA{graphical parameters}{graphical parameters} (etc) can be passed as
arguments to this function, either as a list (\code{pars}) or
normally(\code{...}), see the following.  (Those in \code{...}
take precedence over those in \code{pars}.)

Currently, \code{yaxs} and \code{ylim} are used `along the
boxplot', i.e., vertically, when \code{horizontal} is
false, and \code{xlim} horizontally.
\code{xaxt}, \code{yaxt}, \code{las}, \code{cex.axis}, and
\code{col.axis} are passed to \code{\LinkA{axis}{axis}}, and \code{main},
\code{cex.main}, \code{col.main}, \code{sub}, \code{cex.sub},
\code{col.sub}, \code{xlab}, \code{ylab}, \code{cex.lab}, and
\code{col.lab} are passed to \code{\LinkA{title}{title}}.

In addition, \code{axes} is accepted (see
\code{\LinkA{plot.window}{plot.window}}), with default \code{TRUE}.

The following arguments (or \code{pars} components) allow further
customization of the boxplot graphics.  Their defaults are typically
determined from the non-prefixed version (e.g., \code{boxlty} from
\code{lty}), either from the specified argument or \code{pars}
component or the corresponding \code{\LinkA{par}{par}} one.
\begin{description}

\item[boxwex:] a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved by
making the boxes narrower.  The default depends on \code{at} and
typically is \eqn{0.8}{}.
\item[staplewex, outwex:] staple and outlier line width expansion,
proportional to box width; both default to 0.5.
\item[boxlty, boxlwd, boxcol, boxfill:] box outline type, width,
color, and fill color (which currently defaults to \code{col} and will
in future default to \code{par("bg")}).
\item[medlty, medlwd, medpch, medcex, medcol, medbg:] median line type,
line width, point character, point size expansion, color, and
background color.  The default \code{medpch= NA} suppresses the
point, and \code{medlty="blank"} does so for the line.
Note that\code{medlwd} defaults to
\eqn{3\times}{} the default \code{lwd}.
\item[whisklty, whisklwd, whiskcol:] whisker line type (default:
\code{"dashed"}), width, and color.
\item[staplelty, staplelwd, staplecol:] staple (= end of whisker) line
type, width, and color.
\item[outlty, outlwd, outpch, outcex, outcol, outbg:] outlier line
type, line width, point character, point size expansion, color, and
background color.  The default \code{outlty= "blank"} suppresses the
lines and \code{outpch=NA} suppresses points.

\end{description}


\end{ldescription}
\end{Arguments}
%
\begin{Value}
An invisible vector, actually identical to the \code{at} argument,
with the coordinates ("x" if horizontal is false, "y" otherwise) of
box centers, useful for adding to the plot.
\end{Value}
%
\begin{Note}\relax
When \code{add = FALSE}, \code{xlim} now defaults to \code{xlim =
    range(at, *) + c(-0.5, 0.5)}.  It will usually be a good idea to
specify \code{xlim} if the "x" axis has a log scale or \code{width} is
far from uniform.
\end{Note}
%
\begin{Author}\relax
The R Core development team and Arni Magnusson
(then at U Washington) who has provided most changes for the
box*, med*, whisk*, staple*, and out* arguments.
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
set.seed(753)
(bx.p <- boxplot(split(rt(100, 4), gl(5,20))))
op <- par(mfrow= c(2,2))
bxp(bx.p, xaxt = "n")
bxp(bx.p, notch = TRUE, axes = FALSE, pch = 4, boxfill=1:5)
bxp(bx.p, notch = TRUE, boxfill= "lightblue", frame= FALSE,
    outl= FALSE, main = "bxp(*, frame= FALSE, outl= FALSE)")
bxp(bx.p, notch = TRUE, boxfill= "lightblue", border= 2:6,
    ylim = c(-4,4), pch = 22, bg = "green", log = "x",
    main = "... log='x', ylim=*")
par(op)
op <- par(mfrow= c(1,2))

## single group -- no label
boxplot (weight ~ group, data = PlantGrowth, subset = group=="ctrl")
## with label
bx <- boxplot(weight ~ group, data = PlantGrowth,
              subset = group=="ctrl", plot = FALSE)
bxp(bx,show.names=TRUE)
par(op)


z <- split(rnorm(1000), rpois(1000,2.2))
boxplot(z, whisklty=3, main="boxplot(z, whisklty = 3)")

## Colour support similar to plot.default:
op <- par(mfrow=1:2, bg="light gray", fg="midnight blue")
boxplot(z,   col.axis="skyblue3", main="boxplot(*, col.axis=..,main=..)")
plot(z[[1]], col.axis="skyblue3", main=   "plot(*, col.axis=..,main=..)")
mtext("par(bg=\"light gray\", fg=\"midnight blue\")",
      outer = TRUE, line = -1.2)
par(op)

## Mimic S-Plus:
splus <- list(boxwex=0.4, staplewex=1, outwex=1, boxfill="grey40",
              medlwd=3, medcol="white", whisklty=3, outlty=1, outpch=NA)
boxplot(z, pars=splus)
## Recycled and "sweeping" parameters
op <- par(mfrow=c(1,2))
 boxplot(z, border=1:5, lty = 3, medlty = 1, medlwd = 2.5)
 boxplot(z, boxfill=1:3, pch=1:5, lwd = 1.5, medcol="white")
par(op)
## too many possibilities
boxplot(z, boxfill= "light gray", outpch = 21:25, outlty = 2,
        bg = "pink", lwd = 2,
        medcol = "dark blue", medcex = 2, medpch = 20)
\end{ExampleCode}
\end{Examples}
\HeaderA{cdplot}{Conditional Density Plots}{cdplot}
\methaliasA{cdplot.default}{cdplot}{cdplot.default}
\methaliasA{cdplot.formula}{cdplot}{cdplot.formula}
\keyword{hplot}{cdplot}
%
\begin{Description}\relax
Computes and plots conditional densities describing how the
conditional distribution of a categorical variable \code{y} changes over a
numerical variable \code{x}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
cdplot(x, ...)

## Default S3 method:
cdplot(x, y,
  plot = TRUE, tol.ylab = 0.05, ylevels = NULL,
  bw = "nrd0", n = 512, from = NULL, to = NULL,
  col = NULL, border = 1, main = "", xlab = NULL, ylab = NULL,
  yaxlabels = NULL, xlim = NULL, ylim = c(0, 1), ...)

## S3 method for class 'formula'
cdplot(formula, data = list(),
  plot = TRUE, tol.ylab = 0.05, ylevels = NULL,
  bw = "nrd0", n = 512, from = NULL, to = NULL,
  col = NULL, border = 1, main = "", xlab = NULL, ylab = NULL,
  yaxlabels = NULL, xlim = NULL, ylim = c(0, 1), ...,
  subset = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an object, the default method expects a single numerical
variable (or an object coercible to this).
\item[\code{y}] a \code{"factor"} interpreted to be the dependent variable
\item[\code{formula}] a \code{"formula"} of type \code{y \textasciitilde{} x} with a single dependent
\code{"factor"} and a single numerical explanatory variable.   
\item[\code{data}] an optional data frame.
\item[\code{plot}] logical. Should the computed conditional densities be plotted?
\item[\code{tol.ylab}] convenience tolerance parameter for y-axis annotation.
If the distance between two labels drops under this threshold, they are
plotted equidistantly.
\item[\code{ylevels}] a character or numeric vector specifying in which order
the levels of the dependent variable should be plotted.
\item[\code{bw, n, from, to, ...}] arguments passed to \code{\LinkA{density}{density}}
\item[\code{col}] a vector of fill colors of the same length as \code{levels(y)}.
The default is to call \code{\LinkA{gray.colors}{gray.colors}}. 
\item[\code{border}] border color of shaded polygons. 
\item[\code{main, xlab, ylab}] character strings for annotation
\item[\code{yaxlabels}] character vector for annotation of y axis, defaults to
\code{levels(y)}.
\item[\code{xlim, ylim}] the range of x and y values with sensible defaults.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used for plotting.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{cdplot} computes the conditional densities of \code{x} given
the levels of \code{y} weighted by the marginal distribution of \code{y}.
The densities are derived cumulatively over the levels of \code{y}.

This visualization technique is similar to spinograms (see \code{\LinkA{spineplot}{spineplot}})
and plots \eqn{P(y | x)}{} against \eqn{x}{}. The conditional probabilities
are not derived by discretization (as in the spinogram), but using a smoothing
approach via \code{\LinkA{density}{density}}.

Note, that the estimates of the conditional densities are more reliable for 
high-density regions of \eqn{x}{}. Conversely, the are less reliable in regions
with only few \eqn{x}{} observations.
\end{Details}
%
\begin{Value}
The conditional density functions (cumulative over the levels of \code{y})
are returned invisibly.
\end{Value}
%
\begin{Author}\relax
Achim Zeileis \email{Achim.Zeileis@R-project.org}
\end{Author}
%
\begin{References}\relax
Hofmann, H., Theus, M. (2005), \emph{Interactive graphics for visualizing
conditional distributions}, Unpublished Manuscript.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{spineplot}{spineplot}}, \code{\LinkA{density}{density}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## NASA space shuttle o-ring failures
fail <- factor(c(2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1,
                 1, 2, 1, 1, 1, 1, 1),
               levels = 1:2, labels = c("no", "yes"))
temperature <- c(53, 57, 58, 63, 66, 67, 67, 67, 68, 69, 70, 70,
                 70, 70, 72, 73, 75, 75, 76, 76, 78, 79, 81)

## CD plot
cdplot(fail ~ temperature)
cdplot(fail ~ temperature, bw = 2)
cdplot(fail ~ temperature, bw = "SJ")

## compare with spinogram
(spineplot(fail ~ temperature, breaks = 3))

## highlighting for failures
cdplot(fail ~ temperature, ylevels = 2:1)

## scatter plot with conditional density
cdens <- cdplot(fail ~ temperature, plot = FALSE)
plot(I(as.numeric(fail) - 1) ~ jitter(temperature, factor = 2),
     xlab = "Temperature", ylab = "Conditional failure probability")
lines(53:81, 1 - cdens[[1]](53:81), col = 2)
\end{ExampleCode}
\end{Examples}
\HeaderA{clip}{Set Clipping Region}{clip}
\keyword{dplot}{clip}
%
\begin{Description}\relax
Set clipping region in user coordinates
\end{Description}
%
\begin{Usage}
\begin{verbatim}
clip(x1, x2, y1, y2)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x1, x2, y1, y2}] user coordinates of clipping rectangle
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
How the clipping rectangle is set depends on the setting of
\code{\LinkA{par}{par}("xpd")}: this function changes the current setting
until the next high-level plotting command resets it.

Clipping of lines, rectangles and polygons is done in the graphics
engine, but clipping of text is if possible done in the device, so the
effect of clipping text is device-dependent (and may result in text
not wholly within the clipping region being omitted entirely).

Exactly when the clipping region will be reset can be hard to
predict.  \code{\LinkA{plot.new}{plot.new}} always resets it.
Functions such as \code{\LinkA{lines}{lines}} and \code{\LinkA{text}{text}} only
reset it if \code{\LinkA{par}{par}("xpd")} has been changed.  However,
functions such as \code{\LinkA{box}{box}}, \code{\LinkA{mtext}{mtext}},
\code{\LinkA{title}{title}} and \code{\LinkA{plot.dendrogram}{plot.dendrogram}} can manipulate
the \code{xpd} setting.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{par}{par}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- rnorm(1000)
hist(x, xlim=c(-4,4))
usr <- par("usr")
clip(usr[1], -2, usr[3], usr[4])
hist(x, col = 'red', add = TRUE)
clip(2, usr[2], usr[3], usr[4])
hist(x, col = 'blue', add = TRUE)
do.call("clip", as.list(usr))  # reset to plot region
\end{ExampleCode}
\end{Examples}
\HeaderA{contour}{Display Contours}{contour}
\methaliasA{contour.default}{contour}{contour.default}
\keyword{hplot}{contour}
\keyword{aplot}{contour}
%
\begin{Description}\relax
Create a contour plot, or add contour lines to an existing plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
contour(x, ...)

## Default S3 method:
contour(x = seq(0, 1, length.out = nrow(z)),
        y = seq(0, 1, length.out = ncol(z)),
        z,
        nlevels = 10, levels = pretty(zlim, nlevels),
        labels = NULL,
        xlim = range(x, finite = TRUE),
        ylim = range(y, finite = TRUE),
        zlim = range(z, finite = TRUE),
        labcex = 0.6, drawlabels = TRUE, method = "flattest",
        vfont, axes = TRUE, frame.plot = axes,
        col = par("fg"), lty = par("lty"), lwd = par("lwd"),
        add = FALSE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] locations of grid lines at which the values in \code{z} are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If \code{x} is a \code{list},
its components \code{x\$x} and \code{x\$y} are used for \code{x}
and \code{y}, respectively. If the list has component \code{z} this
is used for \code{z}.
\item[\code{z}] a matrix containing the values to be plotted (\code{NA}s are
allowed).  Note that \code{x} can be used instead of \code{z} for
convenience.
\item[\code{nlevels}] number of contour levels desired \bold{iff}
\code{levels} is not supplied.
\item[\code{levels}] numeric vector of levels at which to draw contour
lines.
\item[\code{labels}] a vector giving the labels for the contour lines.  If
\code{NULL} then the levels are used as labels, otherwise this is
coerced by \code{\LinkA{as.character}{as.character}}.
\item[\code{labcex}] \code{cex} for contour labelling.  This is an absolute
size, not a multiple of \code{par("cex")}.
\item[\code{drawlabels}] logical.  Contours are labelled if \code{TRUE}.
\item[\code{method}] character string specifying where the labels will be
located. Possible values are \code{"simple"}, \code{"edge"} and
\code{"flattest"} (the default).  See the `Details' section.
\item[\code{vfont}] if \code{NULL}, the current font family and face are used
for the contour labels.  If a character vector of length 2 then
Hershey vector fonts are used for the contour labels. The first
element of the vector selects a typeface and the second element
selects a fontindex (see \code{\LinkA{text}{text}} for more information).
The default is \code{NULL} on graphics devices with high-quality
rotation of text and \code{c("sans serif", "plain")} otherwise.
\item[\code{xlim, ylim, zlim}] x-, y- and z-limits for the plot.
\item[\code{axes, frame.plot}] logical indicating whether axes or a box
should be drawn, see \code{\LinkA{plot.default}{plot.default}}.
\item[\code{col}] color for the lines drawn.
\item[\code{lty}] line type for the lines drawn.
\item[\code{lwd}] line width for the lines drawn.
\item[\code{add}] logical. If \code{TRUE}, add to a current plot.
\item[\code{...}] additional arguments to \code{\LinkA{plot.window}{plot.window}},
\code{\LinkA{title}{title}}, \code{\LinkA{Axis}{Axis}} and \code{\LinkA{box}{box}},
typically \LinkA{graphical parameters}{graphical parameters} such as \code{cex.axis}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{contour} is a generic function with only a default method in
base \R{}.

The methods for positioning the labels on contours are \code{"simple"}
(draw at the edge of the plot, overlaying the contour line),
\code{"edge"} (draw at the edge of the plot, embedded in the contour
line, with no labels overlapping) and \code{"flattest"}
(draw on the flattest section of the contour, embedded in the
contour line, with no labels overlapping).  The second and third may
not draw a label on every contour line.

For information about vector fonts, see the
help for \code{\LinkA{text}{text}} and \code{\LinkA{Hershey}{Hershey}}.

Notice that \code{contour} interprets the \code{z} matrix as a table of
\code{f(x[i], y[j])} values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
i.e. a 90 degree counter-clockwise rotation of the conventional textual
layout.

Alternatively, use \code{\LinkA{contourplot}{contourplot}} from the
\Rhref{http://CRAN.R-project.org/package=lattice}{\pkg{lattice}} package where the \code{\LinkA{formula}{formula}} notation allows
to use vectors \code{x,y,z} of the same length.

There is limited control over the axes and frame as arguments
\code{col}, \code{lwd} and \code{lty} refer to the contour lines
(rather than being general \LinkA{graphical parameters}{graphical parameters}).  For more control,
add contours to a plot, or add axes and frame to a contour plot.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{options}{options}("max.contour.segments")} for the maximal
complexity of a single contour line.

\code{\LinkA{contourLines}{contourLines}}, \code{\LinkA{filled.contour}{filled.contour}}
for color-filled contours,
\code{\LinkA{contourplot}{contourplot}} (and
\code{\LinkA{levelplot}{levelplot}}) from package \Rhref{http://CRAN.R-project.org/package=lattice}{\pkg{lattice}}.
Further, \code{\LinkA{image}{image}} and the graphics demo which can be
invoked as \code{demo(graphics)}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices) # for colours
x <- -6:16
op <- par(mfrow = c(2, 2))
contour(outer(x, x), method = "edge", vfont = c("sans serif", "plain"))
z <- outer(x, sqrt(abs(x)), FUN = "/")
image(x, x, z)
contour(x, x, z, col = "pink", add = TRUE, method = "edge",
        vfont = c("sans serif", "plain"))
contour(x, x, z, ylim = c(1, 6), method = "simple", labcex = 1)
contour(x, x, z, ylim = c(-6, 6), nlev = 20, lty = 2, method = "simple")
par(op)

## Persian Rug Art:
x <- y <- seq(-4*pi, 4*pi, len = 27)
r <- sqrt(outer(x^2, y^2, "+"))
opar <- par(mfrow = c(2, 2), mar = rep(0, 4))
for(f in pi^(0:3))
  contour(cos(r^2)*exp(-r/f),
          drawlabels = FALSE, axes = FALSE, frame = TRUE)

rx <- range(x <- 10*1:nrow(volcano))
ry <- range(y <- 10*1:ncol(volcano))
ry <- ry + c(-1,1) * (diff(rx) - diff(ry))/2
tcol <- terrain.colors(12)
par(opar); opar <- par(pty = "s", bg = "lightcyan")
plot(x = 0, y = 0,type = "n", xlim = rx, ylim = ry, xlab = "", ylab = "")
u <- par("usr")
rect(u[1], u[3], u[2], u[4], col = tcol[8], border = "red")
contour(x, y, volcano, col = tcol[2], lty = "solid", add = TRUE,
        vfont = c("sans serif", "plain"))
title("A Topographic Map of Maunga Whau", font = 4)
abline(h = 200*0:4, v = 200*0:4, col = "lightgray", lty = 2, lwd = 0.1)

## contourLines produces the same contour lines as contour
line.list <- contourLines(x, y, volcano)
plot(x = 0, y = 0,type = "n", xlim = rx, ylim = ry, xlab = "", ylab = "")
u <- par("usr")
rect(u[1], u[3], u[2], u[4], col = tcol[8], border = "red")
contour(x, y, volcano, col = tcol[2], lty = "solid", add = TRUE,
             vfont = c("sans serif", "plain"))
templines <- function(clines) {
  lines(clines[[2]], clines[[3]])
}
invisible(lapply(line.list, templines))
par(opar)
\end{ExampleCode}
\end{Examples}
\HeaderA{convertXY}{Convert between Graphics Coordinate Systems}{convertXY}
\aliasA{grconvertX}{convertXY}{grconvertX}
\aliasA{grconvertY}{convertXY}{grconvertY}
\keyword{dplot}{convertXY}
%
\begin{Description}\relax
Convert between graphics coordinate systems.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
grconvertX(x, from = "user", to = "user")
grconvertY(y, from = "user", to = "user")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] numeric vector of coordinates.
\item[\code{from, to}] character strings giving the coordinate systems to
convert between.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The coordinate systems are
\begin{description}

\item[\code{"user"}] user coordinates.
\item[\code{"inches"}] inches.
\item[\code{"device"}] the device coordinate system.
\item[\code{"ndc"}] normalized device coordinates.
\item[\code{"nfc"}] normalized figure coordinates.
\item[\code{"npc"}] normalized plot coordinates.
\item[\code{"nic"}] normalized inner region coordinates.  (The
`inner region' is that inside the outer margins.)

\end{description}

(These names can be partially matched.)  For the `normalized'
coordinate systems the lower left has value 0 and the top right
value 1.

Device coordinates are those in which the device works: they are
usually in pixels where that makes sense and in big points (1/72 inch)
otherwise (e.g. \code{\LinkA{pdf}{pdf}} and \code{\LinkA{postscript}{postscript}}).
\end{Details}
%
\begin{Value}
A numeric vector of the same length as the input.
\end{Value}
%
\begin{Examples}
\begin{ExampleCode}
op <- par(omd=c(0.1, 0.9, 0.1, 0.9), mfrow = c(1, 2))
plot(1:4)
for(tp in c("in", "dev", "ndc", "nfc", "npc", "nic"))
    print(grconvertX(c(1.0, 4.0), "user", tp))
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{coplot}{Conditioning Plots}{coplot}
\aliasA{co.intervals}{coplot}{co.intervals}
\keyword{hplot}{coplot}
\keyword{aplot}{coplot}
%
\begin{Description}\relax
This function produces two variants of the \bold{co}nditioning plots
discussed in the reference below.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
coplot(formula, data, given.values, panel = points, rows, columns,
       show.given = TRUE, col = par("fg"), pch = par("pch"), 
       bar.bg = c(num = gray(0.8), fac = gray(0.95)),
       xlab = c(x.name, paste("Given :", a.name)),
       ylab = c(y.name, paste("Given :", b.name)),
       subscripts = FALSE,
       axlabels = function(f) abbreviate(levels(f)),
       number = 6, overlap = 0.5, xlim, ylim, ...) 
co.intervals(x, number = 6, overlap = 0.5)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{formula}] a formula describing the form of conditioning plot.  A
formula of the form \code{y \textasciitilde{} x | a} indicates that plots of
\code{y} versus \code{x} should be produced conditional on the
variable \code{a}.  A formula of the form \code{y \textasciitilde{} x| a * b}
indicates that plots of \code{y} versus \code{x} should be produced
conditional on the two variables \code{a} and \code{b}.

All three or four variables may be either numeric or factors.
When \code{x} or \code{y} are factors, the result is almost as if
\code{as.numeric()} was applied, whereas for factor
\code{a} or \code{b}, the conditioning (and its graphics if
\code{show.given} is true) are adapted.

\item[\code{data}] a data frame containing values for any variables in the
formula.  By default the environment where \code{coplot} was called
from is used.
\item[\code{given.values}] a value or list of two values which determine how
the conditioning on \code{a} and \code{b} is to take place.

When there is no \code{b} (i.e., conditioning only on \code{a}),
usually this is a matrix with two columns each row of which gives an
interval, to be conditioned on, but is can also be a single vector
of numbers or a set of factor levels (if the variable being
conditioned on is a factor). In this case (no \code{b}),
the result of \code{co.intervals} can be used directly as
\code{given.values} argument.

\item[\code{panel}] a \code{\LinkA{function}{function}(x, y, col, pch, ...)}
which gives the action to be carried out in
each panel of the display.  The default is \code{points}.
\item[\code{rows}] the panels of the plot are laid out in a \code{rows} by
\code{columns} array.  \code{rows} gives the number of rows in the
array.
\item[\code{columns}] the number of columns in the panel layout array.
\item[\code{show.given}] logical (possibly of length 2 for 2 conditioning
variables): should conditioning plots be shown for the
corresponding conditioning variables (default \code{TRUE}).
\item[\code{col}] a vector of colors to be used to plot the points.  If too
short, the values are recycled.
\item[\code{pch}] a vector of plotting symbols or characters.  If too short,
the values are recycled.
\item[\code{bar.bg}] a named vector with components \code{"num"} and
\code{"fac"} giving the background colors for the (shingle) bars,
for \bold{num}eric and \bold{fac}tor conditioning variables respectively.
\item[\code{xlab}] character; labels to use for the x axis and the
first conditioning variable.  If only one label is given, it is used
for the x axis and the default label is used for the conditioning
variable.
\item[\code{ylab}] character; labels to use for the y axis and any
second conditioning variable.
\item[\code{subscripts}] logical: if true the panel function is given an
additional (third) argument \code{subscripts} giving the subscripts
of the data passed to that panel.
\item[\code{axlabels}] function for creating axis (tick) labels when x or y
are factors.
\item[\code{number}] integer; the number of conditioning intervals,
for a and b, possibly of length 2.  It is only used if the
corresponding conditioning variable is not a \code{\LinkA{factor}{factor}}.
\item[\code{overlap}] numeric < 1; the fraction of overlap of the
conditioning variables, possibly of length 2 for x and y
direction.  When overlap < 0, there will be \emph{gaps} between
the data slices.
\item[\code{xlim}] the range for the x axis.
\item[\code{ylim}] the range for the y axis.
\item[\code{...}] additional arguments to the panel function.

\item[\code{x}] a numeric vector.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
In the case of a single conditioning variable \code{a}, when both
\code{rows} and \code{columns} are unspecified, a `close to
square' layout is chosen with \code{columns >= rows}.

In the case of multiple \code{rows}, the \emph{order} of the panel
plots is from the bottom and from the left (corresponding to
increasing \code{a}, typically).

A panel function should not attempt to start a new plot, but just plot
within a given coordinate system: thus \code{plot} and \code{boxplot}
are not panel functions.

The rendering of arguments \code{xlab} and
\code{ylab} is not controlled by \code{\LinkA{par}{par}} arguments
\code{cex.lab} and \code{font.lab} even though they are plotted by
\code{\LinkA{mtext}{mtext}} rather than \code{\LinkA{title}{title}}.
\end{Details}
%
\begin{Value}
\code{co.intervals(., number, .)} returns a (\code{number} \eqn{\times}{}
2) \code{\LinkA{matrix}{matrix}}, say \code{ci},  where \code{ci[k,]} is
the \code{\LinkA{range}{range}} of \code{x} values for the \code{k}-th interval.
\end{Value}
%
\begin{References}\relax
Chambers, J. M. (1992)
\emph{Data for models.}
Chapter 3 of \emph{Statistical Models in S}
eds J. M. Chambers and T. J. Hastie, Wadsworth \& Brooks/Cole.

Cleveland, W. S. (1993) \emph{Visualizing Data.} New Jersey: Summit Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{pairs}{pairs}},
\code{\LinkA{panel.smooth}{panel.smooth}},
\code{\LinkA{points}{points}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Tonga Trench Earthquakes
coplot(lat ~ long | depth, data = quakes)
given.depth <- co.intervals(quakes$depth, number=4, overlap=.1)
coplot(lat ~ long | depth, data = quakes, given.v=given.depth, rows=1)

## Conditioning on 2 variables:
ll.dm <- lat ~ long | depth * mag
coplot(ll.dm, data = quakes)
coplot(ll.dm, data = quakes, number=c(4,7), show.given=c(TRUE,FALSE))
coplot(ll.dm, data = quakes, number=c(3,7),
       overlap=c(-.5,.1)) # negative overlap DROPS values

## given two factors
Index <- seq(length=nrow(warpbreaks)) # to get nicer default labels
coplot(breaks ~ Index | wool * tension, data = warpbreaks,
       show.given = 0:1)
coplot(breaks ~ Index | wool * tension, data = warpbreaks,
       col = "red", bg = "pink", pch = 21,
       bar.bg = c(fac = "light blue"))

## Example with empty panels:
with(data.frame(state.x77), {
coplot(Life.Exp ~ Income | Illiteracy * state.region, number = 3,
       panel = function(x, y, ...) panel.smooth(x, y, span = .8, ...))
## y ~ factor -- not really sensible, but 'show off':
coplot(Life.Exp ~ state.region | Income * state.division,
       panel = panel.smooth)
})
\end{ExampleCode}
\end{Examples}
\HeaderA{curve}{Draw Function Plots}{curve}
\aliasA{plot.function}{curve}{plot.function}
\keyword{hplot}{curve}
%
\begin{Description}\relax
Draws a curve corresponding to a function over the interval
\code{[from, to]}. \code{curve} can plot also an expression in the variable
\code{xname}, default \samp{x}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
curve(expr, from = NULL, to = NULL, n = 101, add = FALSE,
      type = "l", xname = "x", xlab = xname, ylab = NULL,
      log = NULL, xlim = NULL, ...)

## S3 method for class 'function'
plot(x, y = 0, to = 1, from = y, xlim = NULL, ylab = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{expr}] The name of a function, or a \LinkA{call}{call} or an
\LinkA{expression}{expression} written as a function of \code{x} which will
evaluate to an object of the same length as \code{x}.
\item[\code{x}] a `vectorizing' numeric \R{} function.
\item[\code{y}] alias for \code{from} for compatibility with \code{plot}
\item[\code{from, to}] the range over which the function will be plotted.
\item[\code{n}] integer; the number of x values at which to evaluate.
\item[\code{add}] logical; if \code{TRUE} add to an already existing plot; if
\code{NA} start a new plot taking the defaults for the limits and
log-scaling of the x-axis from the previous plot.  Taken as
\code{FALSE} (with a warning if a different value is supplied) if no
graphics device is open.
\item[\code{xlim}] \code{NULL} or a numeric vector of length 2;
if non-\code{NULL} it provides the defaults for \code{c(from, to)}
and, unless \code{add = TRUE}, selects the x-limits of the plot -- see
\code{\LinkA{plot.window}{plot.window}}.
\item[\code{type}] plot type: see \code{\LinkA{plot.default}{plot.default}}.
\item[\code{xname}] character string giving the name to be used for the x axis.
\item[\code{xlab, ylab, log, ...}] labels and \LinkA{graphical parameters}{graphical parameters}
can also be specified as arguments.  See `Details' for the
interpretation of the default for \code{log}.

For the \code{"function"} method of \code{plot}, \code{...} can
include any of the other arguments of \code{curve}, except
\code{expr}.

\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The function or expression \code{expr} (for \code{curve}) or function
\code{x} (for \code{plot}) is evaluated at \code{n} points equally
spaced over the range \code{[from, to]}.  The points determined in
this way are then plotted.

If either \code{from} or \code{to} is \code{NULL}, it defaults to the
corresponding element of \code{xlim} if that is not \code{NULL}.

What happens when neither \code{from}/\code{to} nor \code{xlim}
specifies both x-limits is a complex story.  For
\code{plot(<function>)} and for \code{curve(add = FALSE)} the defaults
are \eqn{(0, 1)}{}.  For \code{curve(add = NA)} and \code{curve(add =
  TRUE)} the defaults are taken from the x-limits used for the previous
plot.  (This differs from versions of \R{} prior to 2.14.0.)

The value of \code{log} is used both to specify the plot axes (unless
\code{add = TRUE}) and how `equally spaced' is interpreted: if
the x component indicates log-scaling, the points at which the
expression or function is plotted are equally spaced on log scale.

The default value of \code{log} is taken from the current plot when
\code{add = TRUE}, whereas if \code{add = NA} the x component is taken
from the existing plot (if any) and the y component defaults to
linear.  For \code{add = FALSE} the default is \code{""}

This used to be a quick hack which now seems to serve a useful purpose,
but can give bad results for functions which are not smooth.

For expensive-to-compute \code{expr}essions, you should use smarter tools.

The way \code{curve} handles \code{expr} has caused confusion.  It
first looks to see if \code{expr} is a \LinkA{name}{name} (also known as a
symbol), in which case it is taken to be the name of a function, and
\code{expr} is replaced by a call to \code{expr} with a single
argument with name given by \code{xname}.  Otherwise it checks that
\code{expr} is either a \LinkA{call}{call} or an \LinkA{expression}{expression}, and that
it contains a reference to the variable given by \code{xname} (using
\code{\LinkA{all.vars}{all.vars}}): anything else is an error.  Then \code{expr}
is evaluated in an environment which supplies a vector of name given
by \code{xname} of length \code{n}, and should evaluate to an object
of length \code{n}.  Note that this means that \code{curve(x, ...)} is
taken as a request to plot a function named \code{x} (and it is used
as such in the \code{function} method for \code{plot}).

As from \R{} 2.14.0 the \code{plot} method can be called directly as
\code{plot.function}.
\end{Details}
%
\begin{Value}
A list with components \code{x} and \code{y} of the points that were 
drawn is returned invisibly.
\end{Value}
%
\begin{Section}{Warning}
For historical reasons, \code{add} is allowed as an argument to the
\code{"function"} method of \code{plot}, but its behaviour may surprise
you.  It is recommended to use \code{add} only with \code{curve}.
\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{splinefun}{splinefun}} for spline interpolation, \code{\LinkA{lines}{lines}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(qnorm) # default range c(0, 1) is appropriate here,
            # but end values are -/+Inf and so are omitted.
plot(qlogis, main = "The Inverse Logit : qlogis()")
abline(h = 0, v = 0:2/2, lty = 3, col = "gray")

curve(sin, -2*pi, 2*pi, xname = "t")
curve(tan, xname = "t", add = NA,
      main = "curve(tan)  --> same x-scale as previous plot")

op <- par(mfrow = c(2, 2))
curve(x^3 - 3*x, -2, 2)
curve(x^2 - 2, add = TRUE, col = "violet")

## simple and advanced versions, quite similar:
plot(cos, -pi,  3*pi)
curve(cos, xlim = c(-pi, 3*pi), n = 1001, col = "blue", add = TRUE)

chippy <- function(x) sin(cos(x)*exp(-x/2))
curve(chippy, -8, 7, n = 2001)
plot (chippy, -8, -5)

for(ll in c("", "x", "y", "xy"))
   curve(log(1+x), 1, 100, log = ll,
         sub = paste("log= '", ll, "'", sep = ""))
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{dotchart}{Cleveland's Dot Plots}{dotchart}
\keyword{hplot}{dotchart}
%
\begin{Description}\relax
Draw a Cleveland dot plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dotchart(x, labels = NULL, groups = NULL, gdata = NULL,
         cex = par("cex"), pch = 21, gpch = 21, bg = par("bg"),
         color = par("fg"), gcolor = par("fg"), lcolor = "gray",
         xlim = range(x[is.finite(x)]),
         main = NULL, xlab = NULL, ylab = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] either a vector or matrix of numeric values (\code{NA}s are
allowed).  If \code{x} is a matrix the overall plot consists of
juxtaposed dotplots for each row.  Inputs which satisfy
\code{\LinkA{is.numeric}{is.numeric}(x)} but not
\code{is.vector(x) || is.matrix(x)} are coerced by
\code{\LinkA{as.numeric}{as.numeric}}, with a warning.
\item[\code{labels}] a vector of labels for each point.
For vectors the default is to use \code{names(x)} and for matrices
the row labels \code{dimnames(x)[[1]]}.
\item[\code{groups}] an optional factor indicating how the elements of
\code{x} are grouped.
If \code{x} is a matrix, \code{groups} will default to the columns
of \code{x}.
\item[\code{gdata}] data values for the groups.
This is typically a summary such as the median or mean
of each group.
\item[\code{cex}] the character size to be used.  Setting \code{cex}
to a value smaller than one can be a useful way of avoiding label
overlap.  Unlike many other graphics functions, this sets the actual
size, not a multiple of \code{par("cex")}.
\item[\code{pch}] the plotting character or symbol to be used.
\item[\code{gpch}] the plotting character or symbol to be used for group
values.
\item[\code{bg}] the background color of plotting characters or symbols to be
used; use \code{\LinkA{par}{par}(bg= *)} to set the background color of
the whole plot.
\item[\code{color}] the color(s) to be used for points and labels.
\item[\code{gcolor}] the single color to be used for group labels and
values.
\item[\code{lcolor}] the color(s) to be used for the horizontal lines.
\item[\code{xlim}] horizontal range for the plot, see
\code{\LinkA{plot.window}{plot.window}}, e.g.
\item[\code{main}] overall title for the plot, see \code{\LinkA{title}{title}}.
\item[\code{xlab, ylab}] axis annotations as in \code{title}.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} can also be specified as arguments.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
This function is invoked for its side effect, which is to produce two
variants of dotplots as described in Cleveland (1985).

Dot plots are a reasonable substitute for bar plots.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Cleveland, W. S. (1985)
\emph{The Elements of Graphing Data.}
Monterey, CA: Wadsworth.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{Examples}
\begin{ExampleCode}
dotchart(VADeaths, main = "Death Rates in Virginia - 1940")
op <- par(xaxs="i")# 0 -- 100%
dotchart(t(VADeaths), xlim = c(0,100),
         main = "Death Rates in Virginia - 1940")
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{filled.contour}{Level (Contour) Plots}{filled.contour}
\aliasA{.filled.contour}{filled.contour}{.filled.contour}
\keyword{hplot}{filled.contour}
\keyword{aplot}{filled.contour}
%
\begin{Description}\relax
This function produces a contour plot with the areas between the
contours filled in solid color (Cleveland calls this a level plot).  A
key showing how the colors map to z values is shown to the right of
the plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
filled.contour(x = seq(0, 1, length.out = nrow(z)),
               y = seq(0, 1, length.out = ncol(z)),
               z,
               xlim = range(x, finite=TRUE),
               ylim = range(y, finite=TRUE),
               zlim = range(z, finite=TRUE),
               levels = pretty(zlim, nlevels), nlevels = 20,
               color.palette = cm.colors,
               col = color.palette(length(levels) - 1),
               plot.title, plot.axes, key.title, key.axes,
               asp = NA, xaxs = "i", yaxs = "i", las = 1,
               axes = TRUE, frame.plot = axes, ...)

.filled.contour(x, y, z, levels, col)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] locations of grid lines at which the values in \code{z} are
measured.  These must be in ascending order.  (The rest of this
description does not apply to \code{.filled.contour}.)
By default, equally spaced values from 0 to 1 are used.  If \code{x}
is a \code{list}, its components \code{x\$x} and \code{x\$y} are used
for \code{x} and \code{y}, respectively.  If the list has component
\code{z} this is used for \code{z}.
\item[\code{z}] a numeric matrix containing the values to be plotted..  Note that
\code{x} can be used instead of \code{z} for convenience.
\item[\code{xlim}] x limits for the plot.
\item[\code{ylim}] y limits for the plot.
\item[\code{zlim}] z limits for the plot.
\item[\code{levels}] a set of levels which are used to partition the range
of \code{z}.  Must be \bold{strictly} increasing (and finite).  Areas
with \code{z} values between consecutive levels are painted with the
same color.
\item[\code{nlevels}] if \code{levels} is not specified, the range of \code{z},
values is divided into approximately this many levels.
\item[\code{color.palette}] a color palette function to be used to assign
colors in the plot.
\item[\code{col}] an explicit set of colors to be used in the plot.
This argument overrides any palette function specification.  There
should be one less color than levels
\item[\code{plot.title}] statements which add titles to the main plot.
\item[\code{plot.axes}] statements which draw axes (and a \code{\LinkA{box}{box}})
on the main plot.  This overrides the default axes.
\item[\code{key.title}] statements which add titles for the plot key.
\item[\code{key.axes}] statements which draw axes on the plot key.
This overrides the default axis.
\item[\code{asp}] the \eqn{y/x}{} aspect ratio, see \code{\LinkA{plot.window}{plot.window}}.
\item[\code{xaxs}] the x axis style.  The default is to use internal
labeling.
\item[\code{yaxs}] the y axis style.  The default is to use internal
labeling.
\item[\code{las}] the style of labeling to be used.  The default is to
use horizontal labeling.
\item[\code{axes, frame.plot}] logicals indicating if axes and a box should be
drawn, as in \code{\LinkA{plot.default}{plot.default}}.
\item[\code{...}] additional \LinkA{graphical parameters}{graphical parameters}, currently only passed to
\code{\LinkA{title}{title}()}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The values to be plotted can contain \code{NA}s.  Rectangles with two
or more corner values are \code{NA} are omitted entirely: where there
is a single \code{NA} value the triangle opposite the \code{NA} is
omitted.

As from \R{} 2.14.1 values to be plotted can be infinite: the effect is
similar to that described for \code{NA} values.

\code{.filled.contour} is a `bare bones' interface to add
just the contour plot to an already-set-up plot region.  It is is
intended for programmatic use, and the programmer is
responsible for checking the conditions on the arguments.
\end{Details}
%
\begin{Note}\relax
\code{filled.contour} uses the \code{\LinkA{layout}{layout}} function and so is
restricted to a full page display.

The output produced by \code{filled.contour} is actually a combination
of two plots; one is the filled contour and one is the legend.  Two
separate coordinate systems are set up for these two plots, but they
are only used internally -- once the function has returned these
coordinate systems are lost.  If you want to annotate the main contour
plot, for example to add points, you can specify graphics commands in
the \code{plot.axes} argument.  See the examples.
\end{Note}
%
\begin{Author}\relax
Ross Ihaka and R-core.
\end{Author}
%
\begin{References}\relax
Cleveland, W. S. (1993)
\emph{Visualizing Data}.
Summit, New Jersey: Hobart.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{contour}{contour}}, \code{\LinkA{image}{image}},
\code{\LinkA{palette}{palette}}; \code{\LinkA{contourplot}{contourplot}}
and \code{\LinkA{levelplot}{levelplot}} from package \Rhref{http://CRAN.R-project.org/package=lattice}{\pkg{lattice}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices) # for colours
filled.contour(volcano, color = terrain.colors, asp = 1)# simple

x <- 10*1:nrow(volcano)
y <- 10*1:ncol(volcano)
filled.contour(x, y, volcano, color = terrain.colors,
    plot.title = title(main = "The Topography of Maunga Whau",
    xlab = "Meters North", ylab = "Meters West"),
    plot.axes = { axis(1, seq(100, 800, by = 100))
                  axis(2, seq(100, 600, by = 100)) },
    key.title = title(main="Height\n(meters)"),
    key.axes = axis(4, seq(90, 190, by = 10)))# maybe also asp=1
mtext(paste("filled.contour(.) from", R.version.string),
      side = 1, line = 4, adj = 1, cex = .66)

# Annotating a filled contour plot
a <- expand.grid(1:20, 1:20)
b <- matrix(a[,1] + a[,2], 20)
filled.contour(x = 1:20, y = 1:20, z = b,
               plot.axes={ axis(1); axis(2); points(10,10) })

## Persian Rug Art:
x <- y <- seq(-4*pi, 4*pi, len = 27)
r <- sqrt(outer(x^2, y^2, "+"))
filled.contour(cos(r^2)*exp(-r/(2*pi)), axes = FALSE)
## rather, the key *should* be labeled:
filled.contour(cos(r^2)*exp(-r/(2*pi)), frame.plot = FALSE,
               plot.axes = {})
\end{ExampleCode}
\end{Examples}
\HeaderA{fourfoldplot}{Fourfold Plots}{fourfoldplot}
\keyword{hplot}{fourfoldplot}
%
\begin{Description}\relax
Creates a fourfold display of a 2 by 2 by \eqn{k}{} contingency table on
the current graphics device, allowing for the visual inspection of the
association between two dichotomous variables in one or several
populations (strata).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
fourfoldplot(x, color = c("#99CCFF", "#6699CC"),
             conf.level = 0.95,
             std = c("margins", "ind.max", "all.max"),
             margin = c(1, 2), space = 0.2, main = NULL,
             mfrow = NULL, mfcol = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a 2 by 2 by \eqn{k}{} contingency table in array form, or as a
2 by 2 matrix if \eqn{k}{} is 1.
\item[\code{color}] a vector of length 2 specifying the colors to use for the
smaller and larger diagonals of each 2 by 2 table.
\item[\code{conf.level}] confidence level used for the confidence rings on
the odds ratios.  Must be a single nonnegative number less than 1;
if set to 0, confidence rings are suppressed.
\item[\code{std}] a character string specifying how to standardize the table.
Must be one of \code{"margins"}, \code{"ind.max"}, or
\code{"all.max"}, and can be abbreviated by the initial letter.
If set to \code{"margins"}, each 2 by 2 table is standardized to
equate the margins specified by \code{margin} while preserving the
odds ratio.  If \code{"ind.max"} or \code{"all.max"}, the tables are
either individually or simultaneously standardized to a maximal cell
frequency of 1.
\item[\code{margin}] a numeric vector with the margins to equate.  Must be
one of \code{1}, \code{2}, or \code{c(1, 2)} (the default), which
corresponds to standardizing the row, column, or both margins in
each 2 by 2 table.
Only used if \code{std} equals \code{"margins"}.
\item[\code{space}] the amount of space (as a fraction of the maximal radius
of the quarter circles) used for the row and column labels.
\item[\code{main}] character string for the fourfold title.
\item[\code{mfrow}] a numeric vector of the form \code{c(nr, nc)}, indicating
that the displays for the 2 by 2 tables should be arranged in an
\code{nr} by \code{nc} layout, filled by rows.
\item[\code{mfcol}] a numeric vector of the form \code{c(nr, nc)}, indicating
that the displays for the 2 by 2 tables should be arranged in an
\code{nr} by \code{nc} layout, filled by columns.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The fourfold display is designed for the display of 2 by 2 by \eqn{k}{}
tables.

Following suitable standardization, the cell frequencies
\eqn{f_{ij}}{} of each 2 by 2 table are shown as a quarter
circle whose radius is proportional to
\eqn{\sqrt{f_{ij}}}{} so that its area is proportional to
the cell frequency.  An association (odds ratio different from 1)
between the binary row and column variables is indicated by the
tendency of diagonally opposite cells in one direction to differ in
size from those in the other direction; color is used to show this
direction.  Confidence rings for the odds ratio allow a visual test of
the null of no association; the rings for adjacent quadrants overlap
if and only if the observed counts are consistent with the null hypothesis.

Typically, the number \eqn{k}{} corresponds to the number of levels of a
stratifying variable, and it is of interest to see whether the
association is homogeneous across strata.  The fourfold display
visualizes the pattern of association.  Note that the confidence rings
for the individual odds ratios are not adjusted for multiple testing.
\end{Details}
%
\begin{References}\relax
Friendly, M. (1994).
A fourfold display for 2 by 2 by \eqn{k}{} tables.
Technical Report 217, York University, Psychology Department.
\url{http://www.math.yorku.ca/SCS/Papers/4fold/4fold.ps.gz}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{mosaicplot}{mosaicplot}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Use the Berkeley admission data as in Friendly (1995).
x <- aperm(UCBAdmissions, c(2, 1, 3))
dimnames(x)[[2]] <- c("Yes", "No")
names(dimnames(x)) <- c("Sex", "Admit?", "Department")
stats::ftable(x)

## Fourfold display of data aggregated over departments, with
## frequencies standardized to equate the margins for admission
## and sex.
## Figure 1 in Friendly (1994).
fourfoldplot(margin.table(x, c(1, 2)))

## Fourfold display of x, with frequencies in each table
## standardized to equate the margins for admission and sex.
## Figure 2 in Friendly (1994).
fourfoldplot(x)

## Fourfold display of x, with frequencies in each table
## standardized to equate the margins for admission. but not
## for sex.
## Figure 3 in Friendly (1994).
fourfoldplot(x, margin = 2)
\end{ExampleCode}
\end{Examples}
\HeaderA{frame}{Create / Start a New Plot Frame}{frame}
\aliasA{plot.new}{frame}{plot.new}
\keyword{iplot}{frame}
\keyword{aplot}{frame}
%
\begin{Description}\relax
This function (\code{frame} is an alias for
\code{plot.new}) causes the completion of plotting in the current plot
(if there is one) and an advance to a new graphics frame.  This is
used in all high-level plotting functions and also useful for skipping
plots when a multi-figure region is in use.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
plot.new()
frame()
\end{verbatim}
\end{Usage}
%
\begin{Details}\relax
The new page is painted with the background colour
(\code{\LinkA{par}{par}("bg")}), which is often transparent.  For devices
with a \emph{canvas} colour (the on-screen devices \code{X11},
\code{windows} and \code{quartz}), the window is first painted with the
canvas colour and then the background colour.

There are two hooks called \code{"before.plot.new"} and
\code{"plot.new"} (see \code{\LinkA{setHook}{setHook}}) called immediately
before and after advancing the frame. The latter is used
in the testing code to annotate the new page. The hook function(s) are
called with no argument.  (If the value is a character string,
\code{get} is called on it from within the \pkg{graphics} namespace.)
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole. (\code{frame}.)
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.window}{plot.window}}, \code{\LinkA{plot.default}{plot.default}}.
\end{SeeAlso}
\HeaderA{grid}{Add Grid to a Plot}{grid}
\keyword{aplot}{grid}
%
\begin{Description}\relax
\code{grid} adds an \code{nx} by \code{ny} rectangular grid to an
existing plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
grid(nx = NULL, ny = nx, col = "lightgray", lty = "dotted",
     lwd = par("lwd"), equilogs = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{nx,ny}] number of cells of the grid in x and y direction.  When
\code{NULL}, as per default, the grid aligns with the tick marks on
the corresponding \emph{default} axis (i.e., tickmarks as computed by
\code{\LinkA{axTicks}{axTicks}}).  When \code{\LinkA{NA}{NA}}, no grid lines are
drawn in the corresponding direction.
\item[\code{col}] character or (integer) numeric; color of the grid lines.
\item[\code{lty}] character or (integer) numeric; line type of the grid lines.
\item[\code{lwd}] non-negative numeric giving line width of the grid lines.
\item[\code{equilogs}] logical, only used when \emph{log} coordinates and
alignment with the axis tick marks are active.  Setting \code{equilogs =
      FALSE} in that case gives \emph{non equidistant} tick aligned
grid lines.
\end{ldescription}
\end{Arguments}
%
\begin{Note}\relax
If more fine tuning is required, use \code{\LinkA{abline}{abline}(h = ., v = .)}
directly.
\end{Note}
%
\begin{References}\relax
Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot}{plot}}, \code{\LinkA{abline}{abline}}, \code{\LinkA{lines}{lines}},
\code{\LinkA{points}{points}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(1:3)
grid(NA, 5, lwd = 2) # grid only in y-direction

## maybe change the desired number of tick marks:  par(lab=c(mx,my,7))
op <- par(mfcol = 1:2)
with(iris,
     {
     plot(Sepal.Length, Sepal.Width, col = as.integer(Species),
          xlim = c(4, 8), ylim = c(2, 4.5), panel.first = grid(),
          main = "with(iris,  plot(...., panel.first = grid(), ..) )")
     plot(Sepal.Length, Sepal.Width, col = as.integer(Species),
          panel.first = grid(3, lty=1,lwd=2),
          main = "... panel.first = grid(3, lty=1,lwd=2), ..")
     }
    )
par(op)

\end{ExampleCode}
\end{Examples}
\HeaderA{hist}{Histograms}{hist}
\methaliasA{hist.default}{hist}{hist.default}
\keyword{dplot}{hist}
\keyword{hplot}{hist}
\keyword{distribution}{hist}
%
\begin{Description}\relax
The generic function \code{hist} computes a histogram of the given
data values.  If \code{plot=TRUE}, the resulting object of
\LinkA{class}{class} \code{"histogram"} is plotted by
\code{\LinkA{plot.histogram}{plot.histogram}}, before it is returned.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
hist(x, ...)

## Default S3 method:
hist(x, breaks = "Sturges",
     freq = NULL, probability = !freq,
     include.lowest = TRUE, right = TRUE,
     density = NULL, angle = 45, col = NULL, border = NULL,
     main = paste("Histogram of" , xname),
     xlim = range(breaks), ylim = NULL,
     xlab = xname, ylab,
     axes = TRUE, plot = TRUE, labels = FALSE,
     nclass = NULL, warn.unused = TRUE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a vector of values for which the histogram is desired.
\item[\code{breaks}] one of:
\begin{itemize}

\item a vector giving the breakpoints between histogram cells,
\item a single number giving the number of cells for the histogram,
\item a character string naming an algorithm to compute the
number of cells (see `Details'),
\item a function to compute the number of cells.

\end{itemize}

In the last three cases the number is a suggestion only.

\item[\code{freq}] logical; if \code{TRUE}, the histogram graphic is a
representation of frequencies, the \code{counts} component of
the result; if \code{FALSE}, probability densities, component
\code{density}, are plotted (so that the histogram has a total area
of one).  Defaults to \code{TRUE} \emph{if and only if} \code{breaks} are
equidistant (and \code{probability} is not specified).
\item[\code{probability}] an \emph{alias} for \code{!freq}, for S compatibility.
\item[\code{include.lowest}] logical; if \code{TRUE}, an \code{x[i]} equal to
the \code{breaks} value will be included in the first (or last, for
\code{right = FALSE}) bar.  This will be ignored (with a warning)
unless \code{breaks} is a vector.
\item[\code{right}] logical; if \code{TRUE}, the histogram cells are
right-closed (left open) intervals.

\item[\code{density}] the density of shading lines, in lines per inch.
The default value of \code{NULL} means that no shading lines
are drawn. Non-positive values of \code{density} also inhibit the
drawing of shading lines.
\item[\code{angle}] the slope of shading lines, given as an angle in
degrees (counter-clockwise).
\item[\code{col}] a colour to be used to fill the bars.
The default of \code{NULL} yields unfilled bars.
\item[\code{border}] the color of the border around the bars.  The default
is to use the standard foreground color.
\item[\code{main, xlab, ylab}] these arguments to \code{title} have useful
defaults here.
\item[\code{xlim, ylim}] the range of x and y values with sensible defaults.
Note that \code{xlim} is \emph{not} used to define the histogram (breaks),
but only for plotting (when \code{plot = TRUE}).
\item[\code{axes}] logical.  If \code{TRUE} (default), axes are draw if the
plot is drawn.
\item[\code{plot}] logical.  If \code{TRUE} (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.  In the
latter case, a warning is used if (typically graphical) arguments
are specified that only apply to the \code{plot = TRUE} case.
\item[\code{labels}] logical or character.  Additionally draw labels on top
of bars, if not \code{FALSE}; see \code{\LinkA{plot.histogram}{plot.histogram}}.
\item[\code{nclass}] numeric (integer).  For S(-PLUS) compatibility only,
\code{nclass} is equivalent to \code{breaks} for a scalar or
character argument. 
\item[\code{warn.unused}] logical.  If \code{plot=FALSE} and 
\code{warn.unused=TRUE}, a warning will be issued when graphical
parameters are passed to \code{hist.default()}.
\item[\code{...}] further arguments and \LinkA{graphical parameters}{graphical parameters} passed to
\code{\LinkA{plot.histogram}{plot.histogram}} and thence to \code{\LinkA{title}{title}} and
\code{\LinkA{axis}{axis}} (if \code{plot=TRUE}).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The definition of \emph{histogram} differs by source (with
country-specific biases).  \R{}'s default with equi-spaced breaks (also
the default) is to plot the counts in the cells defined by
\code{breaks}.  Thus the height of a rectangle is proportional to
the number of points falling into the cell, as is the area
\emph{provided} the breaks are equally-spaced.

The default with non-equi-spaced breaks is to give
a plot of area one, in which the \emph{area} of the rectangles is the
fraction of the data points falling in the cells.

If \code{right = TRUE} (default), the histogram cells are intervals
of the form \code{(a, b]}, i.e., they include their right-hand endpoint,
but not their left one, with the exception of the first cell when
\code{include.lowest} is \code{TRUE}.

For \code{right = FALSE}, the intervals are of the form \code{[a, b)},
and \code{include.lowest} means `\emph{include highest}'.

A numerical tolerance of \eqn{10^{-7}}{} times the median bin size
is applied when counting entries on the edges of bins.  This is not
included in the reported \code{breaks} nor (as from \R{} 2.11.0) in the
calculation of \code{density}.

The default for \code{breaks} is \code{"Sturges"}: see
\code{\LinkA{nclass.Sturges}{nclass.Sturges}}.  Other names for which algorithms
are supplied are \code{"Scott"} and \code{"FD"} /
\code{"Freedman-Diaconis"} (with corresponding functions
\code{\LinkA{nclass.scott}{nclass.scott}} and \code{\LinkA{nclass.FD}{nclass.FD}}).
Case is ignored and partial matching is used.
Alternatively, a function can be supplied which
will compute the intended number of breaks as a function of \code{x}.
\end{Details}
%
\begin{Value}
an object of class \code{"histogram"} which is a list with components:
\begin{ldescription}
\item[\code{breaks}] the \eqn{n+1}{} cell boundaries (= \code{breaks} if that
was a vector). These are the nominal breaks, not with the boundary fuzz.
\item[\code{counts}] \eqn{n}{} integers; for each cell, the number of
\code{x[]} inside.
\item[\code{density}] values \eqn{\hat f(x_i)}{}, as estimated
density values. If \code{all(diff(breaks) == 1)}, they are the
relative frequencies \code{counts/n} and in general satisfy
\eqn{\sum_i \hat f(x_i) (b_{i+1}-b_i) = 1}{}, where \eqn{b_i}{} = \code{breaks[i]}.
\item[\code{intensities}] same as \code{density}. Deprecated, but retained
for compatibility.
\item[\code{mids}] the \eqn{n}{} cell midpoints.
\item[\code{xname}] a character string with the actual \code{x} argument name.
\item[\code{equidist}] logical, indicating if the distances between
\code{breaks} are all the same.
\end{ldescription}
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Venables, W. N. and Ripley. B. D. (2002)
\emph{Modern Applied Statistics with S}.  Springer.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{nclass.Sturges}{nclass.Sturges}}, \code{\LinkA{stem}{stem}},
\code{\LinkA{density}{density}},  \code{\LinkA{truehist}{truehist}} in package
\Rhref{http://CRAN.R-project.org/package=MASS}{\pkg{MASS}}.

Typical plots with vertical bars are \emph{not} histograms.  Consider
\code{\LinkA{barplot}{barplot}} or \code{\LinkA{plot}{plot}(*, type = "h")}
for such bar plots.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
op <- par(mfrow=c(2, 2))
hist(islands)
utils::str(hist(islands, col="gray", labels = TRUE))

hist(sqrt(islands), breaks = 12, col="lightblue", border="pink")
##-- For non-equidistant breaks, counts should NOT be graphed unscaled:
r <- hist(sqrt(islands), breaks = c(4*0:5, 10*3:5, 70, 100, 140),
          col='blue1')
text(r$mids, r$density, r$counts, adj=c(.5, -.5), col='blue3')
sapply(r[2:3], sum)
sum(r$density * diff(r$breaks)) # == 1
lines(r, lty = 3, border = "purple") # -> lines.histogram(*)
par(op)

require(utils) # for str
str(hist(islands, breaks=12, plot= FALSE)) #-> 10 (~= 12) breaks
str(hist(islands, breaks=c(12,20,36,80,200,1000,17000), plot = FALSE))

hist(islands, breaks=c(12,20,36,80,200,1000,17000), freq = TRUE,
     main = "WRONG histogram") # and warning

require(stats)
set.seed(14)
x <- rchisq(100, df = 4)

## Comparing data with a model distribution should be done with qqplot()!
qqplot(x, qchisq(ppoints(x), df = 4)); abline(0,1, col = 2, lty = 2)

## if you really insist on using hist() ... :
hist(x, freq = FALSE, ylim = c(0, 0.2))
curve(dchisq(x, df = 4), col = 2, lty = 2, lwd = 2, add = TRUE)

\end{ExampleCode}
\end{Examples}
\HeaderA{hist.POSIXt}{Histogram of a Date or Date-Time Object}{hist.POSIXt}
\aliasA{hist.Date}{hist.POSIXt}{hist.Date}
\keyword{chron}{hist.POSIXt}
\keyword{dplot}{hist.POSIXt}
\keyword{hplot}{hist.POSIXt}
%
\begin{Description}\relax
Method for \code{\LinkA{hist}{hist}} applied to date or date-time objects.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'POSIXt'
hist(x, breaks, ...,
     xlab = deparse(substitute(x)),
     plot = TRUE, freq = FALSE,
     start.on.monday = TRUE, format)

## S3 method for class 'Date'
hist(x, breaks, ...,
     xlab = deparse(substitute(x)),
     plot = TRUE, freq = FALSE,
     start.on.monday = TRUE, format)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an object inheriting from class \code{"POSIXt"} or \code{"Date"}.
\item[\code{breaks}] 
a vector of cut points \emph{or} number giving the number of
intervals which \code{x} is to be cut into \emph{or} an
interval specification, one of \code{"days"}, \code{"weeks"},
\code{"months"}, \code{"quarters"} or \code{"years"},
plus \code{"secs"}, \code{"mins"}, \code{"hours"} for
date-time objects.

\item[\code{...}] \LinkA{graphical parameters}{graphical parameters}, or arguments to
\code{\LinkA{hist.default}{hist.default}} such as \code{include.lowest},
\code{right} and \code{labels}.
\item[\code{xlab}] a character string giving the label for the x axis, if plotted.
\item[\code{plot}] logical.  If \code{TRUE} (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.
\item[\code{freq}] logical; if \code{TRUE}, the
histogram graphic is a representation of frequencies, i.e,
the \code{counts} component of the result; if \code{FALSE},
\emph{relative} frequencies (probabilities) are plotted.
\item[\code{start.on.monday}] logical. If \code{breaks = "weeks"}, should the
week start on Mondays or Sundays?
\item[\code{format}] for the x-axis labels. See \code{\LinkA{strptime}{strptime}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Note that unlike the default method, \code{breaks} is a required argument.

Using \code{breaks = "quarters"} will create intervals of 3 calendar
months, with the intervals beginning on January 1, April 1,
July 1 or October 1, based upon \code{min(x)} as appropriate.
\end{Details}
%
\begin{Value}
An object of class \code{"histogram"}: see \code{\LinkA{hist}{hist}}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{seq.POSIXt}{seq.POSIXt}}, \code{\LinkA{axis.POSIXct}{axis.POSIXct}}, \code{\LinkA{hist}{hist}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
hist(.leap.seconds, "years", freq = TRUE)
hist(.leap.seconds,
     seq(ISOdate(1970, 1, 1), ISOdate(2015, 1, 1), "5 years"))

## 100 random dates in a 10-week period
random.dates <- as.Date("2001/1/1") + 70*stats::runif(100)
hist(random.dates, "weeks", format = "%d %b")
\end{ExampleCode}
\end{Examples}
\HeaderA{identify}{Identify Points in a Scatter Plot}{identify}
\methaliasA{identify.default}{identify}{identify.default}
\keyword{iplot}{identify}
%
\begin{Description}\relax
\code{identify} reads the position of the graphics pointer when the
(first) mouse button is pressed.  It then searches the coordinates
given in \code{x} and \code{y} for the point closest to the pointer.
If this point is close enough to the pointer, its index will be returned as
part of the value of the call.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
identify(x, ...)

## Default S3 method:
identify(x, y = NULL, labels = seq_along(x), pos = FALSE,
         n = length(x), plot = TRUE, atpen = FALSE, offset = 0.5,
         tolerance = 0.25, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] coordinates of points in a scatter plot.  Alternatively, any
object which defines coordinates (a plotting structure, time
series etc: see \code{\LinkA{xy.coords}{xy.coords}}) can be given as \code{x},
and \code{y} left missing.
\item[\code{labels}] an optional character vector giving labels for the
points.  Will be coerced using \code{\LinkA{as.character}{as.character}}, and
recycled if necessary to the length of \code{x}.  Excess labels will
be discarded, with a warning.
\item[\code{pos}] if \code{pos} is \code{TRUE}, a component is added to the
return value which indicates where text was plotted relative to each
identified point: see Value.
\item[\code{n}] the maximum number of points to be identified.
\item[\code{plot}] logical: if \code{plot} is \code{TRUE}, the labels are
printed near the points and if \code{FALSE} they are omitted.
\item[\code{atpen}] logical: if \code{TRUE} and \code{plot = TRUE}, the
lower-left corners of the labels are plotted at the points clicked
rather than relative to the points.
\item[\code{offset}] the distance (in character widths) which separates the
label from identified points.  Negative values are allowed.  Not
used if \code{atpen = TRUE}.
\item[\code{tolerance}] the maximal distance (in inches) for the pointer to be
`close enough' to a point.
\item[\code{...}] further arguments passed to \code{\LinkA{par}{par}} such as
\code{cex}, \code{col} and \code{font}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{identify} is a generic function, and only the default method is
described here.

\code{identify} is only supported on screen devices such as
\code{X11}, \code{windows} and \code{quartz}.  On other devices the
call will do nothing.

Clicking near (as defined by \code{tolerance}) a point adds it to the
list of identified points.  Points can be identified only once, and if
the point has already been identified or the click is not
near any of the points a message is printed immediately on
the \R{} console.

If \code{plot} is \code{TRUE}, the point is labelled with the
corresponding element of \code{labels}.  If \code{atpen} is false (the
default) the labels are placed below, to the left, above or to the
right of the identified point, depending on where the pointer was
relative to the point.  If \code{atpen} is true, the
labels are placed with the bottom left of the string's box at the
pointer.

The identification process is terminated by clicking the second button
and selecting `Stop' from the menu, or from the `Stop'
menu on the graphics window.

On most devices which support \code{identify}, successful selection of
a point is indicated by a bell sound unless
\code{\LinkA{options}{options}(locatorBell = FALSE)} has been set.

If the window is resized or hidden and then exposed before the identification
process has terminated, any labels drawn by \code{identify}
will disappear.  These will reappear once the identification process has 
terminated and the window is resized or hidden and exposed again.
This is because the labels drawn by \code{identify} are not
recorded in the device's display list until the identification process has
terminated.

If you interrupt the \code{identify} call this leaves the graphics
device in an undefined state, with points labelled but labels not
recorded in the display list.  Copying a device in that state
(e.g. saving the plot from the window's menu)
will give unpredictable results.
\end{Details}
%
\begin{Value}
If \code{pos} is \code{FALSE}, an integer vector containing the
indices of the identified points, in the order they were identified.

If \code{pos} is \code{TRUE}, a list containing a component
\code{ind}, indicating which points were identified and a component
\code{pos}, indicating where the labels were placed relative to the
identified points (1=below, 2=left, 3=above, 4=right and 0=no offset,
used if \code{atpen = TRUE}).
\end{Value}
%
\begin{Section}{Technicalities}
The algorithm used for placing labels is the same as used by
\code{text} if \code{pos} is specified there, the difference being
that the position of the pointer relative the identified point
determines \code{pos} in \code{identify}.

For labels placed to the left of a point, the right-hand edge of the
string's box is placed \code{offset} units to the left of the point,
and analogously for points to the right.  The baseline of the text is
placed below the point so as to approximately centre string vertically.
For labels placed above or below a point, the string is centered
horizontally on the point.  For labels placed above, the baseline of
the text is placed \code{offset} units above the point, and
for those placed below, the baseline is placed so that the top
of the string's box is approximately \code{offset} units below the
point.  If you want more precise placement (e.g. centering) use
\code{plot = FALSE} and plot via \code{\LinkA{text}{text}} or
\code{\LinkA{points}{points}}: see the examples.
\end{Section}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{locator}{locator}}, \code{\LinkA{text}{text}}.

\code{\LinkA{dev.capabilities}{dev.capabilities}} to see if it is supported.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## A function to use identify to select points, and overplot the
## points with another symbol as they are selected
identifyPch <- function(x, y=NULL, n=length(x), pch=19, ...)
{
    xy <- xy.coords(x, y); x <- xy$x; y <- xy$y
    sel <- rep(FALSE, length(x)); res <- integer(0)
    while(sum(sel) < n) {
        ans <- identify(x[!sel], y[!sel], n=1, plot=FALSE, ...)
        if(!length(ans)) break
        ans <- which(!sel)[ans]
        points(x[ans], y[ans], pch = pch)
        sel[ans] <- TRUE
        res <- c(res, ans)
    }
    res
}
\end{ExampleCode}
\end{Examples}
\HeaderA{image}{Display a Color Image}{image}
\methaliasA{image.default}{image}{image.default}
\keyword{hplot}{image}
\keyword{aplot}{image}
%
\begin{Description}\relax
Creates a grid of colored or gray-scale rectangles with colors
corresponding to the values in \code{z}.  This can be used to display
three-dimensional or spatial data aka \emph{images}.
This is a generic function.

The functions \code{\LinkA{heat.colors}{heat.colors}}, \code{\LinkA{terrain.colors}{terrain.colors}}
and \code{\LinkA{topo.colors}{topo.colors}} create heat-spectrum (red to white) and
topographical color schemes suitable for displaying ordered data, with
\code{n} giving the number of colors desired.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
image(x, ...)

## Default S3 method:
image(x, y, z, zlim, xlim, ylim, col = heat.colors(12),
      add = FALSE, xaxs = "i", yaxs = "i", xlab, ylab,
      breaks, oldstyle = FALSE, useRaster, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] locations of grid lines at which the values in \code{z} are
measured.  These must be finite, non-missing and in (strictly)
ascending order.  By default, equally
spaced values from 0 to 1 are used.  If \code{x} is a \code{list},
its components \code{x\$x} and \code{x\$y} are used for \code{x}
and \code{y}, respectively. If the list has component \code{z} this
is used for \code{z}.
\item[\code{z}] a matrix containing the values to be plotted (\code{NA}s are
allowed).  Note that \code{x} can be used instead of \code{z} for
convenience.
\item[\code{zlim}] the minimum and maximum \code{z} values for which colors
should be plotted, defaulting to the range of the finite values of
\code{z}. Each of the given colors will be used to color an
equispaced interval of this range. The \emph{midpoints} of the
intervals cover the range, so that values just outside the range
will be plotted.
\item[\code{xlim, ylim}] ranges for the plotted \code{x} and \code{y} values,
defaulting to the ranges of \code{x} and \code{y}.
\item[\code{col}] a list of colors such as that generated by
\code{\LinkA{rainbow}{rainbow}}, \code{\LinkA{heat.colors}{heat.colors}},
\code{\LinkA{topo.colors}{topo.colors}}, \code{\LinkA{terrain.colors}{terrain.colors}} or similar
functions.
\item[\code{add}] logical; if \code{TRUE}, add to current plot (and disregard
the following four arguments).  This is rarely useful because
\code{image} `paints' over existing graphics.
\item[\code{xaxs, yaxs}] style of x and y axis.  The default \code{"i"} is
appropriate for images.  See \code{\LinkA{par}{par}}.
\item[\code{xlab, ylab}] each a character string giving the labels for the x and
y axis.  Default to the `call names' of \code{x} or \code{y}, or to
\code{""} if these were unspecified.
\item[\code{breaks}] a set of breakpoints for the colours: must give one more
breakpoint than colour and be sorted in increasing order.
\item[\code{oldstyle}] logical. If true the midpoints of the colour intervals
are equally spaced, and \code{zlim[1]} and \code{zlim[2]} were taken
to be midpoints.  The default is to have colour intervals of equal
lengths between the limits.
\item[\code{useRaster}] logical; if \code{TRUE} a bitmap raster is used to
plot the image instead of polygons. The grid must be regular in that
case, otherwise an error is raised.   For the behaviour when this is
not specified, see `Details'.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} for \code{\LinkA{plot}{plot}} may also be
passed as arguments to this function, as can the plot aspect ratio
\code{asp} and \code{axes} (see \code{\LinkA{plot.window}{plot.window}}).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The length of \code{x} should be equal to the \code{nrow(z)+1} or
\code{nrow(z)}.  In the first case \code{x} specifies the boundaries
between the cells: in the second case \code{x} specifies the midpoints
of the cells.  Similar reasoning applies to \code{y}.  It probably
only makes sense to specify the midpoints of an equally-spaced
grid.  If you specify just one row or column and a length-one \code{x}
or \code{y}, the whole user area in the corresponding direction is
filled. For logarithmic \code{x} or \code{y} axes the boundaries between 
cells must be specified.

Rectangles corresponding to missing values are not plotted (and so are
transparent and (unless \code{add=TRUE}) the default background painted
in \code{par("bg")} will show though and if that is transparent, the
canvas colour will be seen).

If \code{breaks} is specified then \code{zlim} is unused and the
algorithm used follows \code{\LinkA{cut}{cut}}, so intervals are closed on
the right and open on the left except for the lowest interval.

Notice that \code{image} interprets the \code{z} matrix as a table of
\code{f(x[i], y[j])} values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
i.e. a 90 degree counter-clockwise rotation of the conventional
printed layout of a matrix.

Images for large \code{z} on a regular grid are rendered more
efficiently with \code{useRaster = TRUE} and can prevent rare
anti-aliasing artifacts, but may not be supported by all graphics
devices.  Some devices (such as \code{postscript} and \code{X11(type =
  "Xlib")}) which do not support semi-transparent colours may emit
missing values as white rather than transparent, and there may be
limitations on the size of a raster image.  (Problems with the
rendering of raster images have been reported by users of
\code{windows()} devices under Remote Desktop, at least under its
default settings.)

The graphics files in PDF and PostScript can be much smaller under
this option.

If \code{useRaster} is not specified, raster images are used when the
\code{\LinkA{getOption}{getOption}("preferRaster")} is true, the grid is regular
and either \code{\LinkA{dev.capabilities}{dev.capabilities}("raster")} is \code{"yes"} or
it is \code{"non-missing"} and there are no missing values.
\end{Details}
%
\begin{Note}\relax
Originally based on a function by Thomas Lumley.
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{filled.contour}{filled.contour}} or \code{\LinkA{heatmap}{heatmap}} which can
look nicer (but are less modular),
\code{\LinkA{contour}{contour}};
The \Rhref{http://CRAN.R-project.org/package=lattice}{\pkg{lattice}} equivalent of \code{image} is
\code{\LinkA{levelplot}{levelplot}}.

\code{\LinkA{heat.colors}{heat.colors}}, \code{\LinkA{topo.colors}{topo.colors}},
\code{\LinkA{terrain.colors}{terrain.colors}}, \code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{hsv}{hsv}}, \code{\LinkA{par}{par}}.

\code{\LinkA{dev.capabilities}{dev.capabilities}} to see if \code{useRaster = TRUE} is
supported on the current device.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices) # for colours
x <- y <- seq(-4*pi, 4*pi, len=27)
r <- sqrt(outer(x^2, y^2, "+"))
image(z = z <- cos(r^2)*exp(-r/6), col=gray((0:32)/32))
image(z, axes = FALSE, main = "Math can be beautiful ...",
      xlab = expression(cos(r^2) * e^{-r/6}))
contour(z, add = TRUE, drawlabels = FALSE)

# Volcano data visualized as matrix. Need to transpose and flip
# matrix horizontally.
image(t(volcano)[ncol(volcano):1,])

# A prettier display of the volcano
x <- 10*(1:nrow(volcano))
y <- 10*(1:ncol(volcano))
image(x, y, volcano, col = terrain.colors(100), axes = FALSE)
contour(x, y, volcano, levels = seq(90, 200, by = 5),
        add = TRUE, col = "peru")
axis(1, at = seq(100, 800, by = 100))
axis(2, at = seq(100, 600, by = 100))
box()
title(main = "Maunga Whau Volcano", font.main = 4)
\end{ExampleCode}
\end{Examples}
\HeaderA{layout}{Specifying Complex Plot Arrangements}{layout}
\methaliasA{layout.show}{layout}{layout.show}
\aliasA{lcm}{layout}{lcm}
\keyword{iplot}{layout}
\keyword{dplot}{layout}
\keyword{environment}{layout}
%
\begin{Description}\relax
\code{layout} divides the device up into as many rows and columns as
there are in matrix \code{mat}, with the column-widths and the
row-heights specified in the respective arguments.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
layout(mat, widths = rep(1, ncol(mat)),
       heights = rep(1, nrow(mat)), respect = FALSE)

layout.show(n = 1)
lcm(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{mat}] a matrix object specifying the location of the next
\eqn{N}{} figures on the output device.  Each value in the matrix must
be \code{0} or a positive integer.  If \eqn{N}{} is the largest
positive integer in the matrix, then the integers
\eqn{\{1, \dots, N-1\}}{} must also appear at least once in the matrix.
\item[\code{widths}] a vector of values for the widths of columns on the
device.  Relative widths are specified with numeric values.    Absolute
widths (in centimetres) are specified with the \code{lcm()} function (see
examples).
\item[\code{heights}] a vector of values for the heights of rows on the device.
Relative and absolute heights can be specified, see \code{widths} above.
\item[\code{respect}] either a logical value or a matrix object.  If the
latter, then it must have the same dimensions as \code{mat} and
each value in the matrix must be either \code{0} or \code{1}.
\item[\code{n}] number of figures to plot.
\item[\code{x}] a dimension to be interpreted as a number of centimetres.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Figure \eqn{i}{} is allocated a region composed from a subset
of these rows and columns, based on the rows and columns
in which \eqn{i}{} occurs in \code{mat}.

The \code{respect} argument controls whether a unit column-width is
the same physical measurement on the device as a unit row-height.

There is a limit (currently 50) for the numbers of rows and columns
in the layout, and also for the total number of cells (500).

\code{layout.show(n)} plots (part of) the current layout, namely the
outlines of the next \code{n} figures.

\code{lcm} is a trivial function, to be used as \emph{the} interface
for specifying absolute dimensions for the \code{widths} and
\code{heights} arguments of \code{layout()}.
\end{Details}
%
\begin{Value}
\code{layout} returns the number of figures, \eqn{N}{}, see above.
\end{Value}
%
\begin{Section}{Warnings}
These functions are totally incompatible with the other mechanisms for
arranging plots on a device: \code{\LinkA{par}{par}(mfrow)},
\code{par(mfcol)} and \code{\LinkA{split.screen}{split.screen}}.
\end{Section}
%
\begin{Author}\relax
Paul R. Murrell
\end{Author}
%
\begin{References}\relax
Murrell, P. R. (1999) Layouts: A mechanism for arranging plots on a page.
\emph{Journal of Computational and Graphical Statistics},
\bold{8}, 121--134.

Chapter 5 of Paul Murrell's Ph.D. thesis.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{par}{par}} with arguments \code{mfrow}, \code{mfcol}, or
\code{mfg}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
def.par <- par(no.readonly = TRUE) # save default, for resetting...

## divide the device into two rows and two columns
## allocate figure 1 all of row 1
## allocate figure 2 the intersection of column 2 and row 2
layout(matrix(c(1,1,0,2), 2, 2, byrow = TRUE))
## show the regions that have been allocated to each plot
layout.show(2)

## divide device into two rows and two columns
## allocate figure 1 and figure 2 as above
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,0,2), 2, 2, byrow=TRUE), respect=TRUE)
layout.show(nf)

## create single figure which is 5cm square
nf <- layout(matrix(1), widths=lcm(5), heights=lcm(5))
layout.show(nf)


##-- Create a scatterplot with marginal histograms -----

x <- pmin(3, pmax(-3, stats::rnorm(50)))
y <- pmin(3, pmax(-3, stats::rnorm(50)))
xhist <- hist(x, breaks=seq(-3,3,0.5), plot=FALSE)
yhist <- hist(y, breaks=seq(-3,3,0.5), plot=FALSE)
top <- max(c(xhist$counts, yhist$counts))
xrange <- c(-3,3)
yrange <- c(-3,3)
nf <- layout(matrix(c(2,0,1,3),2,2,byrow=TRUE), c(3,1), c(1,3), TRUE)
layout.show(nf)

par(mar=c(3,3,1,1))
plot(x, y, xlim=xrange, ylim=yrange, xlab="", ylab="")
par(mar=c(0,3,1,1))
barplot(xhist$counts, axes=FALSE, ylim=c(0, top), space=0)
par(mar=c(3,0,1,1))
barplot(yhist$counts, axes=FALSE, xlim=c(0, top), space=0, horiz=TRUE)

par(def.par)#- reset to default
\end{ExampleCode}
\end{Examples}
\HeaderA{legend}{Add Legends to Plots}{legend}
\keyword{aplot}{legend}
%
\begin{Description}\relax
This function can be used to add legends to plots.  Note that a call
to the function \code{\LinkA{locator}{locator}(1)} can be used in place of the \code{x}
and \code{y} arguments.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
legend(x, y = NULL, legend, fill = NULL, col = par("col"),
       border="black", lty, lwd, pch,
       angle = 45, density = NULL, bty = "o", bg = par("bg"),
       box.lwd = par("lwd"), box.lty = par("lty"), box.col = par("fg"),
       pt.bg = NA, cex = 1, pt.cex = cex, pt.lwd = lwd,
       xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,
       adj = c(0, 0.5), text.width = NULL, text.col = par("col"), text.font = NULL,
       merge = do.lines && has.pch, trace = FALSE,
       plot = TRUE, ncol = 1, horiz = FALSE, title = NULL,
       inset = 0, xpd, title.col = text.col, title.adj = 0.5,
       seg.len = 2)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the x and y co-ordinates to be used to position the legend.
They can be specified by keyword or in any way which is accepted by
\code{\LinkA{xy.coords}{xy.coords}}: See `Details'.
\item[\code{legend}] a character or \LinkA{expression}{expression} vector.
of length \eqn{\ge 1}{} to appear in the legend.  Other
objects will be coerced by \code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}.
\item[\code{fill}] if specified, this argument will cause boxes filled
with the specified colors (or shaded in the specified colors)
to appear beside the legend text.
\item[\code{col}] the color of points or lines appearing in the legend.
\item[\code{border}] the border color for the boxes (used only if
\code{fill} is specified).
\item[\code{lty, lwd}] the line types and widths for lines appearing in the
legend.  One of these two \emph{must} be specified for line drawing.
\item[\code{pch}] the plotting symbols appearing in the legend, either as
vector of 1-character strings, or one (multi character)
string.  \emph{Must} be specified for symbol drawing.
\item[\code{angle}] angle of shading lines.
\item[\code{density}] the density of shading lines, if numeric and
positive. If \code{NULL} or negative or \code{NA} color filling
is assumed.
\item[\code{bty}] the type of box to be drawn around the legend.  The allowed
values are \code{"o"} (the default) and \code{"n"}.
\item[\code{bg}] the background color for the legend box.  (Note that this is
only used if \code{bty != "n"}.)
\item[\code{box.lty, box.lwd, box.col}] the line type, width and color for
the legend box (if \code{bty = "o"}).
\item[\code{pt.bg}] the background color for the \code{\LinkA{points}{points}},
corresponding to its argument \code{bg}.
\item[\code{cex}] character expansion factor \bold{relative} to current
\code{par("cex")}.  Used for text, and provides the default for
\code{pt.cex} and \code{title.cex}.
\item[\code{pt.cex}] expansion factor(s) for the points.
\item[\code{pt.lwd}] line width for the points, defaults to the one for
lines, or if that is not set, to \code{par("lwd")}.
\item[\code{xjust}] how the legend is to be justified relative to the legend
x location.  A value of 0 means left justified, 0.5 means centered
and 1 means right justified.
\item[\code{yjust}] the same as \code{xjust} for the legend y location.
\item[\code{x.intersp}] character interspacing factor for horizontal (x) spacing.
\item[\code{y.intersp}] the same for vertical (y) line distances.
\item[\code{adj}] numeric of length 1 or 2; the string adjustment for legend
text.  Useful for y-adjustment when \code{labels} are
\LinkA{plotmath}{plotmath} expressions.
\item[\code{text.width}] the width of the legend text in x (\code{"user"})
coordinates.  (Should be positive even for a reversed x axis.)
Defaults to the proper value computed by \code{\LinkA{strwidth}{strwidth}(legend)}.
\item[\code{text.col}] the color used for the legend text.
\item[\code{text.font}] the font used for the legend text, see \code{\LinkA{text}{text}}.
\item[\code{merge}] logical; if \code{TRUE}, merge points and lines but
not filled boxes.  Defaults to \code{TRUE} if there are points and lines.
\item[\code{trace}] logical; if \code{TRUE}, shows how \code{legend} does all
its magical computations.
\item[\code{plot}] logical.  If \code{FALSE}, nothing is plotted but the
sizes are returned.
\item[\code{ncol}] the number of columns in which to set the legend items
(default is 1, a vertical legend).
\item[\code{horiz}] logical; if \code{TRUE}, set the legend horizontally
rather than vertically (specifying \code{horiz} overrides the \code{ncol}
specification).
\item[\code{title}] a character string or length-one expression giving a
title to be placed at the top of the legend.  Other objects will be
coerced by \code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}.
\item[\code{inset}] inset distance(s) from the margins as a fraction of the
plot region when legend is placed by keyword.
\item[\code{xpd}] if supplied, a value of the \LinkA{graphical parameter}{graphical parameter} \code{xpd}
to be used while the legend is being drawn.
\item[\code{title.col}] color for \code{title}.
\item[\code{title.adj}] horizontal adjustment for \code{title}: see the help
for \code{\LinkA{par}{par}("adj")}.
\item[\code{seg.len}] the length of lines drawn to illustrate \code{lty}
and/or \code{lwd} (in units of character widths).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Arguments \code{x}, \code{y}, \code{legend} are interpreted in a
non-standard way to allow the coordinates to be specified \emph{via}
one or two arguments.  If \code{legend} is missing and \code{y} is not
numeric, it is assumed that the second argument is intended to be
\code{legend} and that the first argument specifies the coordinates.

The coordinates can be specified in any way which is accepted by
\code{\LinkA{xy.coords}{xy.coords}}.  If this gives the coordinates of one point,
it is used as the top-left coordinate of the rectangle containing the
legend.  If it gives the coordinates of two points, these specify
opposite corners of the rectangle (either pair of corners, in any
order).

The location may also be specified by setting \code{x} to a single
keyword from the list \code{"bottomright"}, \code{"bottom"},
\code{"bottomleft"}, \code{"left"}, \code{"topleft"},
\code{"top"}, \code{"topright"}, \code{"right"} and
\code{"center"}. This places the legend on the inside of the plot
frame at the given location. Partial argument matching is used.  The
optional \code{inset} argument specifies how far the legend is inset
from the plot margins.  If a single value is given, it is used for
both margins; if two values are given, the first is used for \code{x}-
distance, the second for \code{y}-distance.

Attribute arguments such as \code{col}, \code{pch}, \code{lty}, etc,
are recycled if necessary: \code{merge} is not.  Set entries of
\code{lty} to \code{0} or set entries of \code{lwd} to \code{NA} to
suppress lines in corresponding legend entries; set \code{pch}
values to \code{NA} to suppress points.

Points are drawn \emph{after} lines in order that they can cover the
line with their background color \code{pt.bg}, if applicable.

See the examples for how to right-justify labels.
\end{Details}
%
\begin{Value}
A list with list components
\begin{ldescription}
\item[\code{rect}] a list with components
\begin{description}

\item[\code{w}, \code{h}] positive numbers giving \bold{w}idth and
\bold{h}eight of the legend's box.
\item[\code{left}, \code{top}] x and y coordinates of upper left
corner of the box.

\end{description}


\item[\code{text}] a list with components
\begin{description}

\item[\code{x, y}] numeric vectors of length \code{length(legend)},
giving the x and y coordinates of the legend's text(s).

\end{description}


\end{ldescription}
returned invisibly.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot}{plot}}, \code{\LinkA{barplot}{barplot}} which uses \code{legend()}, and
\code{\LinkA{text}{text}} for more examples of math expressions.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Run the example in '?matplot' or the following:
leg.txt <- c("Setosa     Petals", "Setosa     Sepals",
             "Versicolor Petals", "Versicolor Sepals")
y.leg <- c(4.5, 3, 2.1, 1.4, .7)
cexv  <- c(1.2, 1, 4/5, 2/3, 1/2)
matplot(c(1,8), c(0,4.5), type = "n", xlab = "Length", ylab = "Width",
        main = "Petal and Sepal Dimensions in Iris Blossoms")
for (i in seq(cexv)) {
  text  (1, y.leg[i]-.1, paste("cex=",formatC(cexv[i])), cex=.8, adj = 0)
  legend(3, y.leg[i], leg.txt, pch = "sSvV", col = c(1, 3), cex = cexv[i])
}

## 'merge = TRUE' for merging lines & points:
x <- seq(-pi, pi, len = 65)
plot(x, sin(x), type = "l", ylim = c(-1.2, 1.8), col = 3, lty = 2)
points(x, cos(x), pch = 3, col = 4)
lines(x, tan(x), type = "b", lty = 1, pch = 4, col = 6)
title("legend(..., lty = c(2, -1, 1), pch = c(-1,3,4), merge = TRUE)",
      cex.main = 1.1)
legend(-1, 1.9, c("sin", "cos", "tan"), col = c(3,4,6),
       text.col = "green4", lty = c(2, -1, 1), pch = c(-1, 3, 4),
       merge = TRUE, bg = 'gray90')

## right-justifying a set of labels: thanks to Uwe Ligges
x <- 1:5; y1 <- 1/x; y2 <- 2/x
plot(rep(x, 2), c(y1, y2), type="n", xlab="x", ylab="y")
lines(x, y1); lines(x, y2, lty=2)
temp <- legend("topright", legend = c(" ", " "),
               text.width = strwidth("1,000,000"),
               lty = 1:2, xjust = 1, yjust = 1,
               title = "Line Types")
text(temp$rect$left + temp$rect$w, temp$text$y,
     c("1,000", "1,000,000"), pos=2)


##--- log scaled Examples ------------------------------
leg.txt <- c("a one", "a two")

par(mfrow = c(2,2))
for(ll in c("","x","y","xy")) {
  plot(2:10, log=ll, main=paste("log = '",ll,"'", sep=""))
  abline(1,1)
  lines(2:3,3:4, col=2) #
  points(2,2, col=3)    #
  rect(2,3,3,2, col=4)
  text(c(3,3),2:3, c("rect(2,3,3,2, col=4)",
                     "text(c(3,3),2:3,\"c(rect(...)\")"), adj = c(0,.3))
  legend(list(x=2,y=8), legend = leg.txt, col=2:3, pch=1:2,
         lty=1, merge=TRUE)#, trace=TRUE)
}
par(mfrow=c(1,1))

##-- Math expressions:  ------------------------------
x <- seq(-pi, pi, len = 65)
plot(x, sin(x), type="l", col = 2, xlab = expression(phi),
     ylab = expression(f(phi)))
abline(h=-1:1, v=pi/2*(-6:6), col="gray90")
lines(x, cos(x), col = 3, lty = 2)
ex.cs1 <- expression(plain(sin) * phi,  paste("cos", phi))# 2 ways
utils::str(legend(-3, .9, ex.cs1, lty=1:2, plot=FALSE,
           adj = c(0, .6)))# adj y !
legend(-3, .9, ex.cs1, lty=1:2, col=2:3,    adj = c(0, .6))

require(stats)
x <- rexp(100, rate = .5)
hist(x, main = "Mean and Median of a Skewed Distribution")
abline(v = mean(x),   col=2, lty=2, lwd=2)
abline(v = median(x), col=3, lty=3, lwd=2)
ex12 <- expression(bar(x) == sum(over(x[i], n), i==1, n),
                   hat(x) == median(x[i], i==1,n))
utils::str(legend(4.1, 30, ex12, col = 2:3, lty=2:3, lwd=2))

## 'Filled' boxes -- for more, see example(plot.factor)
op <- par(bg="white") # to get an opaque box for the legend
plot(cut(weight, 3) ~ group, data = PlantGrowth, col = NULL,
     density = 16*(1:3))
par(op)

## Using 'ncol' :
x <- 0:64/64
matplot(x, outer(x, 1:7, function(x, k) sin(k * pi * x)),
        type = "o", col = 1:7, ylim = c(-1, 1.5), pch = "*")
op <- par(bg="antiquewhite1")
legend(0, 1.5, paste("sin(", 1:7, "pi * x)"), col=1:7, lty=1:7,
       pch = "*", ncol = 4, cex = 0.8)
legend(.8,1.2, paste("sin(", 1:7, "pi * x)"), col=1:7, lty=1:7,
       pch = "*", cex = 0.8)
legend(0, -.1, paste("sin(", 1:4, "pi * x)"), col=1:4, lty=1:4,
       ncol = 2, cex = 0.8)
legend(0, -.4, paste("sin(", 5:7, "pi * x)"), col=4:6,  pch=24,
       ncol = 2, cex = 1.5, lwd = 2, pt.bg = "pink", pt.cex = 1:3)
par(op)

## point covering line :
y <- sin(3*pi*x)
plot(x, y, type="l", col="blue",
    main = "points with bg & legend(*, pt.bg)")
points(x, y, pch=21, bg="white")
legend(.4,1, "sin(c x)", pch=21, pt.bg="white", lty=1, col = "blue")

## legends with titles at different locations
plot(x, y, type='n')
legend("bottomright", "(x,y)", pch=1, title="bottomright")
legend("bottom", "(x,y)", pch=1, title="bottom")
legend("bottomleft", "(x,y)", pch=1, title="bottomleft")
legend("left", "(x,y)", pch=1, title="left")
legend("topleft", "(x,y)", pch=1, title="topleft, inset = .05",
       inset = .05)
legend("top", "(x,y)", pch=1, title="top")
legend("topright", "(x,y)", pch=1, title="topright, inset = .02",
       inset = .02)
legend("right", "(x,y)", pch=1, title="right")
legend("center", "(x,y)", pch=1, title="center")

# using text.font (and text.col):
op <- par(mfrow = c(2, 2), mar=rep(2.1,4))
c6 <- terrain.colors(10)[1:6]
for(i in 1:4) {
   plot(1, type = "n", axes=FALSE, ann=FALSE); title(paste("text.font =",i))
   legend("top", legend = LETTERS[1:6], col = c6,
          ncol =2, cex = 2, lwd = 3, text.font = i, text.col = c6)
}
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{lines}{Add Connected Line Segments to a Plot}{lines}
\methaliasA{lines.default}{lines}{lines.default}
\keyword{aplot}{lines}
%
\begin{Description}\relax
A generic function taking coordinates given in various ways and
joining the corresponding points with line segments.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
lines(x, ...)

## Default S3 method:
lines(x, y = NULL, type = "l", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] coordinate vectors of points to join.
\item[\code{type}] character indicating the type of plotting; actually any of
the \code{type}s as in \code{\LinkA{plot.default}{plot.default}}.
\item[\code{...}] Further graphical parameters (see \code{\LinkA{par}{par}}) may
also be supplied as arguments, particularly, line type, \code{lty},
line width, \code{lwd}, color, \code{col} and for \code{type = "b"},
\code{pch}.  Also the line characteristics \code{lend}, \code{ljoin}
and \code{lmitre}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The coordinates can be passed in a plotting structure
(a list with \code{x} and \code{y} components), a two-column matrix, a
time series, \dots.  See \code{\LinkA{xy.coords}{xy.coords}}.  If supplied
separately, they must be of the same length.

The coordinates can contain \code{NA} values. If a point contains
\code{NA} in either its \code{x} or \code{y} value, it is omitted from
the plot, and lines are not drawn to or from such points.  Thus
missing values can be used to achieve breaks in lines.

For \code{type = "h"}, \code{col} can be a vector and will be recycled
as needed.

\code{lwd} can be a vector: its first element will apply to lines but
the whole vector to symbols (recycled as necessary).
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{lines.formula}{lines.formula}} for the formula method;
\code{\LinkA{points}{points}}, particularly for \code{type \%in\% c("p","b","o")},
\code{\LinkA{plot}{plot}},
and the workhorse function \code{\LinkA{plot.xy}{plot.xy}}.

\code{\LinkA{abline}{abline}} for drawing (single) straight lines.

\code{\LinkA{par}{par}} for how to specify colors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
# draw a smooth line through a scatter plot
plot(cars, main="Stopping Distance versus Speed")
lines(stats::lowess(cars))
\end{ExampleCode}
\end{Examples}
\HeaderA{locator}{Graphical Input}{locator}
\keyword{iplot}{locator}
%
\begin{Description}\relax
Reads the position of the graphics cursor when the (first) mouse
button is pressed.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
locator(n = 512, type = "n", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{n}] the maximum number of points to locate.  Valid values start
at 1.
\item[\code{type}] One of \code{"n"}, \code{"p"}, \code{"l"} or
\code{"o"}. If \code{"p"} or \code{"o"} the points are
plotted; if \code{"l"}  or \code{"o"} they are joined by lines.
\item[\code{...}] additional graphics parameters used if \code{type != "n"}
for plotting the locations.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{locator} is only supported on screen devices such as
\code{X11}, \code{windows} and \code{quartz}.  On other devices the
call will do nothing.

Unless the process is terminated prematurely by the user (see below)
at most \code{n} positions are determined.

The identification process can be terminated by clicking the second
button and selecting `Stop' from the menu, or from the
`Stop' menu on the graphics window.

The current graphics parameters apply just as if \code{plot.default}
has been called with the same value of \code{type}. The plotting of
the points and lines is subject to clipping, but locations outside the
current clipping rectangle will be returned.

On most devices which support \code{locator}, successful selection of
a point is indicated by a bell sound unless
\code{\LinkA{options}{options}(locatorBell=FALSE)} has been set.

If the window is resized or hidden and then exposed before the input
process has terminated, any lines or points drawn by \code{locator}
will disappear.  These will reappear once the input process has
terminated and the window is resized or hidden and exposed again.
This is because the points and lines drawn by \code{locator} are not
recorded in the device's display list until the input process has
terminated.
\end{Details}
%
\begin{Value}
A list containing \code{x} and \code{y} components which are the
coordinates of the identified points in the user coordinate system,
i.e., the one specified by \code{\LinkA{par}{par}("usr")}.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{identify}{identify}}.

\code{\LinkA{dev.capabilities}{dev.capabilities}} to see if it is supported.
\end{SeeAlso}
\HeaderA{matplot}{Plot Columns of Matrices}{matplot}
\aliasA{matlines}{matplot}{matlines}
\aliasA{matpoints}{matplot}{matpoints}
\keyword{hplot}{matplot}
\keyword{aplot}{matplot}
\keyword{array}{matplot}
%
\begin{Description}\relax
Plot the columns of one matrix against the columns of another.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
matplot(x, y, type = "p", lty = 1:5, lwd = 1, lend = par("lend"),
        pch = NULL,
        col = 1:6, cex = NULL, bg = NA,
        xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL,
        ..., add = FALSE, verbose = getOption("verbose"))

matpoints(x, y, type = "p", lty = 1:5, lwd = 1, pch = NULL,
          col = 1:6, ...)

matlines (x, y, type = "l", lty = 1:5, lwd = 1, pch = NULL,
          col = 1:6, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] vectors or matrices of data for plotting.  The number of
rows should match.  If one of them are missing, the other is taken
as \code{y} and an \code{x} vector of \code{1:n} is used.
Missing values (\code{NA}s) are allowed.
\item[\code{type}] character string (length 1 vector) or vector of 1-character
strings indicating the type of plot for each
column of \code{y}, see \code{\LinkA{plot}{plot}} for all possible
\code{type}s.  The first character of \code{type}
defines the first plot, the second character the second, etc.
Characters in \code{type} are cycled through; e.g., \code{"pl"}
alternately plots points and lines.
\item[\code{lty,lwd,lend}] vector of line types, widths, and end styles.
The first element is for the first column, the second element for
the second column, etc., even if lines are not plotted for all
columns. Line types will be used cyclically until all plots are
drawn.
\item[\code{pch}] character string or vector of 1-characters or integers for
plotting characters, see \code{\LinkA{points}{points}}.
The first character is the plotting-character for the first plot,
the second for the second, etc.  The default is the digits (1
through 9, 0) then the lowercase and uppercase letters.






\item[\code{col}] vector of colors.  Colors are used cyclically.
\item[\code{cex}] vector of character expansion sizes, used cyclically.
This works as a multiple of \code{\LinkA{par}{par}("cex")}.  \code{NULL} is
equivalent to \code{1.0}. 
\item[\code{bg}] vector of background (fill) colors for the open plot
symbols given by \code{pch=21:25} as in \code{\LinkA{points}{points}}.  The
default \code{NA} corresponds to the one of the underlying function
\code{\LinkA{plot.xy}{plot.xy}}.
\item[\code{xlab, ylab}] titles for x and y axes, as in \code{\LinkA{plot}{plot}}.
\item[\code{xlim, ylim}] ranges of x and y axes, as in \code{\LinkA{plot}{plot}}.
\item[\code{...}] Graphical parameters (see \code{\LinkA{par}{par}}) and any further
arguments of \code{plot}, typically \code{\LinkA{plot.default}{plot.default}}, may also be
supplied as arguments to this function.  Hence, the high-level
graphics control arguments described under \code{\LinkA{par}{par}} and the
arguments to \code{\LinkA{title}{title}} may be supplied to this function.
\item[\code{add}] logical.  If \code{TRUE}, plots are added to current one,
using \code{\LinkA{points}{points}} and \code{\LinkA{lines}{lines}}.
\item[\code{verbose}] logical.  If \code{TRUE}, write one line of what is
done.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Points involving missing values are not plotted.

The first column of \code{x} is plotted against the first column of
\code{y}, the second column of \code{x} against the second column of
\code{y}, etc.  If one matrix has fewer columns, plotting will cycle
back through the columns again.  (In particular, either \code{x} or
\code{y} may be a vector, against which all columns of the other
argument will be plotted.)

The first element of \code{col, cex, lty, lwd} is used to plot the axes
as well as the first line.

Because plotting symbols are drawn with lines and because these
functions may be changing the line style, you should probably specify
\code{lty=1} when using plotting symbols.
\end{Details}
%
\begin{Section}{Side Effects}
Function \code{matplot} generates a new plot;
\code{matpoints} and \code{matlines} add to the current one.
\end{Section}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot}{plot}}, \code{\LinkA{points}{points}}, \code{\LinkA{lines}{lines}},
\code{\LinkA{matrix}{matrix}}, \code{\LinkA{par}{par}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices)
matplot((-4:5)^2, main = "Quadratic") # almost identical to plot(*)
sines <- outer(1:20, 1:4, function(x, y) sin(x / 20 * pi * y))
matplot(sines, pch = 1:4, type = "o", col = rainbow(ncol(sines)))
matplot(sines, type = "b", pch = 21:23, col = 2:5, bg = 2:5,
        main = "matplot(...., pch = 21:23, bg = 2:5)")

x <- 0:50/50
matplot(x, outer(x, 1:8, function(x, k) sin(k*pi * x)),
        ylim = c(-2,2), type = "plobcsSh",
        main= "matplot(,type = \"plobcsSh\" )")
## pch & type =  vector of 1-chars :
matplot(x, outer(x, 1:4, function(x, k) sin(k*pi * x)),
        pch = letters[1:4], type = c("b","p","o"))

lends <- c("round","butt","square")
matplot(matrix(1:12, 4), type="c", lty=1, lwd=10, lend=lends)
text(cbind(2.5, 2*c(1,3,5)-.4), lends, col= 1:3, cex = 1.5)

table(iris$Species) # is data.frame with 'Species' factor
iS <- iris$Species == "setosa"
iV <- iris$Species == "versicolor"
op <- par(bg = "bisque")
matplot(c(1, 8), c(0, 4.5), type= "n", xlab = "Length", ylab = "Width",
        main = "Petal and Sepal Dimensions in Iris Blossoms")
matpoints(iris[iS,c(1,3)], iris[iS,c(2,4)], pch = "sS", col = c(2,4))
matpoints(iris[iV,c(1,3)], iris[iV,c(2,4)], pch = "vV", col = c(2,4))
legend(1, 4, c("    Setosa Petals", "    Setosa Sepals",
               "Versicolor Petals", "Versicolor Sepals"),
       pch = "sSvV", col = rep(c(2,4), 2))

nam.var <- colnames(iris)[-5]
nam.spec <- as.character(iris[1+50*0:2, "Species"])
iris.S <- array(NA, dim = c(50,4,3),
                dimnames = list(NULL, nam.var, nam.spec))
for(i in 1:3) iris.S[,,i] <- data.matrix(iris[1:50+50*(i-1), -5])

matplot(iris.S[,"Petal.Length",], iris.S[,"Petal.Width",], pch="SCV",
        col = rainbow(3, start = .8, end = .1),
        sub = paste(c("S", "C", "V"), dimnames(iris.S)[[3]],
                    sep = "=", collapse= ",  "),
        main = "Fisher's Iris Data")
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{mosaicplot}{Mosaic Plots}{mosaicplot}
\methaliasA{mosaicplot.default}{mosaicplot}{mosaicplot.default}
\methaliasA{mosaicplot.formula}{mosaicplot}{mosaicplot.formula}
\keyword{hplot}{mosaicplot}
%
\begin{Description}\relax
Plots a mosaic on the current graphics device.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
mosaicplot(x, ...)

## Default S3 method:
mosaicplot(x, main = deparse(substitute(x)), 
           sub = NULL, xlab = NULL, ylab = NULL,
           sort = NULL, off = NULL, dir = NULL,
           color = NULL, shade = FALSE, margin = NULL,
           cex.axis = 0.66, las = par("las"), border = NULL,
           type = c("pearson", "deviance", "FT"), ...)

## S3 method for class 'formula'
mosaicplot(formula, data = NULL, ...,
           main = deparse(substitute(data)), subset,
           na.action = stats::na.omit)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a contingency table in array form, with optional category
labels specified in the \code{dimnames(x)} attribute.  The table is
best created by the \code{table()} command.
\item[\code{main}] character string for the mosaic title.
\item[\code{sub}] character string for the mosaic sub-title (at bottom).
\item[\code{xlab,ylab}] x- and y-axis labels used for the plot; by default,
the first and second element of \code{names(dimnames(X))} (i.e., the
name of the first and second variable in \code{X}).
\item[\code{sort}] vector ordering of the variables, containing a permutation
of the integers \code{1:length(dim(x))} (the default).
\item[\code{off}] vector of offsets to determine percentage spacing at each
level of the mosaic (appropriate values are between 0 and 20,
and the default is 20 times the number of splits for 2-dimensional
tables, and 10 otherwise.  Rescaled to maximally 50, and recycled if
necessary.
\item[\code{dir}] vector of split directions (\code{"v"} for vertical and
\code{"h"} for horizontal) for each level of the mosaic, one
direction for each dimension of the contingency table.  The
default consists of alternating directions, beginning with a
vertical split.
\item[\code{color}] logical or (recycling) vector of colors for color
shading, used only when \code{shade} is \code{FALSE}, or \code{NULL}
(default).  By default, grey boxes are drawn.  \code{color=TRUE}
uses a gamma-corrected grey palette.  \code{color=FALSE} gives empty
boxes with no shading.
\item[\code{shade}] a logical indicating whether to produce extended mosaic
plots, or a numeric vector of at most 5 distinct positive numbers
giving the absolute values of the cut points for the residuals.  By
default, \code{shade} is \code{FALSE}, and simple mosaics are
created.  Using \code{shade = TRUE} cuts absolute values at 2 and
4.
\item[\code{margin}] a list of vectors with the marginal totals to be fit in
the log-linear model.  By default, an independence model is fitted.
See \code{\LinkA{loglin}{loglin}} for further information.
\item[\code{cex.axis}] The magnification to be used for axis annotation,
as a multiple of \code{par("cex")}.
\item[\code{las}] numeric; the style of axis labels, see \code{\LinkA{par}{par}}.
\item[\code{border}] colour of borders of cells: see \code{\LinkA{polygon}{polygon}}.
\item[\code{type}] a character string indicating the type of residual to be
represented.  Must be one of \code{"pearson"} (giving components of
Pearson's \eqn{\chi^2}{}), \code{"deviance"} (giving
components of the likelihood ratio \eqn{\chi^2}{}), or
\code{"FT"} for the Freeman-Tukey residuals.  The value of this
argument can be abbreviated.
\item[\code{formula}] a formula, such as \code{y \textasciitilde{} x}.
\item[\code{data}] a data frame (or list), or a contingency table from which
the variables in \code{formula} should be taken.
\item[\code{...}] further arguments to be passed to or from methods.
\item[\code{subset}] an optional vector specifying a subset of observations
in the data frame to be used for plotting.
\item[\code{na.action}] a function which indicates what should happen
when the data contains variables to be cross-tabulated, and these
variables contain \code{NA}s.  The default is to omit cases which
have an \code{NA} in any variable.  Since the tabulation will omit
all cases containing missing values, this will only be useful if the
\code{na.action} function replaces missing values.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This is a generic function.  It currently has a default method
(\code{mosaicplot.default}) and a formula interface
(\code{mosaicplot.formula}).

Extended mosaic displays visualize standardized residuals of a
loglinear model for the table by color and outline of the mosaic's
tiles.  (Standardized residuals are often referred to a standard
normal distribution.)  Cells representing negative residuals are drawn
in shaded of red and with broken borders; positive ones are drawn in
blue with solid borders.

For the formula method, if \code{data} is an object inheriting from
class \code{"table"} or class \code{"ftable"} or an array with more
than 2 dimensions, it is taken as a contingency table, and hence all
entries should be non-negative.  In this case the left-hand side of
\code{formula} should be empty and the variables on the right-hand
side should be taken from the names of the dimnames attribute of the
contingency table.  A marginal table of these variables is computed,
and a mosaic plot of that table is produced.

Otherwise, \code{data} should be a data frame or matrix, list or
environment containing the variables to be cross-tabulated.  In this
case, after possibly selecting a subset of the data as specified by
the \code{subset} argument, a contingency table is computed from the
variables given in \code{formula}, and a mosaic is produced from
this.

See Emerson (1998) for more information and a case study with
television viewer data from Nielsen Media Research.

Missing values are not supported except via an \code{na.action}
function when \code{data} contains variables to be cross-tabulated.

A more flexible and extensible implementation of mosaic plots written
in the grid graphics system is provided in the function
\code{\LinkA{mosaic}{mosaic}} in the contributed package \Rhref{http://CRAN.R-project.org/package=vcd}{\pkg{vcd}}
(Meyer, Zeileis and Hornik, 2005).
\end{Details}
%
\begin{Author}\relax
S-PLUS original by John Emerson \email{john.emerson@yale.edu}.
Originally modified and enhanced for \R{} by Kurt Hornik.
\end{Author}
%
\begin{References}\relax
Hartigan, J.A., and Kleiner, B. (1984)
A mosaic of television ratings. \emph{The American Statistician},
\bold{38}, 32--35.

Emerson, J. W. (1998)
Mosaic displays in S-PLUS: A general implementation and a case study.
\emph{Statistical Computing and Graphics Newsletter (ASA)},
\bold{9}, 1, 17--23.

Friendly, M. (1994)
Mosaic displays for multi-way contingency tables.
\emph{Journal of the American Statistical Association}, \bold{89},
190--200.

Meyer, D., Zeileis, A., and Hornik, K. (2005)
The strucplot framework: Visualizing multi-way contingency tables with vcd.
\emph{Report 22}, Department of Statistics and Mathematics, 
WirtschaftsuniversitÃ¤t Wien, Research Report Series.
\url{http://epub.wu.ac.at/dyn/openURL?id=oai:epub.wu-wien.ac.at:epub-wu-01_8a1}

The home page of Michael Friendly
(\url{http://www.math.yorku.ca/SCS/friendly.html}) provides
information on various aspects of graphical methods for analyzing
categorical data, including mosaic plots.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{assocplot}{assocplot}},
\code{\LinkA{loglin}{loglin}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
mosaicplot(Titanic, main = "Survival on the Titanic", color = TRUE)
## Formula interface for tabulated data:
mosaicplot(~ Sex + Age + Survived, data = Titanic, color = TRUE)

mosaicplot(HairEyeColor, shade = TRUE)
## Independence model of hair and eye color and sex.  Indicates that
## there are more blue eyed blonde females than expected in the case 
## of independence and too few brown eyed blonde females.
## The corresponding model is:
fm <- loglin(HairEyeColor, list(1, 2, 3))
pchisq(fm$pearson, fm$df, lower.tail = FALSE)

mosaicplot(HairEyeColor, shade = TRUE, margin = list(1:2, 3))
## Model of joint independence of sex from hair and eye color.  Males
## are underrepresented among people with brown hair and eyes, and are
## overrepresented among people with brown hair and blue eyes.
## The corresponding model is:
fm <- loglin(HairEyeColor, list(1:2, 3))
pchisq(fm$pearson, fm$df, lower.tail = FALSE)

## Formula interface for raw data: visualize cross-tabulation of numbers
## of gears and carburettors in Motor Trend car data.
mosaicplot(~ gear + carb, data = mtcars, color = TRUE, las = 1)
# color recycling
mosaicplot(~ gear + carb, data = mtcars, color = 2:3, las = 1)
\end{ExampleCode}
\end{Examples}
\HeaderA{mtext}{Write Text into the Margins of a Plot}{mtext}
\keyword{aplot}{mtext}
%
\begin{Description}\relax
Text is written in one of the four margins of the current figure region
or one of the outer margins of the device region.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
mtext(text, side = 3, line = 0, outer = FALSE, at = NA,
      adj = NA, padj = NA, cex = NA, col = NA, font = NA, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{text}] a character or \LinkA{expression}{expression} vector specifying
the \emph{text} to be written.  Other objects are coerced by
\code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}.
\item[\code{side}] on which side of the plot (1=bottom, 2=left, 3=top, 4=right).
\item[\code{line}] on which MARgin line, starting at 0 counting outwards.
\item[\code{outer}] use outer margins if available.
\item[\code{at}] give location of each string in user coordinates.  If the
component of \code{at} corresponding to a particular text item is
not a finite value (the default), the location will be determined
by \code{adj}.
\item[\code{adj}] adjustment for each string in reading direction.  For
strings parallel to the axes, \code{adj = 0} means left or bottom
alignment, and \code{adj = 1} means right or top alignment.

If \code{adj} is not a finite value (the default), the value of
\code{par("las")} determines the adjustment.  For strings plotted
parallel to the axis the default is to centre the string.
\item[\code{padj}] adjustment for each string perpendicular to the reading
direction (which is controlled by \code{adj}).  For strings parallel
to the axes, \code{padj = 0} means right or top alignment, 
and \code{padj = 1} means left or bottom alignment.

If \code{padj} is not a finite value (the default), the value of
\code{par("las")} determines the adjustment.  For strings plotted
perpendicular to the axis the default is to centre the string.
\item[\code{cex}] character expansion factor.  \code{NULL} and \code{NA}
are equivalent to \code{1.0}.  This is an absolute measure, not
scaled by \code{par("cex")} or by setting \code{par("mfrow")}
or \code{par("mfcol")}.  Can be a vector.
\item[\code{col}] color to use.  Can be a vector.  \code{NA} values (the
default) mean use \code{par("col")}.
\item[\code{font}] font for text.  Can be a vector.  \code{NA} values (the
default) mean use \code{par("font")}.
\item[\code{...}] Further graphical parameters (see \code{\LinkA{par}{par}}),
including \code{family}, \code{las} and \code{xpd}. (The latter
defaults to the figure region unless \code{outer = TRUE}, otherwise
the device region.  It can only be increased.)
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The user coordinates in the outer margins always range from zero to
one, and are not affected by the user coordinates in the figure
region(s) --- \R{} differs here from other implementations of S.

All of the named arguments can be vectors, and recycling will take
place to plot as many strings as the longest of the vector arguments.

Note that a vector \code{adj} has a different meaning from
\code{\LinkA{text}{text}}.  \code{adj = 0.5} will centre the string, but for
\code{outer=TRUE} on the device region rather than the plot region.

Parameter \code{las} will determine the orientation of the string(s).
For strings plotted perpendicular to the axis the default justification
is to place the end of the string nearest the axis on the specified
line.  (Note that this differs from S, which uses \code{srt} if
\code{at} is supplied and \code{las} if it is not.  Parameter
\code{srt} is ignored in \R{}.)

Note that if the text is to be plotted perpendicular to the axis,
\code{adj} determines the justification of the string \emph{and} the
position along the axis unless \code{at} is specified.

Graphics parameter \code{"ylbias"} (see \code{\LinkA{par}{par}}) determines
how the text baseline is placed relative to the nominal line.
\end{Details}
%
\begin{Section}{Side Effects}
The given text is written onto the current plot.
\end{Section}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{title}{title}}, \code{\LinkA{text}{text}}, \code{\LinkA{plot}{plot}},
\code{\LinkA{par}{par}};
\code{\LinkA{plotmath}{plotmath}} for details on mathematical annotation.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(1:10, (-4:5)^2, main="Parabola Points", xlab="xlab")
mtext("10 of them")
for(s in 1:4)
    mtext(paste("mtext(..., line= -1, {side, col, font} = ",s,
          ", cex = ", (1+s)/2, ")"), line = -1,
          side=s, col=s, font=s, cex= (1+s)/2)
mtext("mtext(..., line= -2)", line = -2)
mtext("mtext(..., line= -2, adj = 0)", line = -2, adj =0)
##--- log axis :
plot(1:10, exp(1:10), log='y', main="log='y'", xlab="xlab")
for(s in 1:4) mtext(paste("mtext(...,side=",s,")"), side=s)
\end{ExampleCode}
\end{Examples}
\HeaderA{pairs}{Scatterplot Matrices}{pairs}
\methaliasA{pairs.default}{pairs}{pairs.default}
\methaliasA{pairs.formula}{pairs}{pairs.formula}
\keyword{hplot}{pairs}
%
\begin{Description}\relax
A matrix of scatterplots is produced.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
pairs(x, ...)

## S3 method for class 'formula'
pairs(formula, data = NULL, ..., subset,
      na.action = stats::na.pass)

## Default S3 method:
pairs(x, labels, panel = points, ...,
      lower.panel = panel, upper.panel = panel,
      diag.panel = NULL, text.panel = textPanel,
      label.pos = 0.5 + has.diag/3,
      cex.labels = NULL, font.labels = 1,
      row1attop = TRUE, gap = 1)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] the coordinates of points given as numeric columns of a 
matrix or dataframe.  Logical and factor columns are converted to
numeric in the same way that \code{\LinkA{data.matrix}{data.matrix}} does.

\item[\code{formula}] a formula, such as \code{\textasciitilde{} x + y + z}.  Each term will
give a separate variable in the pairs plot, so terms should be
numeric vectors.  (A response will be interpreted as another
variable, but not treated specially, so it is confusing to use one.)
\item[\code{data}] a data.frame (or list) from which the variables in
\code{formula} should be taken.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used for plotting.
\item[\code{na.action}] a function which indicates what should happen
when the data contain \code{NA}s.  The default is to pass missing
values on to the panel functions, but \code{na.action = na.omit}
will cause cases with missing values in any of the variables to be
omitted entirely.
\item[\code{labels}] the names of the variables.
\item[\code{panel}] \code{function(x,y,...)} which is used to plot
the contents of each panel of the display.
\item[\code{...}] 
arguments to be passed to or from methods.

Also, \LinkA{graphical parameters}{graphical parameters} can be given as can arguments to
\code{plot} such as \code{main}.  \code{par("oma")} will be set
appropriately unless specified.

\item[\code{lower.panel, upper.panel}] separate panel functions to be used
below and above the diagonal respectively.
\item[\code{diag.panel}] optional \code{function(x, ...)} to be
applied on the diagonals.
\item[\code{text.panel}] optional \code{function(x, y, labels, cex,
      font, ...)} to be applied on the diagonals.
\item[\code{label.pos}] \code{y} position of labels in the text panel.
\item[\code{cex.labels, font.labels}] graphics parameters for the text panel.
\item[\code{row1attop}] logical. Should the layout be matrix-like with row 1
at the top, or graph-like with row 1 at the bottom?
\item[\code{gap}] Distance between subplots, in margin lines.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The \eqn{ij}{}th scatterplot contains \code{x[,i]} plotted against
\code{x[,j]}.  The scatterplot can be customised by setting panel
functions to appear as something completely different. The
off-diagonal panel functions are passed the appropriate columns of
\code{x} as \code{x} and \code{y}: the diagonal panel function (if
any) is passed a single column, and the \code{text.panel} function is
passed a single \code{(x, y)} location and the column name.

The \LinkA{graphical parameters}{graphical parameters} \code{pch} and \code{col} can be used
to specify a vector of plotting symbols and colors to be used in the
plots.

The \LinkA{graphical parameter}{graphical parameter} \code{oma} will be set by
\code{pairs.default} unless supplied as an argument.

A panel function should not attempt to start a new plot, but just plot
within a given coordinate system: thus \code{plot} and \code{boxplot}
are not panel functions.

By default, missing values are passed to the panel functions and will
often be ignored within a panel.  However, for the formula method and
\code{na.action = na.omit}, all cases which contain a missing values for
any of the variables are omitted completely (including when the scales
are selected).
\end{Details}
%
\begin{Author}\relax
Enhancements for \R{} 1.0.0 contributed by Dr. Jens
Oehlschlaegel-Akiyoshi and R-core members.
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{Examples}
\begin{ExampleCode}
pairs(iris[1:4], main = "Anderson's Iris Data -- 3 species",
      pch = 21, bg = c("red", "green3", "blue")[unclass(iris$Species)])

## formula method
pairs(~ Fertility + Education + Catholic, data = swiss,
      subset = Education < 20, main = "Swiss data, Education < 20")

pairs(USJudgeRatings)

## put histograms on the diagonal
panel.hist <- function(x, ...)
{
    usr <- par("usr"); on.exit(par(usr))
    par(usr = c(usr[1:2], 0, 1.5) )
    h <- hist(x, plot = FALSE)
    breaks <- h$breaks; nB <- length(breaks)
    y <- h$counts; y <- y/max(y)
    rect(breaks[-nB], 0, breaks[-1], y, col="cyan", ...)
}
pairs(USJudgeRatings[1:5], panel=panel.smooth,
      cex = 1.5, pch = 24, bg="light blue",
      diag.panel=panel.hist, cex.labels = 2, font.labels=2)

## put (absolute) correlations on the upper panels,
## with size proportional to the correlations.
panel.cor <- function(x, y, digits=2, prefix="", cex.cor, ...)
{
    usr <- par("usr"); on.exit(par(usr))
    par(usr = c(0, 1, 0, 1))
    r <- abs(cor(x, y))
    txt <- format(c(r, 0.123456789), digits=digits)[1]
    txt <- paste(prefix, txt, sep="")
    if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
    text(0.5, 0.5, txt, cex = cex.cor * r)
}
pairs(USJudgeRatings, lower.panel=panel.smooth, upper.panel=panel.cor)
\end{ExampleCode}
\end{Examples}
\HeaderA{panel.smooth}{Simple Panel Plot}{panel.smooth}
\keyword{hplot}{panel.smooth}
\keyword{dplot}{panel.smooth}
%
\begin{Description}\relax
An example of a simple useful \code{panel} function to be used as
argument in e.g., \code{\LinkA{coplot}{coplot}} or \code{\LinkA{pairs}{pairs}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
panel.smooth(x, y, col = par("col"), bg = NA, pch = par("pch"),
             cex = 1, col.smooth = "red", span = 2/3, iter = 3,
             ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] numeric vectors of the same length
\item[\code{col, bg, pch, cex}] numeric or character codes for the color(s),
point type and size of \code{\LinkA{points}{points}}; see also
\code{\LinkA{par}{par}}.
\item[\code{col.smooth}] color to be used by \code{lines} for drawing the
smooths.
\item[\code{span}] smoothing parameter \code{f} for \code{\LinkA{lowess}{lowess}}, see
there.
\item[\code{iter}] number of robustness iterations for \code{\LinkA{lowess}{lowess}}.
\item[\code{...}] further arguments to \code{\LinkA{lines}{lines}}.
\end{ldescription}
\end{Arguments}
%
\begin{SeeAlso}\relax
\code{\LinkA{coplot}{coplot}} and \code{\LinkA{pairs}{pairs}} where \code{panel.smooth}
is typically used;
\code{\LinkA{lowess}{lowess}} which does the smoothing.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
pairs(swiss, panel = panel.smooth, pch = ".")# emphasize the smooths
pairs(swiss, panel = panel.smooth, lwd = 2, cex= 1.5, col="blue")# hmm...
\end{ExampleCode}
\end{Examples}
\graphicspath{{C:/architect-build/temp/r/i386/R-2.15.2/library/graphics/help/figures/}}
\HeaderA{par}{Set or Query Graphical Parameters}{par}
\aliasA{.Pars}{par}{.Pars}
\aliasA{graphical parameter}{par}{graphical parameter}
\aliasA{graphical parameters}{par}{graphical parameters}
\keyword{iplot}{par}
\keyword{dplot}{par}
\keyword{environment}{par}
%
\begin{Description}\relax
\code{par} can be used to set or query graphical parameters.
Parameters can be set by specifying them as arguments to \code{par} in
\code{tag = value} form, or by passing them as a list of tagged
values.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
par(..., no.readonly = FALSE)

<highlevel plot> (..., <tag> = <value>)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] arguments in \code{tag = value} form, or a list of tagged
values.  The tags must come from the names of graphical parameters
described in the `Graphical Parameters' section.
\item[\code{no.readonly}] logical; if \code{TRUE} and there are no other
arguments, only parameters are returned which can be set by a
subsequent \code{par()} call \emph{on the same device}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Each device has its own set of graphical parameters.  If the current
device is the null device, \code{par} will open a new device before
querying/setting parameters.  (What device is controlled by
\code{\LinkA{options}{options}("device")}.)

Parameters are queried by giving one or more character vectors of
parameter names to \code{par}.

\code{par()} (no arguments) or \code{par(no.readonly=TRUE)} is used to
get \emph{all} the graphical parameters (as a named list).  Their
names are currently taken from the unexported variable
\code{graphics:::.Pars}.

\emph{\bold{R.O.}} indicates \emph{\bold{read-only arguments}}: These
may only be used in queries and cannot be set.  (\code{"cin"},
\code{"cra"}, \code{"csi"}, \code{"cxy"} and \code{"din"} are always
read-only.)

Several parameters can only be set by a call to \code{par()}:
\begin{itemize}

\item \code{"ask"},
\item \code{"fig"}, \code{"fin"},
\item \code{"lheight"},
\item \code{"mai"}, \code{"mar"}, \code{"mex"},
\code{"mfcol"}, \code{"mfrow"}, \code{"mfg"},
\item \code{"new"},
\item \code{"oma"}, \code{"omd"}, \code{"omi"},
\item \code{"pin"}, \code{"plt"}, \code{"ps"}, \code{"pty"},
\item \code{"usr"},
\item \code{"xlog"}, \code{"ylog"},
\item \code{"ylbias"}

\end{itemize}

The remaining parameters can also be set as arguments (often via
\code{...}) to high-level plot functions such as
\code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{plot.window}{plot.window}},
\code{\LinkA{points}{points}}, \code{\LinkA{lines}{lines}}, \code{\LinkA{abline}{abline}},
\code{\LinkA{axis}{axis}}, \code{\LinkA{title}{title}}, \code{\LinkA{text}{text}},
\code{\LinkA{mtext}{mtext}}, \code{\LinkA{segments}{segments}}, \code{\LinkA{symbols}{symbols}},
\code{\LinkA{arrows}{arrows}}, \code{\LinkA{polygon}{polygon}}, \code{\LinkA{rect}{rect}},
\code{\LinkA{box}{box}}, \code{\LinkA{contour}{contour}}, \code{\LinkA{filled.contour}{filled.contour}}
and \code{\LinkA{image}{image}}.  Such settings will be active during the
execution of the function, only.  However, see the comments on
\code{bg}, \code{cex}, \code{col}, \code{lty}, \code{lwd} and
\code{pch} which may be taken as \emph{arguments} to certain plot
functions rather than as graphical parameters.

The meaning of `character size' is not well-defined: this is
set up for the device taking \code{pointsize} into account but often
not the actual font family in use.  Internally the corresponding pars
(\code{cra}, \code{cin}, \code{cxy} and \code{csi}) are used only to
set the inter-line spacing used to convert \code{mar} and \code{oma}
to physical margins.  (The same inter-line spacing multiplied by
\code{lheight} is used for multi-line strings in \code{text} and
\code{strheight}.)

Note that graphical parameters are suggestions: plotting functions and
devices need not make use of them (and this is particularly true of
non-default methods for e.g. \code{plot}).
\end{Details}
%
\begin{Value}
When parameters are set, their previous values are returned in an
invisible named list.  Such a list can be passed as an argument to
\code{par} to restore the parameter values.  Use \code{par(no.readonly
  = TRUE)} for the full list of parameters that can be restored.
However, restoring all of these is not wise: see the `Note'
section.

When just one parameter is queried, the value of that parameter
is returned as (atomic) vector.  When two or more parameters are
queried, their values are returned in a list, with the list names
giving the parameters.

Note the inconsistency: setting one parameter returns a list, but
querying one parameter returns a vector.
\end{Value}
%
\begin{Section}{Graphical Parameters}
\begin{description}

\item[\code{adj}] The value of \code{adj} determines the way in
which text strings are justified in \code{\LinkA{text}{text}},
\code{\LinkA{mtext}{mtext}} and \code{\LinkA{title}{title}}.  A value of \code{0} produces
left-justified text, \code{0.5} (the default) centered text and \code{1}
right-justified text.  (Any value in \eqn{[0, 1]}{} is allowed, and
on most devices values outside that interval will also work.)

Note that the \code{adj} \emph{argument} of \code{\LinkA{text}{text}} also
allows \code{adj = c(x, y)} for different adjustment in x- and y-
directions.  Note that whereas for \code{text} it refers to
positioning of text about a point, for \code{mtext} and
\code{title} it controls placement within the plot or device region.
\item[\code{ann}] If set to \code{FALSE}, high-level plotting
functions calling \code{\LinkA{plot.default}{plot.default}} do not annotate the
plots they produce with axis titles and overall titles.  The
default is to do annotation.
\item[\code{ask}] logical.  If \code{TRUE} (and the \R{} session is
interactive) the user is asked for input, before a new figure is
drawn.  As this applies to the device, it also affects output by
packages \pkg{grid} and \Rhref{http://CRAN.R-project.org/package=lattice}{\pkg{lattice}}.  It can be set even on
non-screen devices but may have no effect there.

This not really a graphics parameter, and its use is deprecated in
favour of \code{\LinkA{devAskNewPage}{devAskNewPage}}.

\item[\code{bg}] The color to be used for the background of the
device region.  When called from \code{par()} it also sets
\code{new=FALSE}. See section `Color Specification' for
suitable values.  For many devices the initial value is set from
the \code{bg} argument of the device, and for the rest it is
normally \code{"white"}.

Note that some graphics functions such as
\code{\LinkA{plot.default}{plot.default}} and \code{\LinkA{points}{points}} have an
\emph{argument} of this name with a different meaning.
\item[\code{bty}] A character string which determined the type of
\code{\LinkA{box}{box}} which is drawn about plots.  If \code{bty} is
one of \code{"o"} (the default), \code{"l"}, \code{"7"},
\code{"c"}, \code{"u"}, or \code{"]"} the resulting box resembles
the corresponding upper case letter.  A value of \code{"n"}
suppresses the box.
\item[\code{cex}] A numerical value giving the amount by which
plotting text and symbols should be magnified relative to the
default.  This starts as \code{1} when a device is opened, and is
reset when the layout is changed, e.g. by setting \code{mfrow}.

Note that some graphics functions such as
\code{\LinkA{plot.default}{plot.default}} have an \emph{argument} of this name
which \emph{multiplies} this graphical parameter, and some
functions such as \code{\LinkA{points}{points}} and \code{\LinkA{text}{text}}
accept a vector of values which are recycled.

\item[\code{cex.axis}] The magnification to be used for axis
annotation relative to the current setting of \code{cex}.
\item[\code{cex.lab}] The magnification to be used for x and y
labels relative to the current setting of \code{cex}.
\item[\code{cex.main}] The magnification to be used for main titles
relative to the current setting of \code{cex}.
\item[\code{cex.sub}] The magnification to be used for sub-titles
relative to the current setting of \code{cex}.
\item[\code{cin}] \emph{\bold{R.O.}}; character size
\code{(width, height)} in inches.  These are the same measurements
as \code{cra}, expressed in different units.
\item[\code{col}] A specification for the default plotting color.  See
section `Color Specification'.

Some functions such as \code{\LinkA{lines}{lines}} and \code{\LinkA{text}{text}}
accept a vector of values which are recycled and may be
interpreted slightly differently.

\item[\code{col.axis}] The color to be used for axis
annotation.  Defaults to \code{"black"}.
\item[\code{col.lab}] The color to be used for x and y labels.
Defaults to \code{"black"}.
\item[\code{col.main}] The color to be used for plot main titles.
Defaults to \code{"black"}.
\item[\code{col.sub}] The color to be used for plot sub-titles.
Defaults to \code{"black"}.
\item[\code{cra}] \emph{\bold{R.O.}}; size of default character
\code{(width, height)} in `rasters' (pixels).  Some devices
have no concept of pixels and so assume an arbitrary pixel size,
usually 1/72 inch.  These are the same measurements
as \code{cin}, expressed in different units.
\item[\code{crt}] A numerical value specifying (in degrees) how
single characters should be rotated.  It is unwise to expect
values other than multiples of 90 to work.  Compare with
\code{srt} which does string rotation.
\item[\code{csi}] \emph{\bold{R.O.}}; height of (default-sized)
characters in inches.  The same as \code{par("cin")[2]}.
\item[\code{cxy}] \emph{\bold{R.O.}}; size of default character
\code{(width, height)} in user coordinate units.
\code{par("cxy")} is \code{par("cin")/par("pin")} scaled to user
coordinates.
Note that \code{c(\LinkA{strwidth}{strwidth}(ch), \LinkA{strheight}{strheight}(ch))} for
a given string \code{ch} is usually much more precise.
\item[\code{din}] \emph{\bold{R.O.}}; the device dimensions,
\code{(width,height)}, in inches.  See also
\code{\LinkA{dev.size}{dev.size}}, which is updated immediately when an
on-screen device windows is re-sized.
\item[\code{err}] (\emph{Unimplemented}; \R{} is silent when points
outside the plot region are \emph{not} plotted.)
The degree of error reporting desired.
\item[\code{family}] The name of a font family for drawing text.
The maximum allowed length is 200 bytes.
This name gets mapped by each graphics device to a device-specific
font description.  The default value is \code{""} which means that
the default device fonts will be used (and what those are should
be listed on the help page for the device).  Standard values are
\code{"serif"}, \code{"sans"} and \code{"mono"}, and the
\LinkA{Hershey}{Hershey} font families are also available.  (Different
devices may define others, and some devices will ignore this
setting completely.)  This can be specified inline for
\code{\LinkA{text}{text}}.
\item[\code{fg}] The color to be used for the foreground of plots.
This is the default color used for things like axes and boxes
around plots.  When called from \code{par()} this also sets
parameter \code{col} to the same value.  See section `Color
Specification'.  A few devices have an argument to set the
initial value, which is otherwise \code{"black"}.
\item[\code{fig}] A numerical vector of the form \code{c(x1, x2, y1,
        y2)} which gives the (NDC) coordinates of the figure region in
the display region of the device. If you set this, unlike S, you
start a new plot, so to add to an existing plot use
\code{new=TRUE} as well.
\item[\code{fin}] The figure region dimensions,
\code{(width,height)}, in inches. If you set this, unlike S, you
start a new plot.
\item[\code{font}] An integer which specifies which font to use for
text.  If possible, device drivers arrange so that 1 corresponds
to plain text (the default), 2 to bold face, 3 to italic and 4 to
bold italic.  Also, font 5 is expected to be the symbol font, in
Adobe symbol encoding.  On some devices font families can be
selected by \code{family} to choose different sets of 5 fonts.
\item[\code{font.axis}] The font to be used for axis annotation.
\item[\code{font.lab}] The font to be used for x and y labels.
\item[\code{font.main}] The font to be used for plot main titles.
\item[\code{font.sub}] The font to be used for plot sub-titles.
\item[\code{lab}] A numerical vector of the form \code{c(x, y, len)}
which modifies the default way that axes are annotated.  The values of
\code{x} and \code{y} give the (approximate) number of tickmarks
on the x and y axes and \code{len} specifies the label length.  The
default is \code{c(5, 5, 7)}.  Note that this only affects the way
the parameters \code{xaxp} and \code{yaxp} are set when the user
coordinate system is set up, and is not consulted when axes are drawn.
\code{len} \emph{is unimplemented} in \R{}.
\item[\code{las}] numeric in \{0,1,2,3\}; the style of axis labels.
\begin{description}

\item[0:] always parallel to the axis [\emph{default}],
\item[1:] always horizontal,
\item[2:] always perpendicular to the axis,
\item[3:] always vertical.

\end{description}

Also supported by \code{\LinkA{mtext}{mtext}}.  Note that
string/character rotation \emph{via} argument \code{srt} to \code{par}
does \emph{not} affect the axis labels.

\item[\code{lend}] The line end style.  This can be specified as an
integer or string:
\begin{description}

\item[\code{0}] and \code{"round"} mean rounded line caps
[\emph{default}];
\item[\code{1}] and \code{"butt"} mean butt line caps;
\item[\code{2}] and \code{"square"} mean square line caps.

\end{description}


\item[\code{lheight}] The line height multiplier.
The height of a line of text (used to vertically space
multi-line text) is found by multiplying the character height
both by the current character expansion and by the
line height multiplier.  Default value is 1.  Used in
\code{\LinkA{text}{text}} and \code{\LinkA{strheight}{strheight}}.
\item[\code{ljoin}] The line join style.
This can be specified as an integer or string:
\begin{description}

\item[\code{0}] and \code{"round"} mean rounded line joins
[\emph{default}];
\item[\code{1}] and \code{"mitre"} mean mitred line joins;
\item[\code{2}] and \code{"bevel"} mean bevelled line joins.

\end{description}


\item[\code{lmitre}] The line mitre limit.  This controls when
mitred line joins are automatically converted into bevelled line
joins.  The value must be larger than 1 and the default is 10.
Not all devices will honour this setting.
\item[\code{lty}] The line type.
Line types can either be specified as an integer (0=blank, 1=solid
(default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash)
or as one of the character strings \code{"blank"}, \code{"solid"},
\code{"dashed"}, \code{"dotted"}, \code{"dotdash"},
\code{"longdash"}, or \code{"twodash"}, where \code{"blank"} uses
`invisible lines' (i.e., does not draw them).

Alternatively, a string of up to 8 characters (from \code{c(1:9,
        "A":"F")}) may be given, giving the length of line segments
which are alternatively drawn and skipped.  See section
`Line Type Specification'.

Functions such as \code{\LinkA{lines}{lines}} and \code{\LinkA{segments}{segments}}
accept a vector of values which are recycled.

\item[\code{lwd}] The line width, a \emph{positive} number,
defaulting to \code{1}.  The interpretation is device-specific,
and some devices do not implement line widths less than one.
(See the help on the device for details of the interpretation.)

Functions such as \code{\LinkA{lines}{lines}} and \code{\LinkA{segments}{segments}}
accept a vector of values which are recycled.

\item[\code{mai}] A numerical vector of the form \code{c(bottom,
        left, top, right)} which gives the margin size specified in
inches.\\{}

\Figure{mai.pdf}{width=7cm}

\item[\code{mar}] A numerical vector of the form \code{c(bottom,
        left, top, right)} which gives the number of lines of margin to be
specified on the four sides of the plot.
The default is \code{c(5, 4, 4, 2) + 0.1}.
\item[\code{mex}] 
\code{mex} is a character size expansion factor which is used to
describe coordinates in the margins of plots. Note that this does
not change the font size, rather specifies the size of font (as a
multiple of \code{csi}) used to convert between \code{mar} and
\code{mai}, and between \code{oma} and \code{omi}.

This starts as \code{1} when the device is opened, and is reset
when the layout is changed (alongside resetting \code{cex}).

\item[\code{mfcol, mfrow}] A vector of the form \code{c(nr, nc)}.
Subsequent figures will be drawn in an \code{nr}-by-\code{nc}
array on the device by \emph{columns} (\code{mfcol}), or
\emph{rows} (\code{mfrow}), respectively.

In a layout with exactly two rows and columns the base value of
\code{"cex"} is reduced by a factor of 0.83: if there are three or
more of either rows or columns, the reduction factor is 0.66.

Setting a layout resets the base value of \code{cex} and that of
\code{mex} to \code{1}.

If either of these is queried it will give the current layout, so
querying cannot tell you the order in which the array will be filled.

Consider the alternatives, \code{\LinkA{layout}{layout}} and
\code{\LinkA{split.screen}{split.screen}}.

\item[\code{mfg}] A numerical vector of the form \code{c(i, j)}
where \code{i} and \code{j} indicate which figure in an array of
figures is to be drawn next (if setting) or is being drawn (if
enquiring).  The array must already have been set by \code{mfcol}
or \code{mfrow}.

For compatibility with S, the form \code{c(i, j, nr, nc)} is also
accepted, when \code{nr} and \code{nc} should be the current
number of rows and number of columns.  Mismatches will be ignored,
with a warning.
\item[\code{mgp}] The margin line (in \code{mex} units) for the axis
title, axis labels and axis line.  Note that \code{mgp[1]} affects
\code{\LinkA{title}{title}} whereas \code{mgp[2:3]} affect \code{\LinkA{axis}{axis}}.
The default is \code{c(3, 1, 0)}.
\item[\code{mkh}] The height in inches of symbols to be drawn when
the value of \code{pch} is an integer. \emph{Completely ignored in \R{}}.

\item[\code{new}] logical, defaulting to \code{FALSE}.  If set to
\code{TRUE}, the next high-level plotting command (actually
\code{\LinkA{plot.new}{plot.new}}) should \emph{not clean} the frame before
drawing \emph{as if it were on a \bold{\emph{new}} device}.  It is
an error (ignored with a warning) to try to use \code{new = TRUE}
on a device that does not currently contain a high-level plot.
\item[\code{oma}] A vector of the form \code{c(bottom, left, top,
        right)} giving the size of the outer margins in lines of text.\\{}

\Figure{oma.pdf}{width=6cm}

\item[\code{omd}] A vector of the form \code{c(x1, x2, y1, y2)}
giving the region \emph{inside} outer margins in NDC (=
normalized device coordinates), i.e., as a fraction (in \eqn{[0, 1]}{})
of the device region.
\item[\code{omi}] A vector of the form \code{c(bottom, left, top,
        right)} giving the size of the outer margins in inches.
\item[\code{pch}] Either an integer specifying a symbol or a single
character to be used as the default in plotting points.  See
\code{\LinkA{points}{points}} for possible values and their interpretation.
Note that only integers and single-character strings can
be set as a graphics parameter (and not \code{NA} nor \code{NULL}).

Some functions such as \code{\LinkA{points}{points}} accept a vector of values
which are recycled.

\item[\code{pin}] The current plot dimensions, \code{(width,height)},
in inches.
\item[\code{plt}] A vector of the form \code{c(x1, x2, y1, y2)}
giving the coordinates of the plot region as fractions of the
current figure region.
\item[\code{ps}] integer; the point size of text (but not symbols).  Unlike
the \code{pointsize} argument of most devices, this does not change
the relationship between \code{mar} and \code{mai} (nor \code{oma}
and \code{omi}).

What is meant by `point size' is device-specific, but most
devices mean a multiple of 1bp, that is 1/72 of an inch.

\item[\code{pty}] A character specifying the type of plot region to
be used; \code{"s"} generates a square plotting region and
\code{"m"} generates the maximal plotting region.
\item[\code{smo}] (\emph{Unimplemented}) a value which indicates how
smooth circles and circular arcs should be.
\item[\code{srt}] The string rotation in degrees.  See the comment
about \code{crt}.  Only supported by \code{\LinkA{text}{text}}.



\item[\code{tck}] The length of tick marks as a fraction of the
smaller of the width or height of the plotting region.
If \code{tck >= 0.5} it is interpreted as a fraction of the
relevant side, so if \code{tck = 1} grid lines are drawn.  The
default setting (\code{tck = NA}) is to use \code{tcl = -0.5}.
\item[\code{tcl}] The length of tick marks as a fraction of the
height of a line of text.  The default value is \code{-0.5};
setting \code{tcl = NA} sets \code{tck = -0.01} which is S' default.
\item[\code{usr}] A vector of the form \code{c(x1, x2, y1, y2)}
giving the extremes of the user coordinates of the plotting
region.  When a logarithmic scale is in use (i.e.,
\code{par("xlog")} is true, see below), then the x-limits will be
\code{10 \textasciicircum{} par("usr")[1:2]}.  Similarly for the y-axis.

\item[\code{xaxp}] A vector of the form \code{c(x1, x2, n)} giving
the coordinates of the extreme tick marks and the number of
intervals between tick-marks when \code{par("xlog")} is false.
Otherwise, when \emph{log} coordinates are active, the three
values have a different meaning: For a small range, \code{n} is
\emph{negative}, and the ticks are as in the linear case,
otherwise, \code{n} is in \code{1:3}, specifying a case number,
and \code{x1} and \code{x2} are the lowest and highest power of 10
inside the user coordinates, \code{10 \textasciicircum{} par("usr")[1:2]}. (The
\code{"usr"} coordinates are log10-transformed here!)

\begin{description}

\item[n=1] will produce tick marks at \eqn{10^j}{} for integer \eqn{j}{},
\item[n=2] gives marks  \eqn{k 10^j}{} with
\eqn{k \in \{1, 5\}}{},
\item[n=3] gives marks  \eqn{k 10^j}{} with
\eqn{k \in \{1, 2, 5\}}{}.

\end{description}

See \code{\LinkA{axTicks}{axTicks}()} for a pure \R{} implementation of this.

This parameter is reset when a user coordinate system is set up,
for example by starting a new page or by calling
\code{\LinkA{plot.window}{plot.window}} or setting \code{par("usr")}: \code{n}
is taken from \code{par("lab")}.  It affects the default behaviour
of subsequent calls to \code{\LinkA{axis}{axis}} for sides 1 or 3.

It is only relevant to default numeric axis systems, and not for
example to dates.

\item[\code{xaxs}] The style of axis interval calculation to be used
for the x-axis.  Possible values are \code{"r"}, \code{"i"},
\code{"e"}, \code{"s"}, \code{"d"}.  The styles are generally
controlled by the range of data or \code{xlim}, if given.\\{}
Style \code{"r"} (regular) first extends the data range by 4
percent at each end and then finds an axis with pretty labels
that fits within the extended range.\\{}
Style \code{"i"} (internal) just finds an axis with pretty labels
that fits within the original data range.\\{}
Style \code{"s"} (standard) finds an axis with pretty labels
within which the original data range fits.\\{}
Style \code{"e"} (extended) is like style \code{"s"}, except that
it is also ensures that there is room for plotting symbols within
the bounding box.\\{}
Style \code{"d"} (direct) specifies that the current axis should
be used on subsequent plots.\\{}
(\emph{Only \code{"r"} and \code{"i"} styles have been
implemented in \R{}.})
\item[\code{xaxt}] A character which specifies the x axis type.
Specifying \code{"n"} suppresses plotting of the axis.  The
standard value is \code{"s"}: for compatibility with S values
\code{"l"} and \code{"t"} are accepted but are equivalent to
\code{"s"}: any value other than \code{"n"} implies plotting.
\item[\code{xlog}] A logical value (see \code{log} in
\code{\LinkA{plot.default}{plot.default}}).  If \code{TRUE}, a logarithmic scale
is in use (e.g., after \code{plot(*, log = "x")}).
For a new device, it defaults to \code{FALSE}, i.e., linear scale.
\item[\code{xpd}] A logical value or \code{NA}.
If \code{FALSE}, all plotting is clipped to the plot region, if
\code{TRUE}, all plotting is clipped to the figure region, and if
\code{NA}, all plotting is clipped to the device region.  See also
\code{\LinkA{clip}{clip}}.
\item[\code{yaxp}] A vector of the form \code{c(y1, y2, n)} giving
the coordinates of the extreme tick marks and the number of
intervals between tick-marks unless for log coordinates, see
\code{xaxp} above.
\item[\code{yaxs}] The style of axis interval calculation to be used
for the y-axis.  See \code{xaxs} above.
\item[\code{yaxt}] A character which specifies the y axis type.
Specifying \code{"n"} suppresses plotting.
\item[\code{ylbias}] A positive real value used in the positioning
of text in the margins by \code{\LinkA{axis}{axis}} and
\code{\LinkA{mtext}{mtext}}.  The default is in principle device-specific,
but currently \code{0.2} for all of \R{}'s own devices.  Set this to
\code{0.2} for compatibility with \R{} < 2.14.0 on \code{x11} and
\code{windows()} devices.
\item[\code{ylog}] A logical value; see \code{xlog} above.

\end{description}

\end{Section}
%
\begin{Section}{Color Specification}
Colors can be specified in several different ways. The simplest way is
with a character string giving the color name (e.g., \code{"red"}).  A
list of the possible colors can be obtained with the function
\code{\LinkA{colors}{colors}}.  Alternatively, colors can be specified directly in
terms of their RGB components with a string of the form \code{"\#RRGGBB"}
where each of the pairs \code{RR}, \code{GG}, \code{BB} consist of two
hexadecimal digits giving a value in the range \code{00} to \code{FF}.
Colors can also be specified by giving an index into a small table of
colors, the \code{\LinkA{palette}{palette}}.  This provides compatibility with
S.  Index \code{0} corresponds to the background color.  (Because
apparently some people have been assuming it, it is also possible to
specify integers as character strings, e.g. \code{"3"}.)

Additionally, \code{"transparent"} is \emph{transparent}, useful for
filled areas (such as the background!), and just invisible for things
like lines or text.  In most circumstances (integer) \code{NA}
is equivalent to \code{"transparent"} (but not for
\code{\LinkA{text}{text}} and \code{\LinkA{mtext}{mtext}}).

Semi-transparent colors are available for use on devices that support
them.

The functions \code{\LinkA{rgb}{rgb}}, \code{\LinkA{hsv}{hsv}}, \code{\LinkA{hcl}{hcl}},
\code{\LinkA{gray}{gray}} and \code{\LinkA{rainbow}{rainbow}}
provide additional ways of generating colors.
\end{Section}
%
\begin{Section}{Line Type Specification}
Line types can either be specified by giving an index into a small
built-in table of line types (1 = solid, 2 = dashed, etc, see
\code{lty} above) or directly as the lengths of on/off stretches of
line.  This is done with a string of an even number (up to eight)
of characters, namely \emph{non-zero}
(hexadecimal) digits which give the lengths in consecutive positions
in the string.  For example, the string \code{"33"} specifies three
units on followed by three off and \code{"3313"} specifies three units
on followed by three off followed by one on and finally three off.
The `units' here are (on most devices) proportional to
\code{lwd}, and with \code{lwd = 1} are in pixels or points or 1/96
inch.

The five standard dash-dot line types (\code{lty = 2:6}) correspond to
\code{c("44", "13", "1343", "73", "2262")}.

Note that \code{NA} is not a valid value for \code{lty}.
\end{Section}
%
\begin{Note}\relax
The effect of restoring all the (settable) graphics parameters as
in the examples is hard to predict if the device has been resized.
Several of them are attempting to set the same things in different
ways, and those last in the alphabet will win.  In particular, the
settings of \code{mai}, \code{mar}, \code{pin}, \code{plt} and
\code{pty} interact, as do the outer margin settings, the figure
layout and figure region size.
\end{Note}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.default}{plot.default}} for some high-level plotting parameters;
\code{\LinkA{colors}{colors}}; \code{\LinkA{clip}{clip}};
\code{\LinkA{options}{options}} for other setup parameters;
graphic devices \code{\LinkA{x11}{x11}}, \code{\LinkA{postscript}{postscript}} and
setting up device regions by \code{\LinkA{layout}{layout}} and
\code{\LinkA{split.screen}{split.screen}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
op <- par(mfrow = c(2, 2), # 2 x 2 pictures on one plot
          pty = "s")       # square plotting region,
                           # independent of device size

## At end of plotting, reset to previous settings:
par(op)

## Alternatively,
op <- par(no.readonly = TRUE) # the whole list of settable par's.
## do lots of plotting and par(.) calls, then reset:
par(op)
## Note this is not in general good practice

par("ylog") # FALSE
plot(1 : 12, log = "y")
par("ylog") # TRUE

plot(1:2, xaxs = "i") # 'inner axis' w/o extra space
par(c("usr", "xaxp"))

( nr.prof <-
  c(prof.pilots=16,lawyers=11,farmers=10,salesmen=9,physicians=9,
    mechanics=6,policemen=6,managers=6,engineers=5,teachers=4,
    housewives=3,students=3,armed.forces=1))
par(las = 3)
barplot(rbind(nr.prof)) # R 0.63.2: shows alignment problem
par(las = 0)# reset to default

require(grDevices) # for gray
## 'fg' use:
plot(1:12, type = "b", main="'fg' : axes, ticks and box in gray",
     fg = gray(0.7), bty="7" , sub=R.version.string)

ex <- function() {
   old.par <- par(no.readonly = TRUE) # all par settings which
                                      # could be changed.
   on.exit(par(old.par))
   ## ...
   ## ... do lots of par() settings and plots
   ## ...
   invisible() #-- now,  par(old.par)  will be executed
}
ex()
\end{ExampleCode}
\end{Examples}
\HeaderA{persp}{Perspective Plots}{persp}
\methaliasA{persp.default}{persp}{persp.default}
\keyword{hplot}{persp}
\keyword{aplot}{persp}
%
\begin{Description}\relax
This function draws perspective plots of a surface over the
x--y plane.  \code{persp} is a generic function.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
persp(x, ...)

## Default S3 method:
persp(x = seq(0, 1, length.out = nrow(z)),
      y = seq(0, 1, length.out = ncol(z)),
      z, xlim = range(x), ylim = range(y),
      zlim = range(z, na.rm = TRUE),
      xlab = NULL, ylab = NULL, zlab = NULL,
      main = NULL, sub = NULL,
      theta = 0, phi = 15, r = sqrt(3), d = 1,
      scale = TRUE, expand = 1,
      col = "white", border = NULL, ltheta = -135, lphi = 0,
      shade = NA, box = TRUE, axes = TRUE, nticks = 5,
      ticktype = "simple", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] locations of grid lines at which the values in \code{z} are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If \code{x} is a \code{list},
its components \code{x\$x} and \code{x\$y} are used for \code{x}
and \code{y}, respectively.
\item[\code{z}] a matrix containing the values to be plotted (\code{NA}s are
allowed).  Note that \code{x} can be used instead of \code{z} for
convenience.
\item[\code{xlim, ylim, zlim}] x-, y-  and z-limits.  These should be chosen
to cover the range of values of the surface: see `Details'.
\item[\code{xlab, ylab, zlab}] titles for the axes.  N.B. These must be
character strings; expressions are not accepted.  Numbers will be
coerced to character strings.
\item[\code{main, sub}] main and sub title, as for \code{\LinkA{title}{title}}.
\item[\code{theta, phi}] angles defining the viewing direction.
\code{theta} gives the azimuthal direction and \code{phi}
the colatitude.
\item[\code{r}] the distance of the eyepoint from the centre of the plotting box.
\item[\code{d}] a value which can be used to vary the strength of
the perspective transformation.  Values of \code{d} greater
than 1 will lessen the perspective effect and values less
and 1 will exaggerate it.
\item[\code{scale}] before viewing the x, y and z coordinates of the
points defining the surface are transformed to the interval
[0,1].  If \code{scale} is \code{TRUE} the x, y and z coordinates
are transformed separately.  If \code{scale} is \code{FALSE}
the coordinates are scaled so that aspect ratios are retained.
This is useful for rendering things like DEM information.
\item[\code{expand}] a expansion factor applied to the \code{z}
coordinates. Often used with \code{0 < expand < 1} to shrink the
plotting box in the \code{z} direction.
\item[\code{col}] the color(s) of the surface facets.  Transparent colours are
ignored.  This is recycled to the \eqn{(nx-1)(ny-1)}{} facets.
\item[\code{border}] the color of the line drawn around the surface facets.
The default, \code{NULL}, corresponds to \code{par("fg")}.
A value of \code{NA} will disable the drawing of borders: this is
sometimes useful when the surface is shaded.
\item[\code{ltheta, lphi}] if finite values are specified for \code{ltheta}
and \code{lphi}, the surface is shaded as though it was being
illuminated from the direction specified by azimuth \code{ltheta}
and colatitude \code{lphi}.
\item[\code{shade}] the shade at a surface facet is computed as
\code{((1+d)/2)\textasciicircum{}shade}, where \code{d} is the dot product of
a unit vector normal to the facet and a unit vector in the
direction of a light source.  Values of \code{shade} close
to one yield shading similar to a point light source model
and values close to zero produce no shading.  Values in the
range 0.5 to 0.75 provide an approximation to daylight
illumination.
\item[\code{box}] should the bounding box for the surface be displayed.
The default is \code{TRUE}.
\item[\code{axes}] should ticks and labels be added to the box.  The
default is \code{TRUE}.  If \code{box} is \code{FALSE} then no
ticks or labels are drawn.
\item[\code{ticktype}] character: \code{"simple"} draws just an arrow
parallel to the axis to indicate direction of increase;
\code{"detailed"} draws normal ticks as per 2D plots.
\item[\code{nticks}] the (approximate) number of tick marks to draw on the
axes.  Has no effect if \code{ticktype} is \code{"simple"}.
\item[\code{...}] additional \LinkA{graphical parameters}{graphical parameters} (see \code{\LinkA{par}{par}}).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The plots are produced by first transforming the (x,y,z)
coordinates to the interval [0,1] using the limits supplied or
computed from the range of the data.  The surface is then viewed
by looking at the origin from a direction defined by \code{theta}
and \code{phi}.  If \code{theta} and \code{phi} are both zero
the viewing direction is directly down the negative y axis.
Changing \code{theta} will vary the azimuth and changing \code{phi}
the colatitude.

There is a hook called \code{"persp"} (see \code{\LinkA{setHook}{setHook}})
called after the plot is completed, which is used in the
testing code to annotate the plot page.  The hook function(s) are
called with no argument.

Notice that \code{persp} interprets the \code{z} matrix as a table of
\code{f(x[i], y[j])} values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
so that with the standard rotation angles, the top left corner of the
matrix is displayed at the left hand side, closest to the user.

The sizes and fonts of the axis labels and the annotations for
\code{ticktype="detailed"} are controlled by graphics parameters
\code{"cex.lab"}/\code{"font.lab"} and
\code{"cex.axis"}/\code{"font.axis"} respectively.

The bounding box is drawn with edges of faces facing away from the
viewer (and hence at the back of the box) with solid lines and other
edges dashed and on top of the surface.  This (and the plotting of the
axes) assumes that the axis limits are chosen so that the surface
is within the box, and the function will warn if this is not the case.
\end{Details}
%
\begin{Value}
\code{persp()} returns the \emph{viewing transformation matrix}, say
\code{VT}, a \eqn{4 \times 4}{} matrix suitable for projecting 3D
coordinates \eqn{(x,y,z)}{} into the 2D plane using homogeneous 4D
coordinates \eqn{(x,y,z,t)}{}.  It can be used to superimpose
additional graphical elements on the 3D plot, by
\code{\LinkA{lines}{lines}()} or \code{\LinkA{points}{points}()}, using the
function \code{\LinkA{trans3d}{trans3d}()}. 
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{contour}{contour}} and \code{\LinkA{image}{image}}; \code{\LinkA{trans3d}{trans3d}}.

Rotatable 3D plots can be produced by package \Rhref{http://CRAN.R-project.org/package=rgl}{\pkg{rgl}}: other
ways to produce static perspective plots are available in packages
\Rhref{http://CRAN.R-project.org/package=lattice}{\pkg{lattice}} and \Rhref{http://CRAN.R-project.org/package=scatterplot3d}{\pkg{scatterplot3d}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices) # for trans3d
## More examples in  demo(persp) !!
##                   -----------

# (1) The Obligatory Mathematical surface.
#     Rotated sinc function.

x <- seq(-10, 10, length= 30)
y <- x
f <- function(x,y) { r <- sqrt(x^2+y^2); 10 * sin(r)/r }
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
      ltheta = 120, shade = 0.75, ticktype = "detailed",
      xlab = "X", ylab = "Y", zlab = "Sinc( r )"
) -> res
round(res, 3)

# (2) Add to existing persp plot - using trans3d() :

xE <- c(-10,10); xy <- expand.grid(xE, xE)
points(trans3d(xy[,1], xy[,2], 6, pmat = res), col = 2, pch =16)
lines (trans3d(x, y=10, z= 6 + sin(x), pmat = res), col = 3)

phi <- seq(0, 2*pi, len = 201)
r1 <- 7.725 # radius of 2nd maximum
xr <- r1 * cos(phi)
yr <- r1 * sin(phi)
lines(trans3d(xr,yr, f(xr,yr), res), col = "pink", lwd = 2)
## (no hidden lines)

# (3) Visualizing a simple DEM model

z <- 2 * volcano        # Exaggerate the relief
x <- 10 * (1:nrow(z))   # 10 meter spacing (S to N)
y <- 10 * (1:ncol(z))   # 10 meter spacing (E to W)
## Don't draw the grid lines :  border = NA
par(bg = "slategray")
persp(x, y, z, theta = 135, phi = 30, col = "green3", scale = FALSE,
      ltheta = -120, shade = 0.75, border = NA, box = FALSE)

# (4) Surface colours corresponding to z-values

par(bg = "white")
x <- seq(-1.95, 1.95, length = 30)
y <- seq(-1.95, 1.95, length = 35)
z <- outer(x, y, function(a,b) a*b^2)
nrz <- nrow(z)
ncz <- ncol(z)
# Create a function interpolating colors in the range of specified colors
jet.colors <- colorRampPalette( c("blue", "green") ) 
# Generate the desired number of colors from this palette
nbcol <- 100
color <- jet.colors(nbcol)
# Compute the z-value at the facet centres
zfacet <- z[-1, -1] + z[-1, -ncz] + z[-nrz, -1] + z[-nrz, -ncz]
# Recode facet z-values into color indices
facetcol <- cut(zfacet, nbcol)
persp(x, y, z, col=color[facetcol], phi=30, theta=-30)

par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{pie}{Pie Charts}{pie}
\keyword{hplot}{pie}
%
\begin{Description}\relax
Draw a pie chart.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
pie(x, labels = names(x), edges = 200, radius = 0.8,
    clockwise = FALSE, init.angle = if(clockwise) 90 else 0,
    density = NULL, angle = 45, col = NULL, border = NULL,
    lty = NULL, main = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a vector of non-negative numerical quantities.
The values in \code{x} are displayed as the areas of pie slices.
\item[\code{labels}] one or more expressions or character strings giving
names for the slices.  Other objects are coerced by
\code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}.  For empty or \code{NA}
(after coercion to character) labels, no label nor pointing line
is drawn.
\item[\code{edges}] the circular outline of the pie is approximated by a
polygon with this many edges.
\item[\code{radius}] the pie is drawn centered in a square box whose sides
range from \eqn{-1}{} to \eqn{1}{}.  If the character strings labeling
the slices are long it may be necessary to use a smaller radius.
\item[\code{clockwise}] logical indicating if slices are drawn clockwise or
counter clockwise (i.e., mathematically positive direction), the
latter is default.
\item[\code{init.angle}] number specifying the \emph{starting angle} (in
degrees) for the slices. Defaults to 0 (i.e., `3 o'clock')
unless \code{clockwise} is true where \code{init.angle}
defaults to 90 (degrees), (i.e., `12 o'clock').
\item[\code{density}] the density of shading lines, in lines per inch.
The default value of \code{NULL} means that no shading lines
are drawn. Non-positive values of \code{density} also inhibit the
drawing of shading lines.
\item[\code{angle}] the slope of shading lines, given as an angle in
degrees (counter-clockwise).
\item[\code{col}] a vector of colors to be used in filling or shading
the slices. If missing a set of 6 pastel colours is used,
unless \code{density} is specified when \code{par("fg")} is used.
\item[\code{border, lty}] (possibly vectors) arguments passed to
\code{\LinkA{polygon}{polygon}} which draws each slice.
\item[\code{main}] an overall title for the plot.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} can be given as arguments to
\code{pie}.  They will affect the main title and labels only.
\end{ldescription}
\end{Arguments}
%
\begin{Note}\relax
Pie charts are a very bad way of displaying information.
The eye is good at judging linear measures and bad at judging
relative areas.  A bar chart or dot chart is a preferable way of
displaying this type of data.

Cleveland (1985), page 264: ``Data that can be shown by pie charts
always can be shown by a dot chart.  This means that judgements of
position along a common scale can be made instead of the less
accurate angle judgements.''
This statement is based on the empirical investigations of Cleveland
and McGill as well as investigations by perceptual psychologists.
\end{Note}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Cleveland, W. S. (1985)
\emph{The Elements of Graphing Data}.
Wadsworth: Monterey, CA, USA.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{dotchart}{dotchart}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices)
pie(rep(1, 24), col = rainbow(24), radius = 0.9)

pie.sales <- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
names(pie.sales) <- c("Blueberry", "Cherry",
    "Apple", "Boston Cream", "Other", "Vanilla Cream")
pie(pie.sales) # default colours
pie(pie.sales, col = c("purple", "violetred1", "green3",
                       "cornsilk", "cyan", "white"))
pie(pie.sales, col = gray(seq(0.4,1.0,length=6)))
pie(pie.sales, density = 10, angle = 15 + 10 * 1:6)
pie(pie.sales, clockwise=TRUE, main="pie(*, clockwise=TRUE)")
segments(0,0, 0,1, col= "red", lwd = 2)
text(0,1, "init.angle = 90", col= "red")

n <- 200
pie(rep(1,n), labels="", col=rainbow(n), border=NA,
    main = "pie(*, labels=\"\", col=rainbow(n), border=NA,..")
\end{ExampleCode}
\end{Examples}
\HeaderA{plot}{Generic X-Y Plotting}{plot}
\keyword{hplot}{plot}
%
\begin{Description}\relax
Generic function for plotting of \R{} objects.  For more details about
the graphical parameter arguments, see \code{\LinkA{par}{par}}.

For simple scatter plots, \code{\LinkA{plot.default}{plot.default}} will be used.
However, there are \code{plot} methods for many \R{} objects,
including \code{\LinkA{function}{function}}s, \code{\LinkA{data.frame}{data.frame}}s,
\code{\LinkA{density}{density}} objects, etc.  Use \code{methods(plot)} and
the documentation for these.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
plot(x, y, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] the coordinates of points in the plot. Alternatively, a
single plotting structure, function or \emph{any \R{} object with a
\code{plot} method} can be provided.
\item[\code{y}] the y coordinates of points in the plot, \emph{optional}
if \code{x} is an appropriate structure.
\item[\code{...}] Arguments to be passed to methods, such as
\LinkA{graphical parameters}{graphical parameters} (see \code{\LinkA{par}{par}}).
Many methods will accept the following arguments:
\begin{description}

\item[\code{type}] what type of plot should be drawn.  Possible types are
\begin{itemize}

\item \code{"p"} for \bold{p}oints,
\item \code{"l"} for \bold{l}ines,
\item \code{"b"} for \bold{b}oth,
\item \code{"c"} for the lines part alone of \code{"b"},
\item \code{"o"} for both `\bold{o}verplotted',
\item \code{"h"} for `\bold{h}istogram' like (or
`high-density') vertical lines,
\item \code{"s"} for stair \bold{s}teps,
\item \code{"S"} for other \bold{s}teps, see `Details' below,
\item \code{"n"} for no plotting.

\end{itemize}

All other \code{type}s give a warning or an error; using, e.g.,
\code{type = "punkte"} being equivalent to \code{type = "p"} for S
compatibility.  Note that some methods,
e.g. \code{\LinkA{plot.factor}{plot.factor}}, do not accept this.

\item[\code{main}] an overall title for the plot: see \code{\LinkA{title}{title}}.
\item[\code{sub}] a sub title for the plot: see \code{\LinkA{title}{title}}.
\item[\code{xlab}] a title for the x axis: see \code{\LinkA{title}{title}}.
\item[\code{ylab}] a title for the y axis: see \code{\LinkA{title}{title}}.
\item[\code{asp}] the \eqn{y/x}{} aspect ratio,
see \code{\LinkA{plot.window}{plot.window}}.

\end{description}


\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The two step types differ in their x-y preference: Going from
\eqn{(x1,y1)}{} to \eqn{(x2,y2)}{} with \eqn{x1 < x2}{}, \code{type = "s"}
moves first horizontal, then vertical, whereas \code{type = "S"} moves
the other way around.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{plot.formula}{plot.formula}} and other
methods; \code{\LinkA{points}{points}}, \code{\LinkA{lines}{lines}}, \code{\LinkA{par}{par}}.

For X-Y-Z plotting see \code{\LinkA{contour}{contour}}, \code{\LinkA{persp}{persp}} and
\code{\LinkA{image}{image}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
plot(cars)
lines(lowess(cars))

plot(sin, -pi, 2*pi) # see ?plot.function

## Discrete Distribution Plot:
plot(table(rpois(100,5)), type = "h", col = "red", lwd=10,
     main="rpois(100,lambda=5)")

## Simple quantiles/ECDF, see ecdf() {library(stats)} for a better one:
plot(x <- sort(rnorm(47)), type = "s", main = "plot(x, type = \"s\")")
points(x, cex = .5, col = "dark red")
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.data.frame}{Plot Method for Data Frames}{plot.data.frame}
\keyword{hplot}{plot.data.frame}
\keyword{methods}{plot.data.frame}
%
\begin{Description}\relax
\code{plot.data.frame}, a method for the \code{\LinkA{plot}{plot}} generic.
It is designed for a quick look at numeric data frames.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'data.frame'
plot(x, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] object of class \code{data.frame}.
\item[\code{...}] further arguments to \code{\LinkA{stripchart}{stripchart}},
\code{\LinkA{plot.default}{plot.default}} or \code{\LinkA{pairs}{pairs}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This is intended for data frames with \emph{numeric} columns. For more
than two columns it first calls \code{\LinkA{data.matrix}{data.matrix}} to convert
the data frame to a numeric matrix and then calls \code{\LinkA{pairs}{pairs}}
to produce a scatterplot matrix).  This can fail and may well be
inappropriate: for example numerical conversion of dates will lose
their special meaning and a warning will be given.

For a two-column data frame it plots the second column against the
first by the most appropriate method for the first column.

For a single numeric column it uses \code{\LinkA{stripchart}{stripchart}}, and for
other single-column data frames tries to find a plot method for the
single column.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{data.frame}{data.frame}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(OrchardSprays[1], method="jitter")
plot(OrchardSprays[c(4,1)])
plot(OrchardSprays)

plot(iris)
plot(iris[5:4])
plot(women)
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.default}{The Default Scatterplot Function}{plot.default}
\keyword{hplot}{plot.default}
%
\begin{Description}\relax
Draw a scatter plot with decorations such as axes and titles
in the active graphics window.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## Default S3 method:
plot(x, y = NULL, type = "p",  xlim = NULL, ylim = NULL,
     log = "", main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
     ann = par("ann"), axes = TRUE, frame.plot = axes,
     panel.first = NULL, panel.last = NULL, asp = NA, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the \code{x} and \code{y} arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function \code{\LinkA{xy.coords}{xy.coords}}
for details.  If supplied separately, they must be of the same length.
\item[\code{type}] 1-character string giving the type of plot desired.  The
following values are possible, for details, see \code{\LinkA{plot}{plot}}:
\code{"p"} for points, \code{"l"} for lines,
\code{"b"} for both points and lines,
\code{"c"} for empty points joined by lines,    
\code{"o"} for overplotted points and lines,
\code{"s"} and \code{"S"} for stair steps and
\code{"h"} for histogram-like vertical lines.  Finally,
\code{"n"} does not produce any points or lines.
\item[\code{xlim}] the x limits (x1, x2) of the plot.  Note that \code{x1 > x2}
is allowed and leads to a `reversed axis'.

The default value, \code{NULL}, indicates that the range of the
\LinkA{finite}{finite} values to be plotted should be used.
\item[\code{ylim}] the y limits of the plot.
\item[\code{log}] a character string which contains \code{"x"} if the x axis
is to be logarithmic, \code{"y"} if the y axis is to be logarithmic
and \code{"xy"} or \code{"yx"} if both axes are to be logarithmic.

\item[\code{main}] a main title for the plot, see also \code{\LinkA{title}{title}}.
\item[\code{sub}] a sub title for the plot.
\item[\code{xlab}] a label for the x axis, defaults to a description of \code{x}.
\item[\code{ylab}] a label for the y axis, defaults to a description of \code{y}.

\item[\code{ann}] a logical value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.
\item[\code{axes}] a logical value indicating whether both axes should be drawn on
the plot.  Use \LinkA{graphical parameter}{graphical parameter} \code{"xaxt"} or \code{"yaxt"}
to suppress just one of the axes.
\item[\code{frame.plot}] a logical indicating whether a box should be drawn
around the plot.

\item[\code{panel.first}] an `expression' to be evaluated after the
plot axes are set up but before any plotting takes place.  This can
be useful for drawing background grids or scatterplot smooths.  Note
that this works by lazy evaluation: passing this argument from other
\code{plot} methods may well not work since it may be evaluated too
early.

\item[\code{panel.last}] an expression to be evaluated after plotting has
taken place but before the axes, title and box are added.  See the
comments about \code{panel.first}.

\item[\code{asp}] the \eqn{y/x}{} aspect ratio, see \code{\LinkA{plot.window}{plot.window}}.
\item[\code{...}] other \LinkA{graphical parameters}{graphical parameters} (see \code{\LinkA{par}{par}} and
section `Details' below).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Commonly used \LinkA{graphical parameters}{graphical parameters} are:
\begin{description}

\item[\code{col}] The colors for lines and points.  Multiple colors can be
specified so that each point can be given its own color.  If there
are fewer colors than points they are recycled in the standard
fashion.  Lines will all be plotted in the first colour specified.
\item[\code{bg}] a vector of background colors for open plot symbols, see
\code{\LinkA{points}{points}}.  Note: this is \bold{not} the same setting
as \code{\LinkA{par}{par}("bg")}.
\item[\code{pch}] a vector of plotting characters or symbols:
see \code{\LinkA{points}{points}}.
\item[\code{cex}] a numerical vector giving the amount by which
plotting characters and symbols should be scaled relative to the
default.  This works as a multiple of \code{\LinkA{par}{par}("cex")}.
\code{NULL} and \code{NA} are equivalent to \code{1.0}.  Note that
this does not affect annotation: see below.
\item[\code{lty}] a vector of line types, see \code{\LinkA{par}{par}}.
\item[\code{cex.main}, \code{col.lab}, \code{font.sub},
etc] settings for main- and sub-title and axis annotation, see
\code{\LinkA{title}{title}} and \code{\LinkA{par}{par}}.
\item[\code{lwd}] a vector of line widths, see \code{\LinkA{par}{par}}.

\end{description}

\end{Details}
%
\begin{Note}\relax
The presence of \code{panel.first} and \code{panel.last} is a
historical anomaly: default plots do not have `panels', unlike
e.g. \code{\LinkA{pairs}{pairs}} plots.  For more control, use lower-level
plotting functions: \code{plot.default} calls in turn some of
\code{\LinkA{plot.new}{plot.new}}, \code{\LinkA{plot.window}{plot.window}},
\code{\LinkA{plot.xy}{plot.xy}}, \code{\LinkA{axis}{axis}}, \code{\LinkA{box}{box}} and
\code{\LinkA{title}{title}}, and plots can be built up by calling these
individually, or by calling \code{plot(type = "n")} and adding further
elements.
\end{Note}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Cleveland, W. S. (1985)
\emph{The Elements of Graphing Data.}
Monterey, CA: Wadsworth.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot}{plot}}, \code{\LinkA{plot.window}{plot.window}}, \code{\LinkA{xy.coords}{xy.coords}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
Speed <- cars$speed
Distance <- cars$dist
plot(Speed, Distance, panel.first = grid(8,8),
     pch = 0, cex = 1.2, col = "blue")
plot(Speed, Distance,
     panel.first = lines(stats::lowess(Speed, Distance), lty = "dashed"),
     pch = 0, cex = 1.2, col = "blue")

## Show the different plot types
x <- 0:12
y <- sin(pi/5 * x)
op <- par(mfrow = c(3,3), mar = .1+ c(2,2,3,1))
for (tp in c("p","l","b",  "c","o","h",  "s","S","n")) {
   plot(y ~ x, type = tp,
        main = paste("plot(*, type = \"",tp,"\")",sep=""))
   if(tp == "S") {
      lines(x,y, type = "s", col = "red", lty = 2)
      mtext("lines(*, type = \"s\", ...)", col = "red", cex=.8)
   }
}
par(op)

##--- Log-Log Plot  with  custom axes
lx <- seq(1,5, length=41)
yl <- expression(e^{-frac(1,2) * {log[10](x)}^2})
y <- exp(-.5*lx^2)
op <- par(mfrow=c(2,1), mar=par("mar")+c(0,1,0,0))
plot(10^lx, y, log="xy", type="l", col="purple",
     main="Log-Log plot", ylab=yl, xlab="x")
plot(10^lx, y, log="xy", type="o", pch='.', col="forestgreen",
     main="Log-Log plot with custom axes", ylab=yl, xlab="x",
     axes = FALSE, frame.plot = TRUE)
my.at <- 10^(1:5)
axis(1, at = my.at, labels = formatC(my.at, format="fg"))
at.y <- 10^(-5:-1)
axis(2, at = at.y, labels = formatC(at.y, format="fg"), col.axis="red")
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.design}{Plot Univariate Effects of a Design or Model}{plot.design}
\keyword{hplot}{plot.design}
%
\begin{Description}\relax
Plot univariate effects of one or more \code{\LinkA{factor}{factor}}s,
typically for a designed experiment as analyzed by \code{\LinkA{aov}{aov}()}.
Further, in S this a method of the \code{\LinkA{plot}{plot}} generic function
for \code{design} objects.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
plot.design(x, y = NULL, fun = mean, data = NULL, ...,
            ylim = NULL, xlab = "Factors", ylab = NULL,
            main = NULL, ask = NULL, xaxt = par("xaxt"),
            axes = TRUE, xtick = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] either a data frame containing the design factors and
optionally the response, or a \code{\LinkA{formula}{formula}} or
\code{\LinkA{terms}{terms}} object.
\item[\code{y}] the response, if not given in x.
\item[\code{fun}] a function (or name of one) to be applied to each
subset.  It must return one number for a numeric (vector) input.
\item[\code{data}] data frame containing the variables referenced by \code{x}
when that is formula like.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} such as \code{col},
see \code{\LinkA{par}{par}}.
\item[\code{ylim}] range of y values, as in \code{\LinkA{plot.default}{plot.default}}.
\item[\code{xlab}] x axis label, see \code{\LinkA{title}{title}}.
\item[\code{ylab}] y axis label with a `smart' default.
\item[\code{main}] main title, see \code{\LinkA{title}{title}}.
\item[\code{ask}] logical indicating if the user should be asked before a new
page is started -- in the case of multiple y's.
\item[\code{xaxt}] character giving the type of x axis.
\item[\code{axes}] logical indicating if axes should be drawn.
\item[\code{xtick}] logical indicating if ticks (one per factor) should
be drawn on the x axis.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The supplied function will be called once for each level of each
factor in the design and the plot will show these summary values.  The
levels of a particular factor are shown along a vertical line, and the
overall value of \code{fun()} for the response is drawn as a
horizontal line.

This is a new \R{} implementation which will not be completely
compatible to the earlier S implementations.  This is not a bug but
might still change.
\end{Details}
%
\begin{Note}\relax
A big effort was taken to make this closely compatible to the S
version.  However, \code{col} (and \code{fg}) specification has
different effects.
\end{Note}
%
\begin{Author}\relax
Roberto Frisullo and Martin Maechler
\end{Author}
%
\begin{References}\relax
Chambers, J. M. and Hastie, T. J. eds (1992)
\emph{Statistical Models in S}.
Chapman \& Hall, London, \bold{the} \emph{white book}, pp. 546--7 (and 163--4).

Freeny, A. E. and Landwehr, J. M. (1990)
Displays for data from large designed experiments;
Computer Science and Statistics: Proc.\bsl{} 22nd Symp\bsl{}. Interface, 117--126,
Springer Verlag.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{interaction.plot}{interaction.plot}} for a `standard graphic'
of designed experiments.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
plot.design(warpbreaks)# automatic for data frame with one numeric var.

Form <- breaks ~ wool + tension
summary(fm1 <- aov(Form, data = warpbreaks))
plot.design(       Form, data = warpbreaks, col = 2)# same as above

## More than one y :
utils::str(esoph)
plot.design(esoph) ## two plots; if interactive you are "ask"ed

## or rather, compare mean and median:
op <- par(mfcol = 1:2)
plot.design(ncases/ncontrols ~ ., data = esoph, ylim = c(0, 0.8))
plot.design(ncases/ncontrols ~ ., data = esoph, ylim = c(0, 0.8),
            fun = median)
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.factor}{Plotting Factor Variables}{plot.factor}
\keyword{hplot}{plot.factor}
%
\begin{Description}\relax
This functions implements a scatterplot method for
\code{\LinkA{factor}{factor}} arguments of the \emph{generic}
\code{\LinkA{plot}{plot}} function.

If \code{y} is missing \code{\LinkA{barplot}{barplot}} is produced.
For numeric \code{y} a \code{\LinkA{boxplot}{boxplot}} is used, and for a factor
\code{y} a \code{\LinkA{spineplot}{spineplot}} is shown.  For any other type of
\code{y} the next \code{plot} method is called, normally
\code{\LinkA{plot.default}{plot.default}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'factor'
plot(x, y, legend.text = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] numeric or factor. \code{y} may be missing.
\item[\code{legend.text}] character vector for annotation of y axis in the
case of a factor \code{y}: defaults to \code{levels(y)}.  This
sets the \code{yaxlabels} argument of \code{\LinkA{spineplot}{spineplot}}.     
\item[\code{...}] Further arguments to \code{\LinkA{barplot}{barplot}},
\code{\LinkA{boxplot}{boxplot}}, \code{\LinkA{spineplot}{spineplot}} or
\code{\LinkA{plot}{plot}} as appropriate.  All of these accept
\LinkA{graphical parameters}{graphical parameters} (see \code{\LinkA{par}{par}}) and
annotation arguments passed
to \code{\LinkA{title}{title}} and \code{axes = FALSE}.  None accept \code{type}.

\end{ldescription}
\end{Arguments}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{plot.formula}{plot.formula}},
\code{\LinkA{barplot}{barplot}}, \code{\LinkA{boxplot}{boxplot}}, \code{\LinkA{spineplot}{spineplot}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices)


plot(weight ~ group, data = PlantGrowth)         # numeric vector ~ factor
plot(cut(weight, 2) ~ group, data = PlantGrowth) # factor ~ factor
## passing "..." to spineplot() eventually:
plot(cut(weight, 3) ~ group, data = PlantGrowth,
     col = hcl(c(0, 120, 240), 50, 70))

plot(PlantGrowth$group, axes=FALSE, main="no axes")# extremely silly
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.formula}{Formula Notation for Scatterplots}{plot.formula}
\aliasA{lines.formula}{plot.formula}{lines.formula}
\aliasA{points.formula}{plot.formula}{points.formula}
\aliasA{text.formula}{plot.formula}{text.formula}
\keyword{hplot}{plot.formula}
\keyword{aplot}{plot.formula}
%
\begin{Description}\relax
Specify a scatterplot or add points, lines, or text via a formula.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'formula'
plot(formula, data = parent.frame(), ..., subset,
             ylab = varnames[response], ask = dev.interactive())

## S3 method for class 'formula'
points(formula, data = parent.frame(), ..., subset)

## S3 method for class 'formula'
lines(formula, data = parent.frame(), ..., subset)

## S3 method for class 'formula'
text(formula, data = parent.frame(), ..., subset)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{formula}] a \code{\LinkA{formula}{formula}}, such as \code{y \textasciitilde{} x}.
\item[\code{data}] a data.frame (or list) from which the variables in
\code{formula} should be taken.  A matrix is converted to a data frame.
\item[\code{...}] Arguments to be passed to or from other methods.
\code{horizontal = TRUE} is also accepted.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used in the fitting process.
\item[\code{ylab}] the y label of the plot(s).
\item[\code{ask}] logical, see \code{\LinkA{par}{par}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For the \code{lines}, \code{points} and \code{text} methods the formula
should be of the form \code{y \textasciitilde{} x} or \code{y \textasciitilde{} 1} with a left-hand
side and a single term on the right-hand side.  The \code{plot} method
accepts other forms discussed later in this section.

Both the terms in the formula and the \code{...} arguments are
evaluated in \code{data} enclosed in \code{parent.frame()} if
\code{data} is a list or a data frame.  The terms of the formula and
those arguments in \code{...} that are of the same length as
\code{data} are subjected to the subsetting specified in
\code{subset}.  A plot against the running index can be specified as
\code{plot(y \textasciitilde{} 1)}.

If the formula in the \code{plot} method contains more than one term
on the right-hand side, a series of plots is produced of the response
against each non-response term.

For the \code{plot} method the formula can be of the form
\code{\textasciitilde{} z + y + z}: the variables specified on the right-hand side are
collected into a data frame, subsetted if specified, and displayed by
\code{\LinkA{plot.data.frame}{plot.data.frame}}.

Missing values are not considered in these methods, and in particular
cases with missing values are not removed.

If \code{y} is an object (i.e. has a \code{\LinkA{class}{class}} attribute)
then \code{plot.formula} looks for a plot method for that class first.
Otherwise, the class of \code{x} will determine the type of the plot.
For factors this will be a parallel boxplot, and argument
\code{horizontal = TRUE} can be specified (see \code{\LinkA{boxplot}{boxplot}}).

Note that some arguments will need to be protected from premature
evaluation by enclosing them in \code{\LinkA{quote}{quote}}: currently this is
done automatically for \code{main}, \code{sub} and \code{xlab}.  For
example, it is needed for the \code{panel.first} and \code{panel.last}
arguments passed to \code{\LinkA{plot.default}{plot.default}}.
\end{Details}
%
\begin{Value}
These functions are invoked for their side effect of drawing
on the active graphics device.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{points}{points}}, \code{\LinkA{lines}{lines}},
\code{\LinkA{plot.factor}{plot.factor}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
op <- par(mfrow = c(2,1))
plot(Ozone ~ Wind, data = airquality, pch = as.character(Month))
plot(Ozone ~ Wind, data = airquality, pch = as.character(Month),
     subset = Month != 7)
par(op)

## text.formula() can be very natural:
wb <- within(warpbreaks, {
    time <- seq_along(breaks); W.T <- wool:tension })
plot(breaks ~ time, data = wb, type = "b")
text(breaks ~ time, data = wb, label = W.T, col = 1+as.integer(wool))
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.histogram}{Plot Histograms}{plot.histogram}
\aliasA{lines.histogram}{plot.histogram}{lines.histogram}
\keyword{hplot}{plot.histogram}
\keyword{iplot}{plot.histogram}
%
\begin{Description}\relax
These are methods for objects of class \code{"histogram"}, typically
produced by \code{\LinkA{hist}{hist}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'histogram'
plot(x, freq = equidist, density = NULL, angle = 45,
               col = NULL, border = par("fg"), lty = NULL,
               main = paste("Histogram of",
                            paste(x$xname, collapse="\n")),
               sub = NULL, xlab = x$xname, ylab,
               xlim = range(x$breaks), ylim = NULL,
               axes = TRUE, labels = FALSE, add = FALSE,
               ann = TRUE, ...)

## S3 method for class 'histogram'
lines(x, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a \code{histogram} object, or a list with components
\code{density}, \code{mid}, etc, see \code{\LinkA{hist}{hist}} for
information about the components of \code{x}.
\item[\code{freq}] logical; if \code{TRUE}, the
histogram graphic is to present a representation of frequencies, i.e,
\code{x\$counts}; if \code{FALSE}, \emph{relative} frequencies
(probabilities), i.e., \code{x\$density}, are plotted.  The
default is true for equidistant \code{breaks} and false otherwise.
\item[\code{col}] a colour to be used to fill the bars.  The default of
\code{NULL} yields unfilled bars.
\item[\code{border}] the color of the border around the bars.
\item[\code{angle, density}] select shading of bars by lines:
see \code{\LinkA{rect}{rect}}.
\item[\code{lty}] the line type used for the bars, see also \code{\LinkA{lines}{lines}}.
\item[\code{main, sub, xlab, ylab}] these arguments to \code{title} have useful
defaults here.
\item[\code{xlim, ylim}] the range of x and y values with sensible defaults.
\item[\code{axes}] logical, indicating if axes should be drawn.
\item[\code{labels}] logical or character.  Additionally draw labels on top of bars,
if not \code{FALSE}; if \code{TRUE}, draw the counts or rounded
densities; if \code{labels} is a \code{character}, draw itself.
\item[\code{add}] logical.  If \code{TRUE}, only the bars are added to the
current plot.  This is what \code{lines.histogram(*)} does.
\item[\code{ann}] logical.  Should annotations (titles and axis titles) be plotted?
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters} to
\code{title} and \code{axis}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{lines.histogram(*)} is the same as
\code{plot.histogram(*, add = TRUE)}.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{hist}{hist}},
\code{\LinkA{stem}{stem}},
\code{\LinkA{density}{density}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
(wwt <- hist(women$weight, nclass = 7, plot = FALSE))
plot(wwt, labels = TRUE) # default main & xlab using wwt$xname
plot(wwt, border = "dark blue", col = "light blue",
     main = "Histogram of 15 women's weights", xlab = "weight [pounds]")

## Fake "lines" example, using non-default labels:
w2 <- wwt; w2$counts <- w2$counts - 1
lines(w2, col = "Midnight Blue", labels = ifelse(w2$counts, "> 1", "1"))
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.table}{Plot Methods for \code{table} Objects}{plot.table}
\aliasA{lines.table}{plot.table}{lines.table}
\aliasA{points.table}{plot.table}{points.table}
\keyword{hplot}{plot.table}
\keyword{category}{plot.table}
%
\begin{Description}\relax
This is a method of the generic \code{plot} function for
(contingency) \code{\LinkA{table}{table}} objects.  Whereas for two- and more
dimensional tables, a \code{\LinkA{mosaicplot}{mosaicplot}} is drawn,
one-dimensional ones are plotted as bars.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'table'
plot(x, type = "h", ylim = c(0, max(x)), lwd = 2,
     xlab = NULL, ylab = NULL, frame.plot = is.num, ...)
## S3 method for class 'table'
points(x, y = NULL, type = "h", lwd = 2, ...)
## S3 method for class 'table'
lines(x, y = NULL, type = "h", lwd = 2, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a \code{\LinkA{table}{table}} (like) object.
\item[\code{y}] Must be \code{NULL}: there to protect against incorrect calls.
\item[\code{type}] plotting type.
\item[\code{ylim}] range of y-axis.
\item[\code{lwd}] line width for bars when \code{type = "h"} is used in the 1D case.
\item[\code{xlab, ylab}] x- and y-axis labels.
\item[\code{frame.plot}] logical indicating if a frame (\code{\LinkA{box}{box}})
should be drawn in the 1D case.  Defaults to true when \code{x} has
\code{\LinkA{dimnames}{dimnames}} coerce-able to numbers.
\item[\code{...}] further graphical arguments, see \code{\LinkA{plot.default}{plot.default}}.
\code{axes = FALSE} is accepted.
\end{ldescription}
\end{Arguments}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.factor}{plot.factor}}, the \code{\LinkA{plot}{plot}} method for factors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## 1-d tables
(Poiss.tab <- table(N = stats::rpois(200, lambda = 5)))
plot(Poiss.tab, main = "plot(table(rpois(200, lambda = 5)))")

plot(table(state.division))

## 4-D :
plot(Titanic, main ="plot(Titanic, main= *)")

\end{ExampleCode}
\end{Examples}
\HeaderA{plot.window}{Set up World Coordinates for Graphics Window}{plot.window}
\aliasA{asp}{plot.window}{asp}
\aliasA{xlim}{plot.window}{xlim}
\aliasA{ylim}{plot.window}{ylim}
\keyword{aplot}{plot.window}
%
\begin{Description}\relax
This function sets up the world coordinate system for a graphics
window.  It is called by higher level functions such as
\code{\LinkA{plot.default}{plot.default}} (\emph{after} \code{\LinkA{plot.new}{plot.new}}).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
plot.window(xlim, ylim, log = "", asp = NA, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{xlim, ylim}] numeric vectors of length 2, giving the x and y
coordinates ranges.
\item[\code{log}] character; indicating which axes should be in log scale.
\item[\code{asp}] numeric, giving the \bold{asp}ect ratio y/x,
see `Details'.
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters} as in \code{\LinkA{par}{par}}.
The relevant ones are \code{xaxs}, \code{yaxs} and \code{lab}.

\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\begin{description}

\item[asp:] 
If \code{asp} is a finite positive value then the window is
set up so that one data unit in the x direction is equal in length to
\code{asp} \eqn{\times}{} one data unit in the y direction.

Note that in this case, \code{\LinkA{par}{par}("usr")} is no longer
determined by, e.g., \code{par("xaxs")}, but rather by \code{asp} and
the device's aspect ratio. (See what happens if you interactively
resize the plot device after running the example below!)

The special case \code{asp == 1} produces plots where distances
between points are represented accurately on screen.  Values with
\code{asp > 1} can be used to produce more accurate maps when using
latitude and longitude.

\end{description}


Note that the coordinate ranges will be extended by 4\% if the
appropriate \LinkA{graphical parameter}{graphical parameter} \code{xaxs} or \code{yaxs} has value
\code{"s"} (which is the default).

To reverse an axis, use \code{xlim} or \code{ylim} of the form
\code{c(hi, lo)}.

The function attempts to produce a plausible set of scales if one or
both of \code{xlim} and \code{ylim} is of length one or the two values
given are identical, but it is better to avoid that case.

Usually, one should rather use the higher-level functions such as
\code{\LinkA{plot}{plot}}, \code{\LinkA{hist}{hist}}, \code{\LinkA{image}{image}}, \dots,
instead and refer to their help pages for explanation of the
arguments.

A side-effect of the call is to set up the \code{usr}, \code{xaxp} and
\code{yaxp} \LinkA{graphical parameters}{graphical parameters}.  (It is for the latter two that
\code{lab} is used.)
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{xy.coords}{xy.coords}},
\code{\LinkA{plot.xy}{plot.xy}},
\code{\LinkA{plot.default}{plot.default}}.

\code{\LinkA{par}{par}} for the graphical parameters mentioned.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
##--- An example for the use of 'asp' :
require(stats)  # normally loaded
loc <- cmdscale(eurodist)
rx <- range(x <- loc[,1])
ry <- range(y <- -loc[,2])
plot(x, y, type="n", asp=1, xlab="", ylab="")
abline(h = pretty(rx, 10), v = pretty(ry, 10), col = "lightgray")
text(x, y, labels(eurodist), cex=0.8)
\end{ExampleCode}
\end{Examples}
\HeaderA{plot.xy}{Basic Internal Plot Function}{plot.xy}
\keyword{aplot}{plot.xy}
%
\begin{Description}\relax
This is \emph{the} internal function that does the basic plotting of
points and lines.  Usually, one should rather use the higher level
functions instead and refer to their help pages for explanation of the
arguments.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
plot.xy(xy, type, pch = par("pch"), lty = par("lty"),
        col = par("col"), bg = NA,
        cex = 1, lwd = par("lwd"), ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{xy}] A four-element list as results from
\code{\LinkA{xy.coords}{xy.coords}}.
\item[\code{type}] 1 character code: see \code{\LinkA{plot.default}{plot.default}}.
\code{NULL} is accepted as a synonym for \code{"p"}.
\item[\code{pch}] character or integer code for kind of points, see
\code{\LinkA{points.default}{points.default}}.
\item[\code{lty}] line type code, see \code{\LinkA{lines}{lines}}.
\item[\code{col}] color code or name, see \code{\LinkA{colors}{colors}},
\code{\LinkA{palette}{palette}}.  Here \code{NULL} means colour 0.
\item[\code{bg}] background (fill) color for the open plot symbols 21:25:
see \code{\LinkA{points.default}{points.default}}.
\item[\code{cex}] character expansion.
\item[\code{lwd}] line width, also used for (non-filled) plot symbols, see
\code{\LinkA{lines}{lines}} and \code{\LinkA{points}{points}}.
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters} such as \code{xpd},
\code{lend}, \code{ljoin} and \code{lmitre}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The arguments \code{pch}, \code{col}, \code{bg}, \code{cex},
\code{lwd} may be vectors and may be recycled, depending on
\code{type}: see \code{\LinkA{points}{points}} and \code{\LinkA{lines}{lines}} for
specifics.  In particular note that \code{lwd} is treated as a vector
for points and as a single (first) value for lines.

\code{cex} is a numeric factor in addition to \code{par("cex")} which
affects symbols and characters as drawn by \code{type} \code{"p"},
\code{"o"}, \code{"b"} and \code{"c"}.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot}{plot}},
\code{\LinkA{plot.default}{plot.default}},
\code{\LinkA{points}{points}},
\code{\LinkA{lines}{lines}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
points.default # to see how it calls "plot.xy(xy.coords(x, y), ...)"
\end{ExampleCode}
\end{Examples}
\graphicspath{{C:/architect-build/temp/r/i386/R-2.15.2/library/graphics/help/figures/}}
\HeaderA{points}{Add Points to a Plot}{points}
\aliasA{pch}{points}{pch}
\methaliasA{points.default}{points}{points.default}
\keyword{aplot}{points}
%
\begin{Description}\relax
\code{points} is a generic function to draw a sequence of points at
the specified coordinates.  The specified character(s) are plotted,
centered at the coordinates.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
points(x, ...)

## Default S3 method:
points(x, y = NULL, type = "p", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] coordinate vectors of points to plot.
\item[\code{type}] character indicating the type of plotting; actually any of
the \code{type}s as in \code{\LinkA{plot.default}{plot.default}}.
\item[\code{...}] Further \LinkA{graphical parameters}{graphical parameters} may also be supplied as
arguments.  See `Details'.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The coordinates can be passed in a plotting structure
(a list with \code{x} and \code{y} components), a two-column matrix, a
time series, \dots.  See \code{\LinkA{xy.coords}{xy.coords}}.  If supplied
separately, they must be of the same length.

Graphical parameters commonly used are
\begin{description}

\item[\code{pch}] plotting `character', i.e., symbol to use.
This can either be a single character or an integer code for one
of a set of graphics symbols.  The full set of S symbols is
available with \code{pch=0:18}, see the examples below.
(NB: \R{} uses circles instead of the octagons used in S.)

Value \code{pch="."} (equivalently \code{pch = 46}) is handled
specially.  It is a rectangle of side 0.01 inch (scaled by
\code{cex}).  In addition, if \code{cex = 1} (the default), each
side is at least one pixel (1/72 inch on the \code{\LinkA{pdf}{pdf}},
\code{\LinkA{postscript}{postscript}} and \code{\LinkA{xfig}{xfig}} devices).

For other text symbols, \code{cex = 1} corresponds to the default
fontsize of the device, often specified by an argument
\code{pointsize}.  For \code{pch} in \code{0:25} the default size
is about 75\% of the character height (see \code{par("cin")}).

\item[\code{col}] color code or name, see \code{\LinkA{par}{par}}.
\item[\code{bg}] background (fill) color for the open plot
symbols given by \code{pch=21:25}.
\item[\code{cex}] character (or symbol) expansion: a numerical vector.
This works as a multiple of \code{\LinkA{par}{par}("cex")}.
\item[\code{lwd}] line width for drawing symbols see \code{\LinkA{par}{par}}.

\end{description}

Others less commonly used are \code{lty} and \code{lwd} for
types such as \code{"b"} and \code{"l"}.

The \LinkA{graphical parameters}{graphical parameters} \code{pch}, \code{col}, \code{bg},
\code{cex} and \code{lwd} can be vectors (which will be recycled as
needed) giving a value for each point plotted.  If lines are to be
plotted (e.g. for \code{type = "b"}) the first element of \code{lwd}
is used.

Points whose \code{x}, \code{y}, \code{pch}, \code{col} or \code{cex}
value is \code{NA} are omitted from the plot.
\end{Details}
%
\begin{Section}{'pch' values}
Values of \code{pch} are stored internally as integers.  The
interpretation is
\begin{itemize}

\item \code{NA\_integer\_}: no symbol.
\item \code{0:18}: S-compatible vector symbols.
\item \code{19:25}: further \R{} vector symbols.
\item \code{26:31}: unused (and ignored).
\item \code{32:127}: ASCII characters.
\item \code{128:255} native characters \emph{only in a
single-byte locale and for the symbol font}.  (\code{128:159} are
only used on Windows.)
\item \code{-32 ...} Unicode point (where supported).

\end{itemize}

Note that unlike S (which uses octagons), symbols \code{1}, \code{10},
\code{13} and \code{16} use circles.  The filled shapes \code{15:18}
do not include a border.




\Figure{pch.pdf}{width=15cm}

The following  \R{} plotting symbols are can be obtained with
\code{pch=19:25}: those with \code{21:25} can be colored and
filled with different colors: \code{col} gives the border color
and \code{bg} the background color

(which is \samp{"grey"} in the figure)
\begin{itemize}

\item \code{pch=19}: solid circle,
\item \code{pch=20}: bullet (smaller solid circle,
2/3 the size of \code{19}),
\item \code{pch=21}: filled circle,
\item \code{pch=22}: filled square,
\item \code{pch=23}: filled diamond,
\item \code{pch=24}: filled triangle point-up,
\item \code{pch=25}: filled triangle point down.

\end{itemize}

Note that all of these both fill the shape and draw a border.  Some
care in interpretation is needed when semi-transparent colours are
used for both fill and border (and the result might be device-specific
and even viewer-specific for \code{\LinkA{pdf}{pdf}}).

The difference between \code{pch=16} and \code{pch=19} is that the
latter uses a border and so is perceptibly larger when \code{lwd} is
large relative to \code{cex}.

Values \code{pch=26:31} are currently unused and \code{pch=32:127}
give the ASCII characters.  In a single-byte locale
\code{pch=128:255} give the corresponding character (if any) in
the locale's character set.  Where supported by the OS, negative
values specify a Unicode point, so e.g. \code{-0x2642L}
is a `male sign' and \code{-0x20ACL} is the Euro.

A character string consisting of a single character is converted to an
integer: \code{32:127} for ASCII characters, and usually to the
Unicode point number otherwise.  (In non-Latin-1 single-byte locales,
\code{128:255} will be used for 8-bit characters.)

If \code{pch} supplied is a logical, integer or character
\code{NA} or an empty character string the point is omitted from
the plot.

If \code{pch} is \code{NULL} or otherwise of length 0,
\code{par("pch")} is used.

If the symbol font (\code{\LinkA{par}{par}(font = 5)}) is used, numerical
values should be used for \code{pch}: the range is
\code{c(32:126, 160:254)} in all locales (but \code{240} is not
defined (used for `apple' on Mac OS) and \code{160}, Euro, may
not be present).
\end{Section}
%
\begin{Note}\relax
A single-byte encoding may include the characters in
\code{pch=128:255}, and if it does, a font may not include all (or
even any) of them.

Not all negative numbers are valid as Unicode points, and no check is
done.  A display device is likely to use a rectangle for (or omit)
Unicode points that do not exist or which it does not have a glyph.

What happens for very small or zero values of \code{cex} is
device-dependent: symbols or characters may become invisible or
they may be plotted at a fixed minimum size.   As
from \R{} 2.15.0, circles of zero radius will not be plotted.
\end{Note}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{points.formula}{points.formula}} for the formula method;
\code{\LinkA{plot}{plot}}, \code{\LinkA{lines}{lines}}, and the underlying
workhorse function \code{\LinkA{plot.xy}{plot.xy}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats) # for rnorm
plot(-4:4, -4:4, type = "n")# setting up coord. system
points(rnorm(200), rnorm(200), col = "red")
points(rnorm(100)/2, rnorm(100)/2, col = "blue", cex = 1.5)

op <- par(bg = "light blue")
x <- seq(0,2*pi, len=51)
## something "between type='b' and type='o'":
plot(x, sin(x), type="o", pch=21, bg=par("bg"), col = "blue", cex=.6,
 main='plot(..., type="o", pch=21, bg=par("bg"))')
par(op)

## Not run: 
## The figure was produced by calls like
png("pch.png", height=0.7, width = 7, res = 100, units="in")
par(mar = rep(0,4))
plot(c(-1, 26), 0:1, type="n", axes= FALSE)
text(0:25, 0.6, 0:25, cex = 0.5)
points(0:25, rep(0.3, 26), pch = 0:25, bg = "grey")

## End(Not run)

##-------- Showing all the extra & some char graphics symbols ---------
pchShow <-
  function(extras = c("*",".", "o","O","0","+","-","|","%","#"),
           cex = 3, ## good for both .Device=="postscript" and "x11"
           col = "red3", bg = "gold", coltext = "brown", cextext = 1.2,
           main = paste("plot symbols :  points (...  pch = *, cex =",
                        cex,")"))
  {
    nex <- length(extras)
    np  <- 26 + nex
    ipch <- 0:(np-1)
    k <- floor(sqrt(np))
    dd <- c(-1,1)/2
    rx <- dd + range(ix <- ipch %/% k)
    ry <- dd + range(iy <- 3 + (k-1)- ipch %% k)
    pch <- as.list(ipch) # list with integers & strings
    if(nex > 0) pch[26+ 1:nex] <- as.list(extras)
    plot(rx, ry, type="n", axes = FALSE, xlab = "", ylab = "",
         main = main)
    abline(v = ix, h = iy, col = "lightgray", lty = "dotted")
    for(i in 1:np) {
      pc <- pch[[i]]
      ## 'col' symbols with a 'bg'-colored interior (where available) :
      points(ix[i], iy[i], pch = pc, col = col, bg = bg, cex = cex)
      if(cextext > 0)
          text(ix[i] - 0.3, iy[i], pc, col = coltext, cex = cextext)
    }
  }

pchShow()
pchShow(c("o","O","0"), cex = 2.5)
pchShow(NULL, cex = 4, cextext = 0, main = NULL)


## ------------ test code for various pch specifications -------------
# Try this in various font families (including Hershey)
# and locales.  Use sign=-1 asserts we want Latin-1.
# Standard cases in a MBCS locale will not plot the top half.
TestChars <- function(sign=1, font=1, ...)
{
   MB <- l10n_info()$MBCS
   r <- if(font == 5) { sign <- 1; c(32:126, 160:254)
       } else if(MB) 32:126 else 32:255
   if (sign == -1) r <- c(32:126, 160:255)
   par(pty="s")
   plot(c(-1,16), c(-1,16), type="n", xlab="",ylab="", xaxs="i", yaxs="i",
        main=sprintf("sign = %d, font = %d", sign,font))
   grid(17, 17, lty=1) ; mtext(paste("MBCS:", MB))
   for(i in r) try(points(i%%16, i%/%16, pch=sign*i, font=font,...))
}
TestChars()
try(TestChars(sign=-1))
TestChars(font=5) # Euro might be at 160 (0+10*16).  Mac OS has apple at 240 (0+15*16).
try(TestChars(-1, font=2))# bold
\end{ExampleCode}
\end{Examples}
\HeaderA{polygon}{Polygon Drawing}{polygon}
\keyword{aplot}{polygon}
%
\begin{Description}\relax
\code{polygon} draws the polygons whose vertices are
given in \code{x} and \code{y}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
polygon(x, y = NULL, density = NULL, angle = 45,
        border = NULL, col = NA, lty = par("lty"),
        ..., fillOddEven = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] vectors containing the coordinates of the vertices
of the polygon.
\item[\code{density}] the density of shading lines, in lines per inch.  The
default value of \code{NULL} means that no shading lines are drawn.
A zero value of \code{density} means no shading nor filling whereas
negative values and \code{NA} suppress shading (and so allow
color filling).
\item[\code{angle}] the slope of shading lines, given as an angle
in degrees (counter-clockwise).
\item[\code{col}] the color for filling the polygon. The default,
\code{NA}, is to leave polygons unfilled, unless \code{density} is
specified.  (For back-compatibility, \code{NULL} is equivalent to
\code{NA}.)  If \code{density} is specified with a positive value
this gives the color of the shading lines.
\item[\code{border}] the color to draw the border.  The default, \code{NULL},
means to use \code{\LinkA{par}{par}("fg")}.  Use \code{border = NA} to
omit borders.

For compatibility with S, \code{border} can also be logical, in
which case \code{FALSE} is equivalent to \code{NA} (borders omitted)
and \code{TRUE} is equivalent to \code{NULL} (use the foreground colour),

\item[\code{lty}] the line type to be used, as in \code{\LinkA{par}{par}}.
\item[\code{...}] graphical parameters such as \code{xpd}, \code{lend},
\code{ljoin} and \code{lmitre} can be given as arguments.
\item[\code{fillOddEven}] logical controlling the polygon shading mode:  see
below for details.  Default \code{FALSE}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The coordinates can be passed in a plotting structure
(a list with \code{x} and \code{y} components), a two-column matrix,
\dots.  See \code{\LinkA{xy.coords}{xy.coords}}.

It is assumed that the polygon is to be closed by joining the last
point to the first point.

The coordinates can contain missing values.  The behaviour is similar
to that of \code{\LinkA{lines}{lines}}, except that instead of breaking a line
into several lines, \code{NA} values break the polygon into several
complete polygons (including closing the last point to the first
point).  See the examples below.

When multiple polygons are produced, the values of \code{density},
\code{angle}, \code{col}, \code{border}, and \code{lty} are recycled
in the usual manner.

Shading of polygons is only implemented for linear plots: if either
axis is on log scale then shading is omitted, with a warning.
\end{Details}
%
\begin{Section}{Bugs}
Self-intersecting polygons may be filled using either the
``odd-even'' or ``non-zero'' rule.  These fill a region if
the polygon border encircles it an odd or non-zero number of times,
respectively.  Shading lines are handled internally by \R{} according
to the \code{fillOddEven} argument, but device-based solid fills
depend on the graphics device.  The \code{windows}, \code{\LinkA{pdf}{pdf}}
and \code{\LinkA{postscript}{postscript}} devices have their own \code{fillOddEven}
argument to control this.
\end{Section}
%
\begin{Author}\relax
The code implementing polygon shading was donated by
Kevin Buhr \email{buhr@stat.wisc.edu}.
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{segments}{segments}} for even more flexibility, \code{\LinkA{lines}{lines}},
\code{\LinkA{rect}{rect}}, \code{\LinkA{box}{box}}, \code{\LinkA{abline}{abline}}.

\code{\LinkA{par}{par}} for how to specify colors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- c(1:9,8:1)
y <- c(1,2*(5:3),2,-1,17,9,8,2:9)
op <- par(mfcol=c(3,1))
for(xpd in c(FALSE,TRUE,NA)) {
  plot(1:10, main = paste("xpd =", xpd))
  box("figure", col = "pink", lwd=3)
  polygon(x,y, xpd=xpd, col="orange", lty=2, lwd=2, border="red")
}
par(op)

n <- 100
xx <- c(0:n, n:0)
yy <- c(c(0,cumsum(stats::rnorm(n))), rev(c(0,cumsum(stats::rnorm(n)))))
plot   (xx, yy, type="n", xlab="Time", ylab="Distance")
polygon(xx, yy, col="gray", border = "red")
title("Distance Between Brownian Motions")

# Multiple polygons from NA values
# and recycling of col, border, and lty
op <- par(mfrow=c(2,1))
plot(c(1,9), 1:2, type="n")
polygon(1:9, c(2,1,2,1,1,2,1,2,1),
        col=c("red", "blue"),
        border=c("green", "yellow"),
        lwd=3, lty=c("dashed", "solid"))
plot(c(1,9), 1:2, type="n")
polygon(1:9, c(2,1,2,1,NA,2,1,2,1),
        col=c("red", "blue"),
        border=c("green", "yellow"),
        lwd=3, lty=c("dashed", "solid"))
par(op)

# Line-shaded polygons
plot(c(1,9), 1:2, type="n")
polygon(1:9, c(2,1,2,1,NA,2,1,2,1),
        density=c(10, 20), angle=c(-45, 45))
\end{ExampleCode}
\end{Examples}
\HeaderA{polypath}{Path Drawing}{polypath}
\keyword{aplot}{polypath}
%
\begin{Description}\relax
\code{path} draws a path whose vertices are
given in \code{x} and \code{y}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
polypath(x, y = NULL, 
         border = NULL, col = NA, lty = par("lty"),
         rule = "winding", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] vectors containing the coordinates of the vertices
of the path.
\item[\code{col}] the color for filling the path. The default,
\code{NA}, is to leave paths unfilled, unless \code{density} is
specified.  (For back-compatibility, \code{NULL} is equivalent to
\code{NA}.)  If \code{density} is specified with a positive value
this gives the color of the shading lines.
\item[\code{border}] the color to draw the border.  The default, \code{NULL},
means to use \code{\LinkA{par}{par}("fg")}.  Use \code{border = NA} to
omit borders.

For compatibility with S, \code{border} can also be logical, in
which case \code{FALSE} is equivalent to \code{NA} (borders omitted)
and \code{TRUE} is equivalent to \code{NULL} (use the foreground colour),

\item[\code{lty}] the line type to be used, as in \code{\LinkA{par}{par}}.
\item[\code{rule}] character value specifying the path fill mode: either
\code{"winding"} or \code{"evenodd"}.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} such as \code{xpd}, \code{lend},
\code{ljoin} and \code{lmitre} can be given as arguments.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The coordinates can be passed in a plotting structure
(a list with \code{x} and \code{y} components), a two-column matrix,
\dots.  See \code{\LinkA{xy.coords}{xy.coords}}.

It is assumed that the path is to be closed by joining the last point to
the first point.

The coordinates can contain missing values.  The behaviour is similar
to that of \code{\LinkA{polygon}{polygon}}, except that instead of breaking a
polygon into several polygons, \code{NA} values break the path into
several sub-paths (including closing the last point to the first point
in each sub-path).  See the examples below.

The distinction between a path and a polygon is that the former
can contain holes, as interpreted by the fill rule; these fill a region if
the path border encircles it an odd or non-zero number of times,
respectively.

Hatched shading (as implemented for \code{polygon()}) is not
(currently) supported.

Not all graphics devices support this function: for example
\code{xfig} and \code{pictex} do not.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{segments}{segments}} for even more flexibility, \code{\LinkA{lines}{lines}},
\code{\LinkA{rect}{rect}}, \code{\LinkA{box}{box}}, \code{\LinkA{polygon}{polygon}}.

\code{\LinkA{par}{par}} for how to specify colors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plotPath <- function(x, y, col = "grey", rule = "winding") {
    plot.new()
    plot.window(range(x, na.rm = TRUE), range(y, na.rm = TRUE))
    polypath(x, y, col = col, rule = rule)
    if (!is.na(col))
        mtext(paste("Rule:", rule), side = 1, line = 0)
}

plotRules <- function(x, y, title) {
    plotPath(x, y)
    plotPath(x, y, rule = "evenodd")
    mtext(title, side = 3, line = 0)
    plotPath(x, y, col = NA)
}

op <- par(mfrow = c(5, 3), mar = c(2, 1, 1, 1))

plotRules(c(.1, .1, .9, .9, NA, .2, .2, .8, .8),
          c(.1, .9, .9, .1, NA, .2, .8, .8, .2),
          "Nested rectangles, both clockwise")
plotRules(c(.1, .1, .9, .9, NA, .2, .8, .8, .2),
          c(.1, .9, .9, .1, NA, .2, .2, .8, .8),
          "Nested rectangles, outer clockwise, inner anti-clockwise")
plotRules(c(.1, .1, .4, .4, NA, .6, .9, .9, .6),
          c(.1, .4, .4, .1, NA, .6, .6, .9, .9),
          "Disjoint rectangles")
plotRules(c(.1, .1, .6, .6, NA, .4, .4, .9, .9),
          c(.1, .6, .6, .1, NA, .4, .9, .9, .4),
          "Overlapping rectangles, both clockwise")
plotRules(c(.1, .1, .6, .6, NA, .4, .9, .9, .4),
          c(.1, .6, .6, .1, NA, .4, .4, .9, .9),
          "Overlapping rectangles, one clockwise, other anti-clockwise")

par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{rasterImage}{Draw One or More Raster Images}{rasterImage}
\keyword{aplot}{rasterImage}
%
\begin{Description}\relax
\code{rasterImage} draws a raster image at the given locations and sizes.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rasterImage(image,
            xleft, ybottom, xright, ytop,
            angle = 0, interpolate = TRUE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{image}] a \code{raster} object, or an object that can be
coerced to one by \code{\LinkA{as.raster}{as.raster}}.
\item[\code{xleft}] a vector (or scalar) of left x positions.
\item[\code{ybottom}] a vector (or scalar) of bottom y positions.
\item[\code{xright}] a vector (or scalar) of right x positions.
\item[\code{ytop}] a vector (or scalar) of top y positions.
\item[\code{angle}] angle of rotation (in degrees, anti-clockwise
from positive x-axis, about the bottom-left corner).
\item[\code{interpolate}] a logical vector (or scalar) indicating
whether to apply linear interpolation to the image when drawing. 
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The positions supplied, i.e., \code{xleft, ...},
are relative to the current plotting region.  If the x-axis goes from
100 to 200 then \code{xleft} should be larger than 100 and \code{xright}
should be less than 200.  The position vectors will be recycled to the
length of the longest.

Plotting raster images is not supported on all devices and may have
limitations where supported, for example (e.g. for \code{postscript}
and \code{X11(type = "Xlib")}) is restricted to opaque colors).
Problems with the rendering of raster images have been reported by
users of \code{windows()} devices under Remote Desktop, at least under
its default settings.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{rect}{rect}},
\code{\LinkA{polygon}{polygon}}, and \code{\LinkA{segments}{segments}} and others
for flexible ways to draw shapes.

\code{\LinkA{dev.capabilities}{dev.capabilities}} to see if it is supported.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices)
## set up the plot region:
op <- par(bg = "thistle")
plot(c(100, 250), c(300, 450), type = "n", xlab="", ylab="")
image <- as.raster(matrix(0:1, ncol=5, nrow=3))
rasterImage(image, 100, 300, 150, 350, interpolate=FALSE)
rasterImage(image, 100, 400, 150, 450)
rasterImage(image, 200, 300, 200 + xinch(.5), 300 + yinch(.3),
       interpolate=FALSE)
rasterImage(image, 200, 400, 250, 450, angle=15, interpolate=FALSE)
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{rect}{Draw One or More Rectangles}{rect}
\keyword{aplot}{rect}
%
\begin{Description}\relax
\code{rect} draws a rectangle (or sequence of rectangles) with the
given coordinates, fill and border colors.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rect(xleft, ybottom, xright, ytop, density = NULL, angle = 45,
     col = NA, border = NULL, lty = par("lty"), lwd = par("lwd"),
     ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{xleft}] a vector (or scalar) of left x positions.
\item[\code{ybottom}] a vector (or scalar) of bottom y positions.
\item[\code{xright}] a vector (or scalar) of right x positions.
\item[\code{ytop}] a vector (or scalar) of top y positions.
\item[\code{density}] the density of shading lines, in lines per inch.
The default value of \code{NULL} means that no shading lines are drawn.
A zero value of \code{density} means no shading lines whereas
negative values (and \code{NA}) suppress shading (and so allow
color filling).
\item[\code{angle}] angle (in degrees) of the shading lines.
\item[\code{col}] color(s) to fill or shade the rectangle(s) with.
The default \code{NA} (or also \code{NULL}) means do not fill,
i.e., draw transparent rectangles, unless \code{density} is specified.
\item[\code{border}] color for rectangle border(s).  The default means
\code{par("fg")}.  Use \code{border = NA} to omit borders.
If there are shading
lines, \code{border = TRUE} means use the same colour for
the border as for the shading lines.
\item[\code{lty}] line type for borders and shading; defaults to \code{"solid"}.
\item[\code{lwd}] line width for borders and shading.  Note that the use of
\code{lwd = 0} (as in the examples) is device-dependent.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} such as \code{xpd}, \code{lend},
\code{ljoin} and \code{lmitre} can be given as
arguments.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The positions supplied, i.e., \code{xleft, ...},
are relative to the current plotting region.  If the x-axis goes from
100 to 200 then \code{xleft} must be larger than 100 and \code{xright}
must be less than 200.  The position vectors will be recycled to the
length of the longest.

It is a graphics primitive used in \code{\LinkA{hist}{hist}},
\code{\LinkA{barplot}{barplot}}, \code{\LinkA{legend}{legend}}, etc.
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{box}{box}} for the standard box around the plot;
\code{\LinkA{polygon}{polygon}} and \code{\LinkA{segments}{segments}} for flexible line
drawing.

\code{\LinkA{par}{par}} for how to specify colors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices)
## set up the plot region:
op <- par(bg = "thistle")
plot(c(100, 250), c(300, 450), type = "n", xlab="", ylab="",
     main = "2 x 11 rectangles; 'rect(100+i,300+i,  150+i,380+i)'")
i <- 4*(0:10)
## draw rectangles with bottom left (100, 300)+i
## and top right (150, 380)+i
rect(100+i, 300+i, 150+i, 380+i, col=rainbow(11, start=.7,end=.1))
rect(240-i, 320+i, 250-i, 410+i, col=heat.colors(11), lwd=i/5)
## Background alternating  ( transparent / "bg" ) :
j <- 10*(0:5)
rect(125+j, 360+j,   141+j, 405+j/2, col = c(NA,0),
     border = "gold", lwd = 2)
rect(125+j, 296+j/2, 141+j, 331+j/5, col = c(NA,"midnightblue"))
mtext("+  2 x 6 rect(*, col = c(NA,0)) and  col = c(NA,\"m..blue\"))")

## an example showing colouring and shading
plot(c(100, 200), c(300, 450), type= "n", xlab="", ylab="")
rect(100, 300, 125, 350) # transparent
rect(100, 400, 125, 450, col="green", border="blue") # coloured
rect(115, 375, 150, 425, col=par("bg"), border="transparent")
rect(150, 300, 175, 350, density=10, border="red")
rect(150, 400, 175, 450, density=30, col="blue",
     angle=-30, border="transparent")

legend(180, 450, legend=1:4, fill=c(NA, "green", par("fg"), "blue"),
       density=c(NA, NA, 10, 30), angle=c(NA, NA, 30, -30))

par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{rug}{Add a Rug to a Plot}{rug}
\keyword{aplot}{rug}
%
\begin{Description}\relax
Adds a \emph{rug} representation (1-d plot) of the data to the plot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rug(x, ticksize = 0.03, side = 1, lwd = 0.5, col = par("fg"),
    quiet = getOption("warn") < 0, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] A numeric vector
\item[\code{ticksize}] The length of the ticks making up the `rug'.
Positive lengths give inwards ticks.
\item[\code{side}] On which side of the plot box the rug will be
plotted. Normally 1 (bottom) or 3 (top).
\item[\code{lwd}] The line width of the ticks.  Some devices will round the
default width up to \code{1}.
\item[\code{col}] The colour the ticks are plotted in.
\item[\code{quiet}] logical indicating if there should be a warning about
clipped values.
\item[\code{...}] further arguments, passed to \code{\LinkA{axis}{axis}}, such
as \code{line} or \code{pos} for specifying the location of the rug.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Because of the way \code{rug} is implemented, only values of \code{x}
that fall within the plot region are included.  There will be a
warning if any finite values are omitted, but non-finite values are
omitted silently.
\end{Details}
%
\begin{References}\relax
Chambers, J. M. and Hastie, T. J. (1992)
\emph{Statistical Models in S.}
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{jitter}{jitter}} which you may want for ties in \code{x}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)# both 'density' and its default method
with(faithful, {
    plot(density(eruptions, bw = 0.15))
    rug(eruptions)
    rug(jitter(eruptions, amount = 0.01), side = 3, col = "light blue")
})
\end{ExampleCode}
\end{Examples}
\HeaderA{screen}{Creating and Controlling Multiple Screens on a Single Device}{screen}
\aliasA{close.screen}{screen}{close.screen}
\aliasA{erase.screen}{screen}{erase.screen}
\aliasA{split.screen}{screen}{split.screen}
\keyword{aplot}{screen}
\keyword{dplot}{screen}
\keyword{device}{screen}
%
\begin{Description}\relax
\code{split.screen} defines a number of regions within the current
device which can, to some extent, be treated as separate graphics
devices.  It is useful for generating multiple plots on a single
device.  Screens can themselves be split, allowing for quite complex
arrangements of plots.

\code{screen} is used to select which screen to draw in.

\code{erase.screen} is used to clear a single screen, which it
does by filling with the background colour.

\code{close.screen} removes the specified screen definition(s).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
split.screen(figs, screen, erase = TRUE)
screen(n = , new = TRUE)
erase.screen(n = )
close.screen(n, all.screens = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{figs}] A two-element vector describing the number of rows and the
number of columns in a screen matrix \emph{or} a matrix with 4 columns.
If a matrix, then each row describes a screen with values for the left,
right, bottom, and top of the screen (in that order) in NDC units,
that is 0 at the lower left corner of the device surface, and 1 at
the upper right corner.
\item[\code{screen}] A number giving the screen to be split.  It defaults to
the current screen if there is one, otherwise the whole device region.
\item[\code{erase}] logical: should be selected screen be cleared?
\item[\code{n}] A number indicating which screen to prepare for drawing
(\code{screen}), erase (\code{erase.screen}), or close
(\code{close.screen}).  (\code{close.screen} will accept a vector of
screen numbers.)
\item[\code{new}] A logical value indicating whether the screen should be
erased as part of the preparation for drawing in the screen.
\item[\code{all.screens}] A logical value indicating whether all of the
screens should be closed.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The first call to \code{split.screen} places \R{} into split-screen
mode.  The other split-screen functions only work within this mode.
While in this mode, certain other commands should be avoided (see the
Warnings section below).  Split-screen mode is exited by the command
\code{close.screen(all = TRUE)}.

If the current screen is closed, \code{close.screen} sets the current
screen to be the next larger screen number if there is one, otherwise
to the first available screen.
\end{Details}
%
\begin{Value}
\code{split.screen} returns a vector of screen numbers for the
newly-created screens.  With no arguments, \code{split.screen} returns
a vector of valid screen numbers.

\code{screen} invisibly returns the number of the selected screen.
With no arguments, \code{screen} returns the number of the current
screen.

\code{close.screen} returns a vector of valid screen numbers.

\code{screen}, \code{erase.screen}, and \code{close.screen} all return
\code{FALSE} if \R{} is not in split-screen mode.
\end{Value}
%
\begin{Section}{Warnings}
The recommended way to use these functions is to completely draw a
plot and all additions (i.e. points and lines) to the base plot, prior to
selecting and plotting on another screen. The behavior associated with
returning to a screen to add to an existing plot is unpredictable and
may result in problems that are not readily visible.

These functions are totally incompatible with the other mechanisms for
arranging plots on a device: \code{\LinkA{par}{par}(mfrow)},
\code{par(mfcol)} and \code{\LinkA{layout}{layout}()}.

The functions are also incompatible with some plotting functions,
such as \code{\LinkA{coplot}{coplot}}, which make use of these other mechanisms.

\code{erase.screen} will appear not to work if the background colour
is transparent (as it is by default on most devices).
\end{Section}
%
\begin{References}\relax
Chambers, J. M. and Hastie, T. J. (1992)
\emph{Statistical Models in S}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{par}{par}}, \code{\LinkA{layout}{layout}}, \code{\LinkA{Devices}{Devices}},
\code{dev.*}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
if (interactive()) {
par(bg = "white")           # default is likely to be transparent
split.screen(c(2,1))        # split display into two screens
split.screen(c(1,3), screen = 2) # now split the bottom half into 3
screen(1) # prepare screen 1 for output
plot(10:1)
screen(4) # prepare screen 4 for output
plot(10:1)
close.screen(all = TRUE)    # exit split-screen mode

split.screen(c(2,1))        # split display into two screens
split.screen(c(1,2),2)      # split bottom half in two
plot(1:10)                  # screen 3 is active, draw plot
erase.screen()              # forgot label, erase and redraw
plot(1:10, ylab= "ylab 3")
screen(1)                   # prepare screen 1 for output
plot(1:10)
screen(4)                   # prepare screen 4 for output
plot(1:10, ylab="ylab 4")
screen(1, FALSE)            # return to screen 1, but do not clear
plot(10:1, axes=FALSE, lty=2, ylab="")  # overlay second plot
axis(4)                     # add tic marks to right-hand axis
title("Plot 1")
close.screen(all = TRUE)    # exit split-screen mode
}
\end{ExampleCode}
\end{Examples}
\HeaderA{segments}{Add Line Segments to a Plot}{segments}
\keyword{aplot}{segments}
%
\begin{Description}\relax
Draw line segments between pairs of points.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
segments(x0, y0, x1 = x0, y1 = y0,
         col = par("fg"), lty = par("lty"), lwd = par("lwd"),
         ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x0, y0}] coordinates of points \bold{from} which to draw.
\item[\code{x1, y1}] coordinates of points \bold{to} which to draw.  At least
one must be supplied.
\item[\code{col, lty, lwd}] \LinkA{graphical parameters}{graphical parameters} as in
\code{\LinkA{par}{par}}, possibly vectors.  \code{NA} values in \code{col}
cause the segment to be omitted.
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters} (from \code{\LinkA{par}{par}}),
such as \code{xpd} and the line characteristics \code{lend}, \code{ljoin}
and \code{lmitre}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For each \code{i}, a line segment is drawn between the point
\code{(x0[i], y0[i])} and the point \code{(x1[i], y1[i])}.  The
coordinate vectors will be recycled to the length of the longest.

The \LinkA{graphical parameters}{graphical parameters} \code{col}, \code{lty} and \code{lwd} can be
vectors of length greater than one and will be recycled if necessary.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{arrows}{arrows}}, 
\code{\LinkA{polygon}{polygon}} for slightly easier and less flexible line
drawing, and
\code{\LinkA{lines}{lines}} for the usual polygons.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- stats::runif(12); y <- stats::rnorm(12)
i <- order(x,y); x <- x[i]; y <- y[i]
plot(x, y, main="arrows(.) and segments(.)")
## draw arrows from point to point :
s <- seq(length(x)-1)# one shorter than data
arrows(x[s], y[s], x[s+1], y[s+1], col= 1:3)
s <- s[-length(s)]
segments(x[s], y[s], x[s+2], y[s+2], col= 'pink')
\end{ExampleCode}
\end{Examples}
\HeaderA{smoothScatter}{Scatterplots with Smoothed Densities Color Representation}{smoothScatter}
\keyword{hplot}{smoothScatter}
%
\begin{Description}\relax
\code{smoothScatter} produces a smoothed color density
representation of the scatterplot, obtained through a kernel
density estimate. \code{densCols} produces a vector containing
colors which encode the local densities at each point in a
scatterplot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
smoothScatter(x, y = NULL, nbin = 128, bandwidth,
              colramp = colorRampPalette(c("white", blues9)),
              nrpoints = 100, pch = ".", cex = 1, col = "black",
              transformation = function(x) x^.25,
              postPlotHook = box,
              xlab = NULL, ylab = NULL, xlim, ylim,
              xaxs = par("xaxs"), yaxs = par("yaxs"), ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the \code{x} and \code{y} arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function \code{\LinkA{xy.coords}{xy.coords}}
for details.  If supplied separately, they must be of the same length.
\item[\code{nbin}] numeric vector of length one (for both directions) or two
(for x and y separately) specifying the number of equally spaced
grid points for the density estimation; directly used as
\code{gridsize} in \code{\LinkA{bkde2D}{bkde2D}()}.
\item[\code{bandwidth}] numeric vector (length 1 or 2) of smoothing bandwidth(s).
If missing, a more or less useful default is used. \code{bandwidth}
is subsequently passed to function
\code{\LinkA{bkde2D}{bkde2D}}.
\item[\code{colramp}] function accepting an integer \code{n} as an argument and
returning \code{n} colors.
\item[\code{nrpoints}] number of points to be superimposed on the density
image.  The first \code{nrpoints} points from those areas of lowest
regional densities will be plotted.  Adding points to the plot
allows for the identification of outliers.  If all points are to be
plotted, choose \code{nrpoints = Inf}.
\item[\code{pch, cex, col}] arguments passed to \code{\LinkA{points}{points}},
when \code{nrpoints > 0}: point symbol, character expansion factor
and color, see also \code{\LinkA{par}{par}}.
\item[\code{transformation}] function mapping the density scale to the color scale.
\item[\code{postPlotHook}] either \code{NULL} or a function which will be
called (with no arguments) after \code{\LinkA{image}{image}}.
\item[\code{xlab, ylab}] character strings to be used as axis labels, passed
to \code{\LinkA{image}{image}}.
\item[\code{xlim, ylim}] numeric vectors of length 2 specifying axis limits.
\item[\code{xaxs, yaxs, ...}] further arguments, passed to \code{\LinkA{image}{image}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{smoothScatter} produces a smoothed version of a scatter plot.
Two dimensional (kernel density) smoothing is performed by
\code{\LinkA{bkde2D}{bkde2D}} from package \Rhref{http://CRAN.R-project.org/package=KernSmooth}{\pkg{KernSmooth}}.
See the examples for how to use this function together with
\code{\LinkA{pairs}{pairs}}.
\end{Details}
%
\begin{Author}\relax
Florian Hahne at FHCRC, originally
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{bkde2D}{bkde2D}} from package \Rhref{http://CRAN.R-project.org/package=KernSmooth}{\pkg{KernSmooth}};
\code{\LinkA{densCols}{densCols}} which uses the same smoothing computations and
\code{\LinkA{blues9}{blues9}} in package \pkg{grDevices}.

\code{\LinkA{scatter.smooth}{scatter.smooth}} adds a \code{\LinkA{loess}{loess}}
regression smoother to a scatter plot.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
  ## A largish data set
  n <- 10000
  x1  <- matrix(rnorm(n), ncol=2)
  x2  <- matrix(rnorm(n, mean=3, sd=1.5), ncol=2)
  x   <- rbind(x1,x2)

  oldpar <- par(mfrow=c(2,2))
  smoothScatter(x, nrpoints=0)
  smoothScatter(x)

  ## a different color scheme:
  Lab.palette <-
      colorRampPalette(c("blue", "orange", "red"), space = "Lab")
  smoothScatter(x, colramp = Lab.palette)

  ## somewhat similar, using identical smoothing computations,
  ## but considerably *less* efficient for really large data:
  plot(x, col = densCols(x), pch=20)

  ## use with pairs:
  par(mfrow=c(1,1))
  y <- matrix(rnorm(40000), ncol=4) + 3*rnorm(10000)
  y[, c(2,4)] <-  -y[, c(2,4)]
  pairs(y,
        panel = function(...) smoothScatter(..., nrpoints=0, add=TRUE))

  par(oldpar)
\end{ExampleCode}
\end{Examples}
\HeaderA{spineplot}{Spine Plots and Spinograms}{spineplot}
\methaliasA{spineplot.default}{spineplot}{spineplot.default}
\methaliasA{spineplot.formula}{spineplot}{spineplot.formula}
\keyword{hplot}{spineplot}
%
\begin{Description}\relax
Spine plots are a special cases of mosaic plots, and can be seen as
a generalization of stacked (or highlighted) bar plots. Analogously,
spinograms are an extension of histograms.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
spineplot(x, ...)

## Default S3 method:
spineplot(x, y = NULL,
          breaks = NULL, tol.ylab = 0.05, off = NULL,
          ylevels = NULL, col = NULL,
          main = "", xlab = NULL, ylab = NULL,
          xaxlabels = NULL, yaxlabels = NULL,
          xlim = NULL, ylim = c(0, 1), axes = TRUE, ...)

## S3 method for class 'formula'
spineplot(formula, data = NULL,
          breaks = NULL, tol.ylab = 0.05, off = NULL,
          ylevels = NULL, col = NULL,
          main = "", xlab = NULL, ylab = NULL,
          xaxlabels = NULL, yaxlabels = NULL,
          xlim = NULL, ylim = c(0, 1), axes = TRUE, ...,
          subset = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an object, the default method expects either a single variable
(interpreted to be the explanatory variable) or a 2-way table.  See
details.
\item[\code{y}] a \code{"factor"} interpreted to be the dependent variable
\item[\code{formula}] a \code{"formula"} of type \code{y \textasciitilde{} x} with a single
dependent \code{"factor"} and a single explanatory variable.   
\item[\code{data}] an optional data frame.
\item[\code{breaks}] if the explanatory variable is numeric, this controls how
it is discretized. \code{breaks} is passed to \code{\LinkA{hist}{hist}} and can
be a list of arguments.
\item[\code{tol.ylab}] convenience tolerance parameter for y-axis annotation.
If the distance between two labels drops under this threshold, they are
plotted equidistantly.
\item[\code{off}] vertical offset between the bars (in per cent). It is fixed to
\code{0} for spinograms and defaults to \code{2} for spine plots.
\item[\code{ylevels}] a character or numeric vector specifying in which order
the levels of the dependent variable should be plotted.
\item[\code{col}] a vector of fill colors of the same length as \code{levels(y)}.
The default is to call \code{\LinkA{gray.colors}{gray.colors}}. 
\item[\code{main, xlab, ylab}] character strings for annotation
\item[\code{xaxlabels, yaxlabels}] character vectors for annotation of x and y axis.
Default to \code{levels(y)} and \code{levels(x)}, respectively for the
spine plot. For \code{xaxlabels} in the spinogram, the breaks are
used.
\item[\code{xlim, ylim}] the range of x and y values with sensible defaults. 
\item[\code{axes}] logical.  If \code{FALSE} all axes (including those giving
level names) are suppressed.
\item[\code{...}] additional arguments passed to \code{\LinkA{rect}{rect}}.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used for plotting.  
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{spineplot} creates either a spinogram or a spine plot.  It can
be called via \code{spineplot(x, y)} or \code{spineplot(y \textasciitilde{} x)} where
\code{y} is interpreted to be the dependent variable (and has to be
categorical) and \code{x} the explanatory variable.  \code{x} can be
either categorical (then a spine plot is created) or numerical (then a
spinogram is plotted).  Additionally, \code{spineplot} can also be
called with only a single argument which then has to be a 2-way table,
interpreted to correspond to \code{table(x, y)}.

Both, spine plots and spinograms, are essentially mosaic plots with
special formatting of spacing and shading.  Conceptually, they plot
\eqn{P(y | x)}{} against \eqn{P(x)}{}.  For the spine plot (where both
\eqn{x}{} and \eqn{y}{} are categorical), both quantities are approximated
by the corresponding empirical relative frequencies.  For the
spinogram (where \eqn{x}{} is numerical), \eqn{x}{} is first discretized
(by calling \code{\LinkA{hist}{hist}} with \code{breaks} argument) and then
empirical relative frequencies are taken.

Thus, spine plots can also be seen as a generalization of stacked bar
plots where not the heights but the widths of the bars corresponds to
the relative frequencies of \code{x}. The heights of the bars then
correspond to the conditional relative frequencies of \code{y} in
every \code{x} group. Analogously, spinograms extend stacked
histograms.
\end{Details}
%
\begin{Value}
The table visualized is returned invisibly.
\end{Value}
%
\begin{Author}\relax
Achim Zeileis \email{Achim.Zeileis@R-project.org}
\end{Author}
%
\begin{References}\relax
Friendly, M. (1994), Mosaic displays for multi-way contingency tables.
\emph{Journal of the American Statistical Association}, \bold{89},
190--200.

Hartigan, J.A., and Kleiner, B. (1984), A mosaic of television ratings.
\emph{The American Statistician}, \bold{38}, 32--35.

Hofmann, H., Theus, M. (2005), \emph{Interactive graphics for visualizing
conditional distributions}, Unpublished Manuscript.

Hummel, J. (1996), Linked bar charts: Analysing categorical data graphically.
\emph{Computational Statistics}, \bold{11}, 23--33.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{mosaicplot}{mosaicplot}}, \code{\LinkA{hist}{hist}}, \code{\LinkA{cdplot}{cdplot}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## treatment and improvement of patients with rheumatoid arthritis
treatment <- factor(rep(c(1, 2), c(43, 41)), levels = c(1, 2),
                    labels = c("placebo", "treated"))
improved <- factor(rep(c(1, 2, 3, 1, 2, 3), c(29, 7, 7, 13, 7, 21)),
                   levels = c(1, 2, 3),
                   labels = c("none", "some", "marked"))

## (dependence on a categorical variable)
(spineplot(improved ~ treatment))

## applications and admissions by department at UC Berkeley
## (two-way tables)
(spineplot(margin.table(UCBAdmissions, c(3, 2)),
           main = "Applications at UCB"))
(spineplot(margin.table(UCBAdmissions, c(3, 1)),
           main = "Admissions at UCB"))

## NASA space shuttle o-ring failures
fail <- factor(c(2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1,
                 1, 1, 1, 2, 1, 1, 1, 1, 1),
               levels = c(1, 2), labels = c("no", "yes"))
temperature <- c(53, 57, 58, 63, 66, 67, 67, 67, 68, 69, 70, 70,
                 70, 70, 72, 73, 75, 75, 76, 76, 78, 79, 81)

## (dependence on a numerical variable)
(spineplot(fail ~ temperature))
(spineplot(fail ~ temperature, breaks = 3))
(spineplot(fail ~ temperature, breaks = quantile(temperature)))

## highlighting for failures
spineplot(fail ~ temperature, ylevels = 2:1)
\end{ExampleCode}
\end{Examples}
\HeaderA{stars}{Star (Spider/Radar) Plots and Segment Diagrams}{stars}
\keyword{hplot}{stars}
\keyword{multivariate}{stars}
%
\begin{Description}\relax
Draw star plots or segment diagrams of a multivariate data set.
With one single location, also draws `spider'
(or `radar') plots.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
stars(x, full = TRUE, scale = TRUE, radius = TRUE,
      labels = dimnames(x)[[1]], locations = NULL,
      nrow = NULL, ncol = NULL, len = 1,
      key.loc = NULL, key.labels = dimnames(x)[[2]],
      key.xpd = TRUE,
      xlim = NULL, ylim = NULL, flip.labels = NULL,
      draw.segments = FALSE,
      col.segments = 1:n.seg, col.stars = NA, col.lines = NA,
      axes = FALSE, frame.plot = axes,
      main = NULL, sub = NULL, xlab = "", ylab = "",
      cex = 0.8, lwd = 0.25, lty = par("lty"), xpd = FALSE,
      mar = pmin(par("mar"),
                 1.1+ c(2*axes+ (xlab != ""),
                 2*axes+ (ylab != ""), 1,0)),
      add = FALSE, plot = TRUE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] matrix or data frame of data.
One star or segment plot will be produced for each row of \code{x}.
Missing values (\code{NA}) are allowed, but they are treated as if
they were 0 (after scaling, if relevant).
\item[\code{full}] logical flag: if \code{TRUE}, the segment plots will
occupy a full circle.  Otherwise, they occupy the (upper) semicircle
only.
\item[\code{scale}] logical flag: if \code{TRUE}, the columns of the data
matrix are scaled independently so that the maximum value in each
column is 1 and the minimum is 0.  If \code{FALSE}, the presumption
is that the data have been scaled by some other algorithm to the
range \eqn{[0, 1]}{}.
\item[\code{radius}] logical flag: in \code{TRUE}, the radii corresponding to
each variable in the data will be drawn.
\item[\code{labels}] vector of character strings for labeling the plots.
Unlike the S function \code{stars}, no attempt is made to construct
labels if \code{labels = NULL}.
\item[\code{locations}] Either two column matrix with the x and y coordinates used
to place each of the segment plots; or numeric of length 2 when all
plots should be superimposed (for a `spider plot').
By default, \code{locations = NULL}, the segment plots will be
placed in a rectangular grid.
\item[\code{nrow, ncol}] integers giving the number of rows and columns to use when
\code{locations} is \code{NULL}.  By default, \code{nrow == ncol}, a square
layout will be used.
\item[\code{len}] scale factor for the length of radii or segments.
\item[\code{key.loc}] vector with x and y coordinates of the unit key.
\item[\code{key.labels}] vector of character strings for labeling the
segments of the unit key.  If omitted, the second component of
\code{dimnames(x)} is used, if available.
\item[\code{key.xpd}] clipping switch for the unit key (drawing and
labeling), see \code{\LinkA{par}{par}("xpd")}.
\item[\code{xlim}] vector with the range of x coordinates to plot. 
\item[\code{ylim}] vector with the range of y coordinates to plot.
\item[\code{flip.labels}] logical indicating if the label locations should
flip up and down from diagram to diagram. Defaults to a somewhat
smart heuristic.
\item[\code{draw.segments}] logical. If \code{TRUE} draw a segment diagram.
\item[\code{col.segments}] color vector (integer or character, see
\code{\LinkA{par}{par}}), each specifying a color for one of the segments
(variables).  Ignored if \code{draw.segments = FALSE}.
\item[\code{col.stars}] color vector (integer or character, see
\code{\LinkA{par}{par}}), each specifying a color for one of the stars
(cases).  Ignored if \code{draw.segments = TRUE}.
\item[\code{col.lines}] color vector (integer or character, see
\code{\LinkA{par}{par}}), each specifying a color for one of the lines
(cases).  Ignored if \code{draw.segments = TRUE}.
\item[\code{axes}] logical flag: if \code{TRUE} axes are added to the plot.
\item[\code{frame.plot}] logical flag: if \code{TRUE}, the plot region is framed.
\item[\code{main}] a main title for the plot.
\item[\code{sub}] a sub title for the plot.
\item[\code{xlab}] a label for the x axis.
\item[\code{ylab}] a label for the y axis.
\item[\code{cex}] character expansion factor for the labels.
\item[\code{lwd}] line width used for drawing.
\item[\code{lty}] line type used for drawing.
\item[\code{xpd}] logical or NA indicating if clipping should be done, see
\code{\LinkA{par}{par}(xpd = .)}.
\item[\code{mar}] argument to \code{\LinkA{par}{par}(mar = *)}, typically choosing
smaller margins than by default.
\item[\code{...}] further arguments, passed to the first call of
\code{plot()}, see \code{\LinkA{plot.default}{plot.default}} and to
\code{\LinkA{box}{box}()} if \code{frame.plot} is true.
\item[\code{add}] logical, if \code{TRUE} \emph{add} stars to current plot.
\item[\code{plot}] logical, if \code{FALSE}, nothing is plotted.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Missing values are treated as 0.

Each star plot or segment diagram represents one row of the input
\code{x}.  Variables (columns) start on the right and wind
counterclockwise around the circle.  The size of the (scaled) column
is shown by the distance from the center to the point on the star or
the radius of the segment representing the variable.

Only one page of output is produced.
\end{Details}
%
\begin{Value}
Returns the locations of the plots in a two column matrix, invisibly
when \code{plot=TRUE}.
\end{Value}
%
\begin{Note}\relax
This code started life as spatial star plots by David A. Andrews.
See \url{http://www.udallas.edu:8080/~andrews/software/software.html}.

Prior to 1.4.1, scaling only shifted the maximum to 1, although
documented as here.
\end{Note}
%
\begin{Author}\relax
Thomas S. Dye
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{symbols}{symbols}} for another way to draw stars and other symbols.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(grDevices)
stars(mtcars[, 1:7], key.loc = c(14, 2),
      main = "Motor Trend Cars : stars(*, full = F)", full = FALSE)
stars(mtcars[, 1:7], key.loc = c(14, 1.5),
      main = "Motor Trend Cars : full stars()",flip.labels=FALSE)

## 'Spider' or 'Radar' plot:
stars(mtcars[, 1:7], locations = c(0,0), radius = FALSE,
      key.loc=c(0,0), main="Motor Trend Cars", lty = 2)

## Segment Diagrams:
palette(rainbow(12, s = 0.6, v = 0.75))
stars(mtcars[, 1:7], len = 0.8, key.loc = c(12, 1.5),
      main = "Motor Trend Cars", draw.segments = TRUE)
stars(mtcars[, 1:7], len = 0.6, key.loc = c(1.5, 0),
      main = "Motor Trend Cars", draw.segments = TRUE,
      frame.plot=TRUE, nrow = 4, cex = .7)

## scale linearly (not affinely) to [0, 1]
USJudge <- apply(USJudgeRatings, 2, function(x) x/max(x))
Jnam <- row.names(USJudgeRatings)
Snam <- abbreviate(substring(Jnam,1,regexpr("[,.]",Jnam) - 1), 7)
stars(USJudge, labels = Jnam, scale = FALSE,
      key.loc = c(13, 1.5), main = "Judge not ...", len = 0.8)
stars(USJudge, labels = Snam, scale = FALSE,
      key.loc = c(13, 1.5), radius = FALSE)

loc <- stars(USJudge, labels = NULL, scale = FALSE,
             radius = FALSE, frame.plot = TRUE,
             key.loc = c(13, 1.5), main = "Judge not ...", len = 1.2)
text(loc, Snam, col = "blue", cex = 0.8, xpd = TRUE)

## 'Segments':
stars(USJudge, draw.segments = TRUE, scale = FALSE, key.loc = c(13,1.5))

## 'Spider':
stars(USJudgeRatings, locations=c(0,0), scale=FALSE,radius = FALSE,
      col.stars=1:10, key.loc = c(0,0), main="US Judges rated")
## Same as above, but with colored lines instead of filled polygons.
stars(USJudgeRatings, locations=c(0,0), scale=FALSE,radius = FALSE,
      col.lines=1:10, key.loc = c(0,0), main="US Judges rated")
## 'Radar-Segments'
stars(USJudgeRatings[1:10,], locations = 0:1, scale=FALSE,
      draw.segments = TRUE, col.segments=0, col.stars=1:10,key.loc= 0:1,
       main="US Judges 1-10 ")
palette("default")
stars(cbind(1:16,10*(16:1)),draw.segments=TRUE,
      main = "A Joke -- do *not* use symbols on 2D data!")
\end{ExampleCode}
\end{Examples}
\HeaderA{stem}{Stem-and-Leaf Plots}{stem}
\keyword{univar}{stem}
\keyword{distribution}{stem}
%
\begin{Description}\relax
\code{stem} produces a stem-and-leaf plot of the values in \code{x}.
The parameter \code{scale} can be used to expand the scale of the
plot.  A value of \code{scale=2} will cause the plot to be roughly
twice as long as the default.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
stem(x, scale = 1, width = 80, atom = 1e-08)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a numeric vector.
\item[\code{scale}] This controls the plot length.
\item[\code{width}] The desired width of plot.
\item[\code{atom}] a tolerance.
\end{ldescription}
\end{Arguments}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{Examples}
\begin{ExampleCode}
stem(islands)
stem(log10(islands))
\end{ExampleCode}
\end{Examples}
\HeaderA{stripchart}{1-D Scatter Plots}{stripchart}
\methaliasA{stripchart.default}{stripchart}{stripchart.default}
\methaliasA{stripchart.formula}{stripchart}{stripchart.formula}
\keyword{hplot}{stripchart}
%
\begin{Description}\relax
\code{stripchart} produces one dimensional scatter plots (or dot
plots) of the given data.  These plots are a good alternative to
\code{\LinkA{boxplot}{boxplot}}s when sample sizes are small.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
stripchart(x, ...)

## S3 method for class 'formula'
stripchart(x, data = NULL, dlab = NULL, ...,
           subset, na.action = NULL)


## Default S3 method:
stripchart(x, method = "overplot", jitter = 0.1, offset = 1/3,
           vertical = FALSE, group.names, add = FALSE,
           at = NULL, xlim = NULL, ylim = NULL,
           ylab=NULL, xlab=NULL, dlab="", glab="",
           log = "", pch = 0, col = par("fg"), cex = par("cex"), 
           axes = TRUE, frame.plot = axes, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] the data from which the plots are to be produced.  In the
default method the data can be specified as a single numeric
vector, or as list of numeric vectors, each corresponding to
a component plot.  In the \code{formula} method, a symbolic
specification of the form \code{y \textasciitilde{} g} can be given,
indicating the observations in the vector \code{y} are to be
grouped according to the levels of the factor
\code{g}.  \code{NA}s are allowed in the data.
\item[\code{data}] a data.frame (or list) from which the variables in
\code{x} should be taken.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used for plotting.
\item[\code{na.action}] a function which indicates what should happen
when the data contain \code{NA}s.  The default is to ignore missing
values in either the response or the group.
\item[\code{...}] additional parameters passed to the default method, or by
it to \code{plot}, \code{points}, \code{axis} and \code{title} to
control the appearance of the plot.
\item[\code{method}] the method to be used to separate coincident points.
The default method \code{"overplot"} causes such points to be
overplotted, but it is also possible to specify \code{"jitter"} to
jitter the points, or \code{"stack"} have coincident points
stacked.  The last method only makes sense for very granular data.
\item[\code{jitter}] when \code{method="jitter"} is used, \code{jitter}
gives the amount of jittering applied.
\item[\code{offset}] when stacking is used, points are stacked this many
line-heights (symbol widths) apart.
\item[\code{vertical}] when vertical is \code{TRUE} the plots are drawn
vertically rather than the default horizontal.
\item[\code{group.names}] group labels which will be printed alongside
(or underneath) each plot.
\item[\code{add}] logical, if true \emph{add} the chart to the current plot.
\item[\code{at}] numeric vector giving the locations where the charts should
be drawn, particularly when \code{add = TRUE};
defaults to \code{1:n} where \code{n} is the number of boxes.
\item[\code{ylab, xlab}] labels: see \code{\LinkA{title}{title}}.
\item[\code{dlab, glab}] alternate way to specify axis labels: see `Details'.
\item[\code{xlim, ylim}] plot limits: see \code{\LinkA{plot.window}{plot.window}}.
\item[\code{log}] on which axes to use a log scale:  see 
\code{\LinkA{plot.default}{plot.default}}
\item[\code{pch, col, cex}] Graphical parameters: see \code{\LinkA{par}{par}}.
\item[\code{axes, frame.plot}] Axis control:  see \code{\LinkA{plot.default}{plot.default}}
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Extensive examples of the use of this kind of plot can be found in
Box, Hunter and Hunter or Seber and Wild.

The \code{dlab} and \code{glab} labels may be used instead of \code{xlab}
and \code{ylab} if those are not specified.  \code{dlab} applies to the 
continuous data axis (the X axis unless \code{vertical} is \code{TRUE}),
\code{glab} to the group axis.
\end{Details}
%
\begin{Examples}
\begin{ExampleCode}
x <- stats::rnorm(50)
xr <- round(x, 1)
stripchart(x) ; m <- mean(par("usr")[1:2])
text(m, 1.04, "stripchart(x, \"overplot\")")
stripchart(xr, method = "stack", add = TRUE, at = 1.2)
text(m, 1.35, "stripchart(round(x,1), \"stack\")")
stripchart(xr, method = "jitter", add = TRUE, at = 0.7)
text(m, 0.85, "stripchart(round(x,1), \"jitter\")")

stripchart(decrease ~ treatment,
    main = "stripchart(OrchardSprays)", 
    vertical = TRUE, log = "y", data = OrchardSprays)

stripchart(decrease ~ treatment, at = c(1:8)^2,
    main = "stripchart(OrchardSprays)", 
    vertical = TRUE, log = "y", data = OrchardSprays)
\end{ExampleCode}
\end{Examples}
\HeaderA{strwidth}{Plotting Dimensions of Character Strings and Math Expressions}{strwidth}
\aliasA{strheight}{strwidth}{strheight}
\keyword{dplot}{strwidth}
\keyword{character}{strwidth}
%
\begin{Description}\relax
These functions compute the width or height, respectively, of the
given strings or mathematical expressions \code{s[i]} on
the current plotting device in \emph{user} coordinates, \emph{inches}
or as fraction of the figure width \code{par("fin")}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
strwidth(s, units = "user", cex = NULL, font = NULL, vfont = NULL, ...)
strheight(s, units = "user", cex = NULL, font = NULL, vfont = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{s}] a character or \LinkA{expression}{expression} vector whose dimensions
are to be determined.  Other objects are coerced by
\code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}.
\item[\code{units}] character indicating in which units \code{s} is measured;
should be one of \code{"user"}, \code{"inches"}, \code{"figure"};
partial matching is performed.
\item[\code{cex}] numeric \bold{c}haracter \bold{ex}pansion factor; multiplied
by \code{\LinkA{par}{par}("cex")} yields the final character size; the
default \code{NULL} is equivalent to \code{1}.
\item[\code{font, vfont, ...}] additional information about the font,
possibly including the graphics parameter \code{"family"}:
see \code{\LinkA{text}{text}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Note that the `height' of a string is determined only by the
number of linefeeds (\code{"\bsl{}n"}) it contains: it is the (number of
linefeeds - 1) times the line spacing plus the height of \code{"M"} in
the selected font.  For an expression it is the height of the
bounding box as computed by \LinkA{plotmath}{plotmath}.  Thus in both cases it is
an estimate of how far \bold{above} the final baseline the typeset
object extends.  (It may also extend below the baseline.)  The
inter-line spacing is controlled by \code{cex},
\code{\LinkA{par}{par}("lheight")} and the `point size' (but not the
actual font in use).

Measurements in \code{"user"} units (the default) are only available
after \code{\LinkA{plot.new}{plot.new}} has been called -- otherwise an error is
thrown.
\end{Details}
%
\begin{Value}
Numeric vector with the same length as \code{s}, giving the estimate of
width or height for each \code{s[i]}.  \code{NA} strings are given
width and height 0 (as they are not plotted).
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{text}{text}}, \code{\LinkA{nchar}{nchar}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
str.ex <- c("W","w","I",".","WwI.")
op <- par(pty='s'); plot(1:100,1:100, type="n")
sw <- strwidth(str.ex); sw
all.equal(sum(sw[1:4]), sw[5])
#- since the last string contains the others

sw.i <- strwidth(str.ex, "inches"); 25.4 * sw.i # width in [mm]
unique(sw / sw.i)
# constant factor: 1 value
mean(sw.i / strwidth(str.ex, "fig")) / par('fin')[1] # = 1: are the same

## See how letters fall in classes
##  -- depending on graphics device and font!
all.lett <- c(letters, LETTERS)
shL <- strheight(all.lett, units = "inches") * 72 # 'big points'
table(shL) # all have same heights ...
mean(shL)/par("cin")[2] # around 0.6

(swL <- strwidth(all.lett, units="inches") * 72) # 'big points'
split(all.lett, factor(round(swL, 2)))

sumex <- expression(sum(x[i], i=1,n), e^{i * pi} == -1)
strwidth(sumex)
strheight(sumex)

par(op)#- reset to previous setting
\end{ExampleCode}
\end{Examples}
\HeaderA{sunflowerplot}{Produce a Sunflower Scatter Plot}{sunflowerplot}
\methaliasA{sunflowerplot.default}{sunflowerplot}{sunflowerplot.default}
\methaliasA{sunflowerplot.formula}{sunflowerplot}{sunflowerplot.formula}
\keyword{hplot}{sunflowerplot}
\keyword{smooth}{sunflowerplot}
\keyword{nonparametric}{sunflowerplot}
%
\begin{Description}\relax
Multiple points are plotted as `sunflowers' with multiple leaves
(`petals') such that overplotting is visualized instead of
accidental and invisible.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
sunflowerplot(x, ...)

## Default S3 method:
sunflowerplot(x, y = NULL, number, log = "", digits = 6,
              xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL,
              add = FALSE, rotate = FALSE,
              pch = 16, cex = 0.8, cex.fact = 1.5,
              col = par("col"), bg = NA, size = 1/8, seg.col = 2,
              seg.lwd = 1.5, ...)

## S3 method for class 'formula'
sunflowerplot(formula, data = NULL, xlab = NULL, ylab = NULL, ...,
             subset, na.action = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] numeric vector of \code{x}-coordinates of length \code{n},
say, or another valid plotting structure, as for
\code{\LinkA{plot.default}{plot.default}}, see also \code{\LinkA{xy.coords}{xy.coords}}.
\item[\code{y}] numeric vector of \code{y}-coordinates of length \code{n}.
\item[\code{number}] integer vector of length \code{n}. \code{number[i]} = number
of replicates for \code{(x[i],y[i])}, may be 0.\\{}
Default (\code{missing(number)}): compute the exact multiplicity of
the points \code{x[],y[]}, via
\code{\LinkA{xyTable}{xyTable}()}.
\item[\code{log}] character indicating log coordinate scale, see
\code{\LinkA{plot.default}{plot.default}}.
\item[\code{digits}] when \code{number} is computed (i.e., not specified),
\code{x} and \code{y} are rounded to \code{digits} significant
digits before multiplicities are computed.
\item[\code{xlab,ylab}] character label for x-, or y-axis, respectively.
\item[\code{xlim,ylim}] \code{numeric(2)} limiting the extents of the x-,
or y-axis.
\item[\code{add}] logical; should the plot be added on a previous one ?
Default is \code{FALSE}.
\item[\code{rotate}] logical; if \code{TRUE}, randomly rotate the
sunflowers (preventing artefacts).
\item[\code{pch}] plotting character to be used for points
(\code{number[i]==1}) and center of sunflowers.
\item[\code{cex}] numeric; character size expansion of center points
(s. \code{pch}).
\item[\code{cex.fact}] numeric \emph{shrinking} factor to be used for the
center points \emph{when there are flower leaves},
i.e., \code{cex / cex.fact} is used for these.
\item[\code{col, bg}] colors for the plot symbols, passed to
\code{\LinkA{plot.default}{plot.default}}.
\item[\code{size}] of sunflower leaves in inches, 1[in] := 2.54[cm].
Default: 1/8\bsl{}", approximately 3.2mm.
\item[\code{seg.col}] color to be used for the \bold{seg}ments which make the
sunflowers leaves, see \code{\LinkA{par}{par}(col=)};
\code{col = "gold"} reminds of real sunflowers.
\item[\code{seg.lwd}] numeric; the line width for the leaves' segments.
\item[\code{...}] further arguments to \code{\LinkA{plot}{plot}} [if
\code{add = FALSE}], or to be passed to or from another method.
\item[\code{formula}] a \code{\LinkA{formula}{formula}}, such as \code{y \textasciitilde{} x}.
\item[\code{data}] a data.frame (or list) from which the variables in
\code{formula} should be taken.
\item[\code{subset}] an optional vector specifying a subset of observations
to be used in the fitting process.
\item[\code{na.action}] a function which indicates what should happen
when the data contain \code{NA}s.  The default is to ignore case
with missing values.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This is a generic function with default and formula methods.

For \code{number[i] == 1}, a (slightly enlarged) usual plotting symbol
(\code{pch}) is drawn.  For \code{number[i] > 1}, a small plotting
symbol is drawn and \code{number[i]} equi-angular `rays'
emanate from it.

If \code{rotate = TRUE} and \code{number[i] >= 2}, a random direction
is chosen (instead of the y-axis) for the first ray.  The goal is to
\code{\LinkA{jitter}{jitter}} the orientations of the sunflowers in order to
prevent artefactual visual impressions.
\end{Details}
%
\begin{Value}
A list with three components of same length,
\begin{ldescription}
\item[\code{x}] x coordinates
\item[\code{y}] y coordinates
\item[\code{number}] number

\end{ldescription}
Use \code{\LinkA{xyTable}{xyTable}()} (from package
\pkg{grDevices}) if you are only interested in this return value.
\end{Value}
%
\begin{Section}{Side Effects}
A scatter plot is drawn with `sunflowers' as symbols.
\end{Section}
%
\begin{Author}\relax
Andreas Ruckstuhl, Werner Stahel, Martin Maechler, Tim Hesterberg,
1989--1993.  Port to \R{} by Martin Maechler
\email{maechler@stat.math.ethz.ch}.
\end{Author}
%
\begin{References}\relax
Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983)
\emph{Graphical Methods for Data Analysis.}  Wadsworth.

Schilling, M. F. and Watkins, A. E. (1994)
A suggestion for sunflower plots.
\emph{The American Statistician}, \bold{48}, 303--305.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{density}{density}}, \code{\LinkA{xyTable}{xyTable}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
require(grDevices)

## 'number' is computed automatically:
sunflowerplot(iris[, 3:4])
## Imitating  Chambers et al., p.109, closely:
sunflowerplot(iris[, 3:4], cex=.2, cex.fact=1, size=.035, seg.lwd=.8)
## or
sunflowerplot(Petal.Width ~ Petal.Length, data=iris,
              cex=.2, cex.fact=1, size=.035, seg.lwd=.8)


sunflowerplot(x=sort(2*round(rnorm(100))), y= round(rnorm(100),0),
              main = "Sunflower Plot of Rounded N(0,1)")
## Similarly using a "xyTable" argument:
xyT <- xyTable(x=sort(2*round(rnorm(100))), y= round(rnorm(100),0),
               digits=3)
utils::str(xyT, vec.len=20)
sunflowerplot(xyT, main = "2nd Sunflower Plot of Rounded N(0,1)")

## A 'marked point process' {explicit 'number' argument}:
sunflowerplot(rnorm(100), rnorm(100), number = rpois(n=100,lambda=2),
              main="Sunflower plot (marked point process)",
              rotate=TRUE, col = "blue4")
\end{ExampleCode}
\end{Examples}
\HeaderA{symbols}{Draw Symbols (Circles, Squares, Stars, Thermometers, Boxplots)}{symbols}
\keyword{aplot}{symbols}
\keyword{hplot}{symbols}
\keyword{multivariate}{symbols}
%
\begin{Description}\relax
This function draws symbols on a plot.  One of six symbols;
\emph{circles}, \emph{squares}, \emph{rectangles}, \emph{stars},
\emph{thermometers}, and \emph{boxplots}, can be plotted at a
specified set of x and y coordinates.  Specific aspects of the
symbols, such as relative size, can be customized by additional
parameters.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
symbols(x, y = NULL, circles, squares, rectangles, stars,
        thermometers, boxplots, inches = TRUE, add = FALSE,
        fg = par("col"), bg = NA,
        xlab = NULL, ylab = NULL, main = NULL,
        xlim = NULL, ylim = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the x and y co-ordinates for the centres of the symbols.
They can be specified in any way which is accepted by
\code{\LinkA{xy.coords}{xy.coords}}.
\item[\code{circles}] a vector giving the radii of the circles.
\item[\code{squares}] a vector giving the length of the sides of the squares.
\item[\code{rectangles}] a matrix with two columns.  The first column gives
widths and the second the heights of rectangles.
\item[\code{stars}] a matrix with three or more columns giving the lengths
of the rays from the center of the stars.  \code{NA} values
are replaced by zeroes.
\item[\code{thermometers}] a matrix with three or four columns.  The first
two columns give the width and height of the thermometer symbols. If
there are three columns, the third is taken as a proportion: the
thermometers are filled (using colour \code{fg}) from their base to
this proportion of their height.  If there are four columns, the
third and fourth columns are taken as proportions and the
thermometers are filled between these two proportions of their
heights.  The part of the box not filled in \code{fg} will be filled
in the background colour (default transparent) given by \code{bg}.
\item[\code{boxplots}] a matrix with five columns.  The first two columns
give the width and height of the boxes, the next two columns
give the lengths of the lower and upper whiskers and the fifth
the proportion (with a warning if not in [0,1]) of the way up
the box that the median line is drawn.
\item[\code{inches}] \code{TRUE}, \code{FALSE} or a positive number.
See `Details'.
\item[\code{add}] if \code{add} is \code{TRUE}, the symbols are added to
an existing plot, otherwise a new plot is created.
\item[\code{fg}] colour(s) the symbols are to be drawn in.
\item[\code{bg}] if specified, the symbols are filled with colour(s), the
vector \code{bg} being recycled to the number of symbols.
The default is to leave the symbols unfilled.
\item[\code{xlab}] the x label of the plot if \code{add} is not true.
Defaults to the \code{\LinkA{deparse}{deparse}}d expression used for \code{x}.
\item[\code{ylab}] the y label of the plot.  Unused if \code{add = TRUE}.
\item[\code{main}] a main title for the plot.  Unused if \code{add = TRUE}.
\item[\code{xlim}] numeric vector of length 2 giving the x limits for the
plot.  Unused if \code{add = TRUE}.
\item[\code{ylim}] numeric vector of length 2 giving the y limits for the
plot.  Unused if \code{add = TRUE}.
\item[\code{...}] graphics parameters can also be passed to this function,
as can the plot aspect ratio \code{asp} (see \code{\LinkA{plot.window}{plot.window}}).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Observations which have missing coordinates or missing size
parameters are not plotted.  The exception to this is \emph{stars}.
In that case, the length of any ray which is \code{NA} is reset
to zero.

Argument \code{inches} controls the sizes of the symbols.  If
\code{TRUE} (the default), the symbols are scaled so that the
largest dimension of any symbol is one inch.  If a positive number is
given the symbols are scaled to make largest dimension this size in
inches (so \code{TRUE} and \code{1} are equivalent).  If \code{inches}
is \code{FALSE}, the units are taken to be those of the appropriate
axes.  (For circles, squares and stars the units of the x axis are
used.  For boxplots, the lengths of the whiskers are regarded as
dimensions alongside width and height when scaling by \code{inches},
and are otherwise interpreted in the units of the y axis.)


Circles of radius zero are plotted at radius one pixel (which is
device-dependent).  Circles of a very small non-zero radius may or may
not be visible, and may be smaller than circles of radius zero.  On
\code{windows} devices circles are plotted at radius at least one
pixel as some Windows versions omit smaller circles.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

W. S. Cleveland (1985)
\emph{The Elements of Graphing Data.}
Monterey, California: Wadsworth.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{stars}{stars}} for drawing \emph{stars} with a bit more
flexibility.

If you are thinking about doing `bubble plots' by
\code{symbols(*, circles=*)}, you should \emph{really} consider using
\code{\LinkA{sunflowerplot}{sunflowerplot}} instead.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats); require(grDevices)
x <- 1:10
y <- sort(10*runif(10))
z <- runif(10)
z3 <- cbind(z, 2*runif(10), runif(10))
symbols(x, y, thermometers = cbind(.5, 1, z), inches = .5, fg = 1:10)
symbols(x, y, thermometers = z3, inches = FALSE)
text(x,y, apply(format(round(z3, digits=2)), 1, paste, collapse = ","),
     adj = c(-.2,0), cex = .75, col = "purple", xpd = NA)

## Note that  example(trees)  shows more sensible plots!
N <- nrow(trees)
with(trees, {
## Girth is diameter in inches
symbols(Height, Volume, circles = Girth/24, inches = FALSE,
        main = "Trees' Girth") # xlab and ylab automatically
## Colours too:
op <- palette(rainbow(N, end = 0.9))
symbols(Height, Volume, circles = Girth/16, inches = FALSE, bg = 1:N,
        fg = "gray30", main = "symbols(*, circles = Girth/16, bg = 1:N)")
palette(op)
})
\end{ExampleCode}
\end{Examples}
\HeaderA{text}{Add Text to a Plot}{text}
\methaliasA{text.default}{text}{text.default}
\keyword{aplot}{text}
%
\begin{Description}\relax
\code{text} draws the strings given in the vector \code{labels} at the
coordinates given by \code{x} and \code{y}.
\code{y} may be missing since \code{\LinkA{xy.coords}{xy.coords}(x,y)} is used for
construction of the coordinates.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
text(x, ...)

## Default S3 method:
 text(x, y = NULL, labels = seq_along(x), adj = NULL,
     pos = NULL, offset = 0.5, vfont = NULL,
     cex = 1, col = NULL, font = NULL, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] numeric vectors of coordinates where the text
\code{labels} should be written.  If the length of \code{x} and
\code{y} differs, the shorter one is recycled.
\item[\code{labels}] a character vector or \LinkA{expression}{expression} specifying
the \emph{text} to be written.  An attempt is made to coerce other
language objects (names and calls) to expressions, and vectors and
other classed objects to character vectors by \code{\LinkA{as.character}{as.character}}.
If \code{labels} is longer than \code{x} and
\code{y}, the coordinates are recycled to the length of \code{labels}.
\item[\code{adj}] one or two values in \eqn{[0, 1]}{} which specify the x
(and optionally y) adjustment of the labels.  On most devices values
outside that interval will also work.
\item[\code{pos}] a position specifier for the text.  If specified this
overrides any \code{adj} value given.  Values of \code{1},
\code{2}, \code{3} and \code{4}, respectively indicate
positions below, to the left of, above and to the right of
the specified coordinates.
\item[\code{offset}] when \code{pos} is specified, this value gives the
offset of the label from the specified coordinate in fractions
of a character width.
\item[\code{vfont}] \code{NULL} for the current font family, or a character
vector of length 2 for Hershey vector fonts.  The first element of
the vector selects a typeface and the second element selects a
style.  Ignored if \code{labels} is an expression.
\item[\code{cex}] numeric \bold{c}haracter \bold{ex}pansion factor; multiplied
by \code{\LinkA{par}{par}("cex")} yields the final character size.
\code{NULL} and \code{NA} are equivalent to \code{1.0}.
\item[\code{col, font}] the color and (if \code{vfont = NULL}) font to be
used, possibly vectors.  These default to the values of the global
\LinkA{graphical parameters}{graphical parameters} in \code{\LinkA{par}{par}()}.
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters} (from \code{\LinkA{par}{par}}),
such as \code{srt}, \code{family} and \code{xpd}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{labels} must be of type \code{\LinkA{character}{character}} or
\code{\LinkA{expression}{expression}} (or be coercible to such a type).
In the latter case, quite a bit of
mathematical notation is available such as sub- and superscripts,
greek letters, fractions, etc.

\code{adj} allows \emph{adj}ustment of the text with respect to \code{(x,y)}.
Values of 0, 0.5, and 1 specify left/bottom, middle and
right/top alignment, respectively.  The default is for centered text, i.e.,
\code{adj = c(0.5, NA)}.  Accurate vertical centering needs
character metric information on individual characters which is
only available on some devices.  Vertical alignment is done slightly
differently for character strings and for expressions:
\code{adj=c(0,0)} means to left-justify and to align on the baseline
for strings but on the bottom of the bounding box for expressions.
This also affects vertical centering: for strings the centering
excludes any descenders whereas for expressions it includes them.
Using \code{NA} for strings centers them, including descenders.

The \code{pos} and \code{offset} arguments can be used in conjunction
with values returned by \code{identify} to recreate an interactively
labelled plot.

Text can be rotated by using \LinkA{graphical parameters}{graphical parameters} \code{srt}
(see \code{\LinkA{par}{par}}); this rotates about the centre set by
\code{adj}.

Graphical parameters \code{col}, \code{cex} and \code{font} can be
vectors and will then be applied cyclically to the \code{labels} (and
extra values will be ignored).  \code{NA} values of \code{font} are
replaced by \code{par("font")}, and similarly for \code{col}.

Labels whose \code{x}, \code{y} or \code{labels} value is \code{NA}
are omitted from the plot.

What happens when \code{font = 5} (the symbol font) is selected can be
both device- and locale-dependent.  Most often \code{labels} will be
interpreted in the Adobe symbol encoding, so e.g. \code{"d"} is delta,
and \code{"\bsl{}300"} is aleph.
\end{Details}
%
\begin{Section}{Euro symbol}
The Euro symbol was introduced relatively recently and may not be
available in older fonts.  In recent versions of Adobe symbol fonts it
is character 160, so \code{text(x, y, "\bsl{}xA0", font = 5)} may work.
People using Western European locales on Unix-alikes can probably
select ISO-8895-15 (Latin-9) which has the Euro as character 165: this
can also be used for \code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}}.
It is \samp{\bsl{}u20ac} in Unicode, which can be used in UTF-8 locales.

In all the European Windows encodings the Euro is symbol 128 and
\samp{\bsl{}u20ac} will work in all locales: however not all fonts will
include it.  It is not in the symbol font used for
\code{\LinkA{windows}{windows}} and related devices, including the Windows printer.
\end{Section}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Murrell, P. (2005) \emph{R Graphics}. Chapman \& Hall/CRC Press.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{text.formula}{text.formula}} for the formula method;
\code{\LinkA{mtext}{mtext}}, \code{\LinkA{title}{title}},
\code{\LinkA{Hershey}{Hershey}} for details on Hershey vector fonts,
\code{\LinkA{plotmath}{plotmath}} for details and more examples on
mathematical annotation.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(-1:1,-1:1, type = "n", xlab = "Re", ylab = "Im")
K <- 16; text(exp(1i * 2 * pi * (1:K) / K), col = 2)

## The following two examples use latin1 characters: these may not
## appear correctly (or be omitted entirely).
plot(1:10, 1:10, main = "text(...) examples\n~~~~~~~~~~~~~~",
     sub = "R is GNU Â©, but not Â® ...")
mtext("Â«Latin-1 accented charsÂ»: Ã©Ã¨ Ã¸Ã Ã¥<Ã Ã¦<Ã", side=3)
points(c(6,2), c(2,1), pch = 3, cex = 4, col = "red")
text(6, 2, "the text is CENTERED around (x,y) = (6,2) by default",
     cex = .8)
text(2, 1, "or Left/Bottom - JUSTIFIED at (2,1) by 'adj = c(0,0)'",
     adj = c(0,0))
text(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y))
text(4, 8.4, "expression(hat(beta) == (X^t * X)^{-1} * X^t * y)",
     cex = .75)
text(4, 7, expression(bar(x) == sum(frac(x[i], n), i==1, n)))

## Two more latin1 examples
text(5,10.2,
     "Le franÃ§ais, c'est faÃ§ile: RÃ¨gles, LibertÃ©, EgalitÃ©, FraternitÃ©...")
text(5,9.8,
     "Jetz no chli zÃ¼ritÃ¼Ã¼tsch: (noch ein biÃchen ZÃ¼rcher deutsch)")
\end{ExampleCode}
\end{Examples}
\HeaderA{title}{Plot Annotation}{title}
\keyword{aplot}{title}
%
\begin{Description}\relax
This function can be used to add labels to a plot.  Its first four
principal arguments can also be used as arguments in most high-level
plotting functions.  They must be of type \code{\LinkA{character}{character}} or
\code{\LinkA{expression}{expression}}. In the latter case, quite a bit of
mathematical notation is available such as sub- and superscripts,
greek letters, fractions, etc: see \LinkA{plotmath}{plotmath}
\end{Description}
%
\begin{Usage}
\begin{verbatim}
title(main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
      line = NA, outer = FALSE, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{main}] The main title (on top) using font and size (character
expansion) \code{par("font.main")} and color
\code{par("col.main")}.
\item[\code{sub}] Sub-title (at bottom) using font and size
\code{par("font.sub")} and color \code{par("col.sub")}.
\item[\code{xlab}] X axis label using font and character expansion
\code{par("font.lab")} and color \code{par("col.lab")}.
\item[\code{ylab}] Y axis label, same font attributes as \code{xlab}.
\item[\code{line}] specifying a value for \code{line} overrides the
default placement of labels, and places them this many lines
outwards from the plot edge.
\item[\code{outer}] a logical value.  If \code{TRUE}, the titles are
placed in the outer margins of the plot.
\item[\code{...}] further \LinkA{graphical parameters}{graphical parameters} from \code{\LinkA{par}{par}}.  Use
e.g., \code{col.main} or \code{cex.sub} instead of just \code{col}
or \code{cex}.  \code{adj} controls the justification of the titles.
\code{xpd} can be used to set the clipping region:
this defaults to the figure region unless \code{outer = TRUE},
otherwise the device region and can only be increased.  \code{mgp}
controls the default placing of the axis titles.

\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The labels passed to \code{title} can be character strings or
language objects (names, calls or expressions), or a list
containing the string to be plotted, and a selection of the optional
modifying \LinkA{graphical parameters}{graphical parameters} \code{cex=}, \code{col=} and
\code{font=}.  Other objects will be coerced by
\code{\LinkA{as.graphicsAnnot}{as.graphicsAnnot}}. 

The position of \code{main} defaults to being vertically centered in
(outer) margin 3 and justified horizontally according to
\code{par("adj")} on the plot region (device region for
\code{outer=TRUE}).

The positions of \code{xlab}, \code{ylab} and \code{sub} are
\code{line} (default for \code{xlab} and \code{ylab} being
\code{par("mgp")[1]} and increased by \code{1} for \code{sub}) lines
(of height \code{par("mex")}) into the appropriate margin, justified
in the text direction according to \code{par("adj")} on the
plot/device region.
\end{Details}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{mtext}{mtext}}, \code{\LinkA{text}{text}};
\code{\LinkA{plotmath}{plotmath}} for details on mathematical annotation.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
plot(cars, main = "") # here, could use main directly
title(main = "Stopping Distance versus Speed")

plot(cars, main = "")
title(main = list("Stopping Distance versus Speed", cex=1.5,
                  col="red", font=3))

## Specifying "..." :
plot(1, col.axis = "sky blue", col.lab = "thistle")
title("Main Title", sub = "sub title",
      cex.main = 2,   font.main= 4, col.main= "blue",
      cex.sub = 0.75, font.sub = 3, col.sub = "red")


x <- seq(-4, 4, len = 101)
y <- cbind(sin(x), cos(x))
matplot(x, y, type = "l", xaxt = "n",
        main = expression(paste(plain(sin) * phi, "  and  ",
                                plain(cos) * phi)),
        ylab = expression("sin" * phi, "cos" * phi), # only 1st is taken
        xlab = expression(paste("Phase Angle ", phi)),
        col.main = "blue")
axis(1, at = c(-pi, -pi/2, 0, pi/2, pi),
     labels = expression(-pi, -pi/2, 0, pi/2, pi))
abline(h = 0, v = pi/2 * c(-1,1), lty = 2, lwd = .1, col = "gray70")
\end{ExampleCode}
\end{Examples}
\HeaderA{units}{Graphical Units}{units}
\aliasA{xinch}{units}{xinch}
\aliasA{xyinch}{units}{xyinch}
\aliasA{yinch}{units}{yinch}
\keyword{dplot}{units}
%
\begin{Description}\relax
\code{xinch} and \code{yinch} convert the specified number of inches
given as their arguments into the correct units for plotting with
graphics functions.  Usually, this only makes sense when normal
coordinates are used, i.e., \emph{no} \code{log} scale (see the
\code{log} argument to \code{\LinkA{par}{par}}).

\code{xyinch} does the same for a pair of numbers \code{xy},
simultaneously.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xinch(x = 1, warn.log = TRUE)
yinch(y = 1, warn.log = TRUE)
xyinch(xy = 1, warn.log = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] numeric vector
\item[\code{xy}] numeric of length 1 or 2.
\item[\code{warn.log}] logical; if \code{TRUE}, a warning is printed in case
of active log scale.
\end{ldescription}
\end{Arguments}
%
\begin{Examples}
\begin{ExampleCode}
all(c(xinch(),yinch()) == xyinch()) # TRUE
xyinch()
xyinch #- to see that is really   delta{"usr"} / "pin"

## plot labels offset 0.12 inches to the right
## of plotted symbols in a plot
with(mtcars, {
    plot(mpg, disp, pch=19, main= "Motor Trend Cars")
    text(mpg + xinch(0.12), disp, row.names(mtcars),
         adj = 0, cex = .7, col = 'blue')
    })
\end{ExampleCode}
\end{Examples}
\HeaderA{xspline}{Draw an X-spline}{xspline}
\keyword{aplot}{xspline}
%
\begin{Description}\relax
Draw an X-spline, a curve drawn relative to control points.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xspline(x, y = NULL, shape = 0, open = TRUE, repEnds = TRUE,
        draw = TRUE, border = par("fg"), col = NA, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] vectors containing the coordinates of the vertices
of the polygon. See \code{\LinkA{xy.coords}{xy.coords}} for alternatives.
\item[\code{shape}] A numeric vector of values between -1 and 1, which
control the shape of the spline relative to the control points.
\item[\code{open}] A logical value indicating whether the spline is
an open or a closed shape.
\item[\code{repEnds}] For open X-splines, a logical value indicating whether
the first and last control points should be replicated for drawing
the curve. Ignored for closed X-splines.
\item[\code{draw}] logical: should the X-spline be drawn?  If false, a set of
line segments to draw the curve is returned, and nothing is drawn.
\item[\code{border}] the color to draw the curve.   Use \code{border = NA} to
omit borders.
\item[\code{col}] the color for filling the shape. The default,
\code{NA}, is to leave unfilled.
\item[\code{...}] \LinkA{graphical parameters}{graphical parameters} such as \code{lty}, \code{xpd},
\code{lend}, \code{ljoin} and \code{lmitre} can be given as arguments.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
An X-spline is a line drawn relative to control points.  For each
control point, the line may pass through (interpolate) the control
point or it may only approach (approximate) the control point;  the
behaviour is determined by a shape parameter for each control point.

If the shape parameter is greater than zero, the spline approximates
the control points (and is very similar to a cubic B-spline when the
shape is 1).  If the shape parameter is less than zero, the spline
interpolates the control points (and is very similar to a Catmull-Rom
spline when the shape is -1).  If the shape parameter is 0, the spline
forms a sharp corner at that control point.

For open X-splines, the start and end control points must have a shape
of 0 (and non-zero values are silently converted to zero).

For open X-splines, by default the start and end control points are
replicated before the curve is drawn.  A curve is drawn between
(interpolating or approximating) the second and third of each set of
four control points, so this default behaviour ensures that the
resulting curve starts at the first control point you have specified
and ends at the last control point.  The default behaviour can be
turned off via the \code{repEnds} argument.
\end{Details}
%
\begin{Value}
If \code{draw = TRUE}, \code{NULL} otherwise a list with elements
\code{x} and \code{y} which could be passed to \code{\LinkA{lines}{lines}},
\code{\LinkA{polygon}{polygon}} and so on.

Invisible in both cases.
\end{Value}
%
\begin{Note}\relax
Two-dimensional splines need to be created in an isotropic coordinate
system.  Device coordinates are used (with an anisotropy correction if
needed.)
\end{Note}
%
\begin{References}\relax
Blanc, C. and Schlick, C. (1995),
\emph{X-splines : A Spline Model Designed for the End User},
in \emph{Proceedings of SIGGRAPH 95}, pp. 377--386.
\url{http://dept-info.labri.fr/~schlick/DOC/sig1.html}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{polygon}{polygon}}.

\code{\LinkA{par}{par}} for how to specify colors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## based on examples in ?grid.xspline

xsplineTest <- function(s, open = TRUE,
                        x = c(1,1,3,3)/4,
                        y = c(1,3,3,1)/4, ...) {
    plot(c(0,1), c(0,1), type="n", axes=FALSE, xlab="", ylab="")
    points(x, y, pch=19)
    xspline(x, y, s, open, ...)
    text(x+0.05*c(-1,-1,1,1), y+0.05*c(-1,1,1,-1), s)
}
op <- par(mfrow=c(3,3), mar=rep(0,4), oma=c(0,0,2,0))
xsplineTest(c(0, -1, -1, 0))
xsplineTest(c(0, -1,  0, 0))
xsplineTest(c(0, -1,  1, 0))
xsplineTest(c(0,  0, -1, 0))
xsplineTest(c(0,  0,  0, 0))
xsplineTest(c(0,  0,  1, 0))
xsplineTest(c(0,  1, -1, 0))
xsplineTest(c(0,  1,  0, 0))
xsplineTest(c(0,  1,  1, 0))
title("Open X-splines", outer=TRUE)

par(mfrow=c(3,3), mar=rep(0,4), oma=c(0,0,2,0))
xsplineTest(c(0, -1, -1, 0), FALSE, col="grey80")
xsplineTest(c(0, -1,  0, 0), FALSE, col="grey80")
xsplineTest(c(0, -1,  1, 0), FALSE, col="grey80")
xsplineTest(c(0,  0, -1, 0), FALSE, col="grey80")
xsplineTest(c(0,  0,  0, 0), FALSE, col="grey80")
xsplineTest(c(0,  0,  1, 0), FALSE, col="grey80")
xsplineTest(c(0,  1, -1, 0), FALSE, col="grey80")
xsplineTest(c(0,  1,  0, 0), FALSE, col="grey80")
xsplineTest(c(0,  1,  1, 0), FALSE, col="grey80")
title("Closed X-splines", outer=TRUE)

par(op)

x <- sort(stats::rnorm(5))
y <- sort(stats::rnorm(5))
plot(x, y, pch=19)
res <- xspline(x, y, 1, draw=FALSE)
lines(res)
## the end points may be very close together,
## so use last few for direction
nr <- length(res$x)
arrows(res$x[1], res$y[1], res$x[4], res$y[4], code=1, length=0.1)
arrows(res$x[nr-3], res$y[nr-3], res$x[nr], res$y[nr],
       code = 2, length = 0.1)
\end{ExampleCode}
\end{Examples}
\clearpage
