
\chapter{The \texttt{grDevices} package}
\HeaderA{grDevices-package}{The R Graphics Devices and Support for Colours and Fonts}{grDevices.Rdash.package}
\aliasA{grDevices}{grDevices-package}{grDevices}
\keyword{package}{grDevices-package}
\keyword{device}{grDevices-package}
%
\begin{Description}\relax
Graphics devices and support for base and grid graphics
\end{Description}
%
\begin{Details}\relax

This package contains functions which support both
\LinkA{base}{graphics.Rdash.package} and \LinkA{grid}{grid.Rdash.package} graphics.

For a complete list of functions, use \code{library(help="grDevices")}.

\end{Details}
%
\begin{Author}\relax
R Core Team and contributors worldwide

Maintainer: R Core Team \email{R-core@r-project.org}
\end{Author}
\HeaderA{adjustcolor}{Adjust Colors in One or More Directions Conveniently.}{adjustcolor}
%
\begin{Description}\relax
Adjust or modify a vector of colors by ``turning knobs'' on one or more
coordinates in \eqn{(r,g,b,\alpha)}{} space, typically by up or down
scaling them.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
adjustcolor(col, alpha.f = 1, red.f = 1, green.f = 1, blue.f = 1,
            offset = c(0, 0, 0, 0),
            transform = diag(c(red.f, green.f, blue.f, alpha.f)))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{col}] vector of colors, in any format that col2rgb() accepts
\item[\code{alpha.f}] factor modifying the opacity alpha; typically in [0,1]
\item[\code{red.f, green.f, blue.f}] factors modifying the ``red-'',
``green-'' or ``blue-''ness of the colors, respectively.
\item[\code{offset}] 

\item[\code{transform}] 

\end{ldescription}
\end{Arguments}
%
\begin{Value}
a color vector of the same length as \code{col}, effectively the
result of \code{\LinkA{rgb}{rgb}()}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{rgb}{rgb}}, \code{\LinkA{col2rgb}{col2rgb}}.  For more sophisticated
color constructions: \code{\LinkA{convertColor}{convertColor}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Illustrative examples :
opal <- palette("default")
stopifnot(identical(adjustcolor(1:8,       0.75),
                    adjustcolor(palette(), 0.75)))
cbind(palette(), adjustcolor(1:8, 0.75))

##  alpha = 1/2 * previous alpha --> opaque colors
x <- palette(adjustcolor(palette(), 0.5))

sines <- outer(1:20, 1:4, function(x, y) sin(x / 20 * pi * y))
matplot(sines, type = "b", pch = 21:23, col = 2:5, bg = 2:5,
        main = "Using an 'opaque ('translucent') color palette")

x. <- adjustcolor(x, offset=c(0.5,0.5,0.5, 0), # <- "more white"
                  transform=diag(c(.7, .7, .7, 0.6)))
cbind(x, x.)
op <- par(bg=adjustcolor("goldenrod",offset=-rep(.4,4)), xpd=NA)
plot(0:9,0:9, type="n",axes=FALSE, xlab="",ylab="",
     main="adjustcolor() -> translucent")
text(1:8, labels=paste(x,"++",sep=""), col=x., cex=8)
par(op)

## and

(M <- cbind( rbind( matrix(1/3, 3,3), 0), c(0,0,0,1)))
adjustcolor(x, transform = M)

## revert to previous palette: active
palette(opal)
\end{ExampleCode}
\end{Examples}
\HeaderA{as.graphicsAnnot}{Coerce an Object for Graphics Annotation}{as.graphicsAnnot}
\keyword{utilities}{as.graphicsAnnot}
%
\begin{Description}\relax
Coerce an \R{} object into a form suitable for graphics annotation.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
as.graphicsAnnot(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an \R{} object
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Expressions, calls and names (as used by \LinkA{plotmath}{plotmath}) are passed
through unchanged.  All other objects with an explicit class (as
determined by \code{\LinkA{is.object}{is.object}}) are coerced by
\code{\LinkA{as.character}{as.character}} to character vectors.

All the \pkg{graphics} and \pkg{grid} functions which use this coerce
calls and names to expressions internally.
\end{Details}
%
\begin{Value}
A language object or a character vector.
\end{Value}
\HeaderA{as.raster}{Create a Raster Object}{as.raster}
\methaliasA{as.raster.array}{as.raster}{as.raster.array}
\methaliasA{as.raster.character}{as.raster}{as.raster.character}
\methaliasA{as.raster.logical}{as.raster}{as.raster.logical}
\methaliasA{as.raster.matrix}{as.raster}{as.raster.matrix}
\methaliasA{as.raster.numeric}{as.raster}{as.raster.numeric}
\aliasA{is.raster}{as.raster}{is.raster}
\keyword{dplot}{as.raster}
%
\begin{Description}\relax
Functions to create a raster object (representing a bitmap
image) and coerce other objects to a raster object.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
is.raster(x)
as.raster(x, ...)

## S3 method for class 'logical'
as.raster(x, max=1, ...)
## S3 method for class 'numeric'
as.raster(x, max=1, ...)
## S3 method for class 'character'
as.raster(x, max=1, ...)
## S3 method for class 'matrix'
as.raster(x, max=1, ...)
## S3 method for class 'array'
as.raster(x, max=1, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] 
Any R object.

\item[\code{max}] number giving the maximum of the color values range.
\item[\code{...}] further arguments passed to or from other methods.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
An object of class \code{"raster"} is a matrix of colour values as
given by \code{\LinkA{rgb}{rgb}} representing a bitmap image.

It is not expected that the user will need to call these functions
directly; functions to render bitmap images in graphics packages will
make use of the \code{as.raster()} function to generate a raster
object from their input.

The \code{as.raster()} function is generic so methods can be
written to convert other R objects to a raster object.

The default implementation for numeric matrices interprets scalar
values on black-to-white scale.

Raster objects can be subsetted like a matrix and it is
possible to assign to a subset of a raster object.

There is a method for converting a raster object to a matrix
(of colour strings).

Raster objects can be compared
for equality or inequality (with each other or with a
colour string).

As from \R{} 2.14.0 there is a \code{\LinkA{is.na}{is.na}} method which returns
a logical matrix of the same dimensions as the raster object.  Note
that \code{NA} values are interpreted as the fully transparent colour
by some (but not all) graphics devices.
\end{Details}
%
\begin{Value}
For \code{as.raster()}, a raster object.

For \code{is.raster()}, a logical indicating whether
\code{x} is a raster object.
\end{Value}
%
\begin{Examples}
\begin{ExampleCode}
# A red gradient
as.raster(matrix(hcl(0, 80, seq(50, 80, 10)),
                 nrow=4, ncol=5))

# Vectors are 1-column matrices ...
#   character vectors are color names ...
as.raster(hcl(0, 80, seq(50, 80, 10)))
#   numeric vectors are greyscale ...
as.raster(1:5, max=5)
#   locigal vectors are black and white ...
as.raster(1:10 %% 2 == 0)

# ... unless nrow/ncol are supplied ...
as.raster(1:10 %% 2 == 0, nrow=1)

# Matrix can also be logical or numeric ...
as.raster(matrix(c(TRUE, FALSE), nrow=3, ncol=2))
as.raster(matrix(1:3/4, nrow=3, ncol=4))

# An array can be 3-plane numeric (R, G, B planes) ...
as.raster(array(c(0:1, rep(0.5, 4)), c(2, 1, 3)))

# ... or 4-plane numeric (R, G, B, A planes)
as.raster(array(c(0:1, rep(0.5, 6)), c(2, 1, 4)))

# subsetting
r <- as.raster(matrix(colors()[1:100], ncol=10))
r[, 2]
r[2:4, 2:5]

# assigning to subset
r[2:4, 2:5] <- "white"

# comparison
r == "white"


\end{ExampleCode}
\end{Examples}
\HeaderA{axisTicks}{Compute Pretty Axis Tick Scales}{axisTicks}
\aliasA{.axisPars}{axisTicks}{.axisPars}
\keyword{dplot}{axisTicks}
%
\begin{Description}\relax
Compute pretty axis scales and tick mark locations, the same way as
traditional \R{} graphics do it.  This is interesting particularly for
log scale axes.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
axisTicks(usr, log, axp = NULL, nint = 5)
 .axisPars(usr, log = FALSE, nintLog = 5)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{usr}] numeric vector of length 2, with \code{c(min, max)} axis
extents.
\item[\code{log}] logical indicating if a log scale is (thought to be) in
use.
\item[\code{axp}] numeric vector of length 3, \code{c(mi, ma, n.)}, with
identical meaning to \code{\LinkA{par}{par}("?axp")} (where \code{?} is
\code{x} or \code{y}), namely ``pretty'' axis extents, and an
integer \emph{code} \code{n.}.


\item[\code{nint, nintLog}] positive integer value indicating
(\emph{approximately}) the desired number of intervals.
\code{nintLog} is used \bold{only} for the case \code{log = TRUE}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{axisTicks(usr, *)} calls \code{.axisPars(usr, ..)} when
\code{axp} is missing (or \code{NULL}).

\end{Details}
%
\begin{Value}
\code{axisTicks()} returns a numeric vector of potential axis tick
locations, of length approximately \code{nint+1}.

\code{.axisPars()} returns a \code{\LinkA{list}{list}} with components
\begin{ldescription}
\item[\code{axp}] numeric vector of length 2, \code{c(min., max.)}, of pretty
axis extents.
\item[\code{n}] integer (code), with the same meaning as
\code{\LinkA{par}{par}("?axp")[3]}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{axTicks}{axTicks}};
\code{\LinkA{axis}{axis}}, and \code{\LinkA{par}{par}} (from
the \pkg{graphics} package).
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
##--- Demonstrating correspondence between graphics'
##--- axis() and the graphics-engine agnostic  axisTicks() :

require("graphics")
plot(10*(0:10)); (pu <- par("usr"))
aX <- function(side, at, ...)
    axis(side, at=at, labels=FALSE, lwd.ticks=2, col.ticks=2, tck=0.05, ...)
aX(1, print(xa <- axisTicks(pu[1:2], log=FALSE)))# x axis
aX(2, print(ya <- axisTicks(pu[3:4], log=FALSE)))# y axis

axisTicks(pu[3:4], log=FALSE, n = 10)

plot(10*(0:10), log="y"); (pu <- par("usr"))
aX(2, print(ya <- axisTicks(pu[3:4], log=TRUE)))# y axis

plot(2^(0:9), log="y"); (pu <- par("usr"))
aX(2, print(ya <- axisTicks(pu[3:4], log=TRUE)))# y axis

\end{ExampleCode}
\end{Examples}
\HeaderA{boxplot.stats}{Box Plot Statistics}{boxplot.stats}
\keyword{dplot}{boxplot.stats}
%
\begin{Description}\relax
This function is typically called by another function to
gather the statistics necessary for producing box plots,
but may be invoked separately.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
boxplot.stats(x, coef = 1.5, do.conf = TRUE, do.out = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] a numeric vector for which the boxplot will
be constructed (\code{\LinkA{NA}{NA}}s and \code{\LinkA{NaN}{NaN}}s are allowed
and omitted).
\item[\code{coef}] this determines how far the plot `whiskers' extend out
from the box.  If \code{coef} is positive, the whiskers extend to the
most extreme data point which is no more than \code{coef} times
the length of the box away from the box. A value of zero causes
the whiskers
to extend to the data extremes (and no outliers be returned).
\item[\code{do.conf,do.out}] logicals; if \code{FALSE}, the \code{conf} or
\code{out} component respectively will be empty in the result.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The two `hinges' are versions of the first and third quartile,
i.e., close to \code{\LinkA{quantile}{quantile}(x, c(1,3)/4)}.  The hinges equal
the quartiles for odd \eqn{n}{} (where \code{n <- length(x)}) and
differ for even \eqn{n}{}.  Whereas the quartiles only equal observations
for \code{n \%\% 4 == 1} (\eqn{n\equiv 1 \bmod 4}{}),
the hinges do so \emph{additionally} for \code{n \%\% 4 == 2}
(\eqn{n\equiv 2 \bmod 4}{}), and are in the middle of
two observations otherwise.

The notches (if requested) extend to \code{+/-1.58 IQR/sqrt(n)}.
This seems to be based on the same calculations as the formula with 1.57 in
Chambers \emph{et al.} (1983, p. 62), given in McGill \emph{et al.}
(1978, p. 16).  They are based on asymptotic normality of the median
and roughly equal sample sizes for the two medians being compared, and
are said to be rather insensitive to the underlying distributions of
the samples.  The idea appears to be to give roughly a 95\% confidence
interval for the difference in two medians.
\end{Details}
%
\begin{Value}
List with named components as follows:
\begin{ldescription}
\item[\code{stats}] a vector of length 5, containing the extreme of the
lower whisker, the lower `hinge', the median, the upper
`hinge' and the extreme of the upper whisker.
\item[\code{n}] the number of non-\code{NA} observations in the sample.
\item[\code{conf}] the lower and upper extremes of the `notch'
(\code{if(do.conf)}). See the details.
\item[\code{out}] the values of any data points which lie beyond the
extremes of the whiskers (\code{if(do.out)}).

\end{ldescription}
Note that \code{\$stats} and \code{\$conf} are sorted in \emph{in}creasing
order, unlike S, and that \code{\$n} and \code{\$out} include any
\code{+- Inf} values.
\end{Value}
%
\begin{References}\relax
Tukey, J. W. (1977) \emph{Exploratory Data Analysis.} Section 2C.

McGill, R., Tukey, J. W. and Larsen, W. A. (1978) Variations of box
plots. \emph{The American Statistician} \bold{32}, 12--16.

Velleman, P. F. and Hoaglin, D. C. (1981) \emph{Applications, Basics
and Computing of Exploratory Data Analysis.}  Duxbury Press.

Emerson, J. D and Strenio, J. (1983). Boxplots and batch comparison.
Chapter 3 of \emph{Understanding Robust and Exploratory Data
Analysis}, eds. D. C. Hoaglin, F. Mosteller and J. W. Tukey.  Wiley.

Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983)
\emph{Graphical Methods for Data Analysis.}  Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{fivenum}{fivenum}}, \code{\LinkA{boxplot}{boxplot}}, \code{\LinkA{bxp}{bxp}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
x <- c(1:100, 1000)
(b1 <- boxplot.stats(x))
(b2 <- boxplot.stats(x, do.conf=FALSE, do.out=FALSE))
stopifnot(b1 $ stats == b2 $ stats) # do.out=F is still robust
boxplot.stats(x, coef = 3, do.conf=FALSE)
## no outlier treatment:
boxplot.stats(x, coef = 0)

boxplot.stats(c(x, NA)) # slight change : n is 101
(r <- boxplot.stats(c(x, -1:1/0)))
stopifnot(r$out == c(1000, -Inf, Inf))




\end{ExampleCode}
\end{Examples}
\HeaderA{bringToTop}{Assign Focus to a Window}{bringToTop}
\aliasA{stayOnTop}{bringToTop}{stayOnTop}
\keyword{device}{bringToTop}
%
\begin{Description}\relax
\code{bringToTop} brings the specified screen device's window to the
front of the window stack (and gives it focus).  With first argument
\code{-1} it brings the console to the top.

If \code{stay =  TRUE}, the window is designated as a topmost window,
i.e. it will stay on top of any regular window.  \code{stay} may only be used
when Rgui is run in SDI mode.  This corresponds to the ``Stay on top''
popup menu item in Rgui.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
bringToTop(which = dev.cur(), stay = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{which}] a device number, or \code{-1}.
\item[\code{stay}] whether to make the window stay on top.
\end{ldescription}
\end{Arguments}
%
\begin{SeeAlso}\relax
\code{\LinkA{msgWindow}{msgWindow}}, \code{\LinkA{windows}{windows}}
\end{SeeAlso}
\HeaderA{cairo}{Cairo-based SVG, PDF and PostScript Graphics Devices}{cairo}
\aliasA{cairo\_pdf}{cairo}{cairo.Rul.pdf}
\aliasA{cairo\_ps}{cairo}{cairo.Rul.ps}
\aliasA{svg}{cairo}{svg}
\keyword{device}{cairo}
%
\begin{Description}\relax
Graphics devices for SVG, PDF and PostScript graphics files.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
svg(filename = if(onefile) "Rplots.svg" else "Rplot%03d.svg",
    width = 7, height = 7, pointsize = 12,
    onefile = FALSE, family = "sans", bg = "white",
    antialias = c("default", "none", "gray", "subpixel"))

cairo_pdf(filename = if(onefile) "Rplots.pdf" else "Rplot%03d.pdf",
          width = 7, height = 7, pointsize = 12,
          onefile = FALSE, family = "sans", bg = "white",
          antialias = c("default", "none", "gray", "subpixel"))

cairo_ps(filename = if(onefile) "Rplots.ps" else "Rplot%03d.ps",
         width = 7, height = 7, pointsize = 12,
         onefile = FALSE, family = "sans", bg = "white",
         antialias = c("default", "none", "gray", "subpixel"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] the name of the output file.
The page number is substituted if a C integer format is included in
the character string, as in the default.  (The result must be less
than \code{PATH\_MAX} characters long, and may be truncated if not.
See \code{\LinkA{postscript}{postscript}} for further details.)  Tilde expansion
is performed where supported by the platform.
\item[\code{width}] the width of the device in inches.
\item[\code{height}] the height of the device in inches.
\item[\code{pointsize}] the default pointsize of plotted text (in big points).
\item[\code{onefile}] should all plots appear in one file or in separate files?
\item[\code{family}] one of the device-independent font families,
\code{"sans"}, \code{"serif"} and \code{"mono"}, or a character
string specify a font family to be searched for in a
system-dependent way.

\item[\code{bg}] the initial background colour: can be overridden by setting
par("bg").
\item[\code{antialias}] string, the type of anti-aliasing (if any) to be used;
defaults to \code{"default"}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
SVG (Scalar Vector Graphics) is a W3C standard for vector graphics.
See \url{http://www.w3.org/Graphics/SVG/}.  The output is SVG version
1.1 for \code{onefile = FALSE} (the default), otherwise SVG 1.2.  (Very few
SVG viewers are capable of displaying multi-page SVG files.)  Although
this only requires cairo >= 1.2, the output produced by cairo 1.2.4
(in Centos/RHEL 5) is incorrect.

Note that unlike \code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}},
\code{cairo\_pdf} and \code{cairo\_ps} sometimes record \emph{bitmaps}
and not vector graphics: a resolution of 72dpi is used.  On the other
hand, they can (on suitable platforms) include a much wider range of
UTF-8 glyphs, and embed the fonts used.

The output produced by \code{cairo\_ps(onefile = FALSE)} will be
encapsulated postscript on a platform with cairo >= 1.6.

\R{} can be compiled without support for any of these
devices: this will be reported if you attempt to use them on a system
where they are not supported.  They all require cairo version 1.2 or
later.

If you plot more than one page on one of these devices and do not
include something like \code{\%d} for the sequence number in
\code{file} (or set \code{onefile=TRUE}) the file will contain the
last page plotted.

There is full support of transparency, but using this is one of the
things liable to trigger bitmap output (and will always do so for
\code{cairo\_ps}).
\end{Details}
%
\begin{Value}
A plot device is opened: nothing is returned to the \R{} interpreter.
\end{Value}
%
\begin{Section}{Anti-aliasing}
Anti-aliasing is applied to both graphics and fonts.  It is generally
preferable for lines and text, but can lead to undesirable effects for
fills, e.g. for \code{\LinkA{image}{image}} plots, and so is never used for
fills.

\code{antialias = "default"} is in principle platform-dependent, but
seems most often equivalent to \code{antialias = "gray"}.
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is in pixels (\code{svg}) or inches.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are multiples of 1/96 inch.
\item Circle radii have a minimum of 1/72 inch.
\item Colours are interpreted by the viewing application.

\end{itemize}

\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, \code{\LinkA{dev.print}{dev.print}}, \code{\LinkA{pdf}{pdf}},
\code{\LinkA{postscript}{postscript}}

\code{\LinkA{capabilities}{capabilities}} to see if cairo is supported.
\end{SeeAlso}
\HeaderA{check.options}{Set Options with Consistency Checks}{check.options}
\keyword{utilities}{check.options}
\keyword{programming}{check.options}
%
\begin{Description}\relax
Utility function for setting options with some consistency checks.
The \code{\LinkA{attributes}{attributes}} of the new settings in \code{new} are
checked for consistency with the \emph{model} (often default)
list in \code{name.opt}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
check.options(new, name.opt, reset = FALSE, assign.opt = FALSE,
              envir = .GlobalEnv,
              check.attributes = c("mode", "length"),
              override.check = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{new}] a \emph{named} list
\item[\code{name.opt}] character with the name of \R{} object containing the
default list.
\item[\code{reset}] logical; if \code{TRUE}, reset the options from
\code{name.opt}.  If there is more than one \R{} object with name
\code{name.opt}, remove the first one in the \code{\LinkA{search}{search}()} path.
\item[\code{assign.opt}] logical; if \code{TRUE}, assign the \ldots
\item[\code{envir}] the \code{\LinkA{environment}{environment}} used for \code{\LinkA{get}{get}}
and \code{\LinkA{assign}{assign}}.
\item[\code{check.attributes}] character containing the attributes which
\code{check.options} should check.
\item[\code{override.check}] logical vector of length \code{length(new)} (or 1
which entails recycling).
For those \code{new[i]} where \code{override.check[i] == TRUE}, the
checks are overridden and the changes made anyway.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list of components with the same names as the one called
\code{name.opt}.
The values of the components are changed from the \code{new} list,
as long as these pass the checks (when these are not overridden
according to \code{override.check}).
\end{Value}
%
\begin{Note}\relax
Option \code{"names"} is exempt from all the checks or warnings, as in
the application it can be \code{NULL} or a variable-length character
vector.
\end{Note}
%
\begin{Author}\relax
Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{ps.options}{ps.options}} and \code{\LinkA{pdf.options}{pdf.options}},
which use \code{check.options}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
(L1 <- list(a=1:3, b=pi, ch="CH"))
check.options(list(a=0:2), name.opt = "L1")
check.options(NULL, reset = TRUE, name.opt = "L1")
\end{ExampleCode}
\end{Examples}
\HeaderA{chull}{Compute Convex Hull of a Set of Points}{chull}
\keyword{graphs}{chull}
%
\begin{Description}\relax
Computes the subset of points which lie on the convex hull of the
set of points specified.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
chull(x, y = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] coordinate vectors of points. This can be specified as two
vectors \code{x} and \code{y}, a 2-column matrix \code{x}, a list
\code{x} with two components, etc, see \code{\LinkA{xy.coords}{xy.coords}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{\LinkA{xy.coords}{xy.coords}} is used to interpret the
specification of the points. The algorithm is that given by Eddy (1977).

`Peeling' as used in the S function \code{chull} can be
implemented by calling \code{chull} recursively.
\end{Details}
%
\begin{Value}
An integer vector giving the indices of the points lying on the
convex hull, in clockwise order.
\end{Value}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.

Eddy, W. F. (1977) A new convex hull algorithm for planar sets.
\emph{ACM Transactions on Mathematical Software}, \bold{3}, 398--403.

Eddy, W. F. (1977) Algorithm 523. CONVEX, A new convex hull
algorithm for planar sets[Z]. \emph{ACM Transactions on
Mathematical Software}, \bold{3}, 411--412.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{xy.coords}{xy.coords}},\code{\LinkA{polygon}{polygon}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(stats)
X <- matrix(rnorm(2000), ncol = 2)
chull(X)
## Not run: 
  # Example usage from graphics package
  plot(X, cex = 0.5)
  hpts <- chull(X)
  hpts <- c(hpts, hpts[1])
  lines(X[hpts, ])

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{cm}{Unit Transformation}{cm}
\keyword{dplot}{cm}
%
\begin{Description}\relax
Translates from inches to cm (centimeters).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
cm(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] numeric vector
\end{ldescription}
\end{Arguments}
%
\begin{Examples}
\begin{ExampleCode}
cm(1)# = 2.54

## Translate *from* cm *to* inches:

10 / cm(1) # -> 10cm  are 3.937 inches
\end{ExampleCode}
\end{Examples}
\HeaderA{col2rgb}{Color to RGB Conversion}{col2rgb}
\keyword{color}{col2rgb}
\keyword{dplot}{col2rgb}
%
\begin{Description}\relax
\R{} color to RGB (red/green/blue) conversion.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
col2rgb(col, alpha = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{col}] vector of any of the three kind of \R{} colors, i.e., either
a color name (an element of \code{\LinkA{colors}{colors}()}), a hexadecimal
string of the form \code{"\#rrggbb"} or \code{"\#rrggbbaa"} (see
\code{\LinkA{rgb}{rgb}}), or an integer \code{i} meaning
\code{palette()[i]}.  Non-string values are coerced to integer.
\item[\code{alpha}] logical value indicating whether alpha channel (opacity)
values should be returned.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For integer colors, \code{0} is shorthand for the current
\code{\LinkA{par}{par}("bg")} (and hence is only relevant to base graphics
and not grid graphics, and is an error if \pkg{graphics} is not
loaded), and \code{\LinkA{NA}{NA}} means transparent.

For character colors, \code{"NA"} is equivalent to \code{NA}, transparent.
\end{Details}
%
\begin{Value}
an integer matrix with three or four rows and number of columns the length
(and names if any) as \code{col}.
\end{Value}
%
\begin{Author}\relax
Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{rgb}{rgb}}, \code{\LinkA{colors}{colors}}, \code{\LinkA{palette}{palette}}, etc.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
col2rgb("peachpuff")
col2rgb(c(blu = "royalblue", reddish = "tomato")) # names kept

col2rgb(1:8)# the ones from the palette() :

col2rgb(paste("gold", 1:4, sep=""))

col2rgb("#08a0ff")
## all three kind of colors mixed :
col2rgb(c(red="red", palette= 1:3, hex="#abcdef"))

##-- NON-INTRODUCTORY examples --

grC <- col2rgb(paste("gray",0:100,sep=""))
table(print(diff(grC["red",])))# '2' or '3': almost equidistant
## The 'named' grays are in between {"slate gray" is not gray, strictly}
col2rgb(c(g66="gray66", darkg= "dark gray", g67="gray67",
          g74="gray74", gray =      "gray", g75="gray75",
          g82="gray82", light="light gray", g83="gray83"))

crgb <- col2rgb(cc <- colors())
colnames(crgb) <- cc
t(crgb)## The whole table

ccodes <- c(256^(2:0) %*% crgb)## = internal codes
## How many names are 'aliases' of each other:
table(tcc <- table(ccodes))
length(uc <- unique(sort(ccodes))) # 502
## All the multiply named colors:
mult <- uc[tcc >= 2]
cl <- lapply(mult, function(m) cc[ccodes == m])
names(cl) <- apply(col2rgb(sapply(cl, function(x)x[1])),
                   2, function(n)paste(n, collapse=","))
utils::str(cl)
## Not run: 
 if(require(xgobi)) { ## Look at the color cube dynamically :
   tc <- t(crgb[, !duplicated(ccodes)])
   table(is.gray <- tc[,1] == tc[,2] & tc[,2] == tc[,3])# (397, 105)
   xgobi(tc, color = c("gold", "gray")[1 + is.gray])
 }

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{colorRamp}{Color interpolation}{colorRamp}
\aliasA{colorRampPalette}{colorRamp}{colorRampPalette}
\keyword{color}{colorRamp}
%
\begin{Description}\relax
These functions return functions that interpolate a set of given
colors to create new color palettes (like \code{\LinkA{topo.colors}{topo.colors}}) and
color ramps, functions that map the interval \eqn{[0, 1]}{} to colors
(like \code{\LinkA{grey}{grey}}).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
colorRamp(colors, bias = 1, space = c("rgb", "Lab"),
          interpolate = c("linear", "spline"))
colorRampPalette(colors, ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{colors}] colors to interpolate; must be a valid argument to
\code{\LinkA{col2rgb}{col2rgb}()}.
\item[\code{bias}] a positive number.  Higher values give more widely spaced
colors at the high end.
\item[\code{space}] a character string; interpolation in RGB or CIE Lab
color spaces.
\item[\code{interpolate}] use spline or linear interpolation.
\item[\code{...}] arguments to pass to \code{colorRamp}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The CIE Lab color space is approximately perceptually uniform, and so
gives smoother and more uniform color ramps. On the other hand,
palettes that vary from one hue to another via white may have a more
symmetrical appearance in RGB space.

The conversion formulas in this function do not appear to be
completely accurate and the color ramp may not reach the extreme
values in Lab space.  Future changes in the \R{} color model may change
the colors produced with \code{space="Lab"}.
\end{Details}
%
\begin{Value}
\code{colorRamp} returns a \code{\LinkA{function}{function}} that maps values between 0 and 1
to colors.
\code{colorRampPalette} returns a function that takes an integer
argument and returns that number of colors interpolating the given
sequence (similar to \code{\LinkA{heat.colors}{heat.colors}} or
\code{\LinkA{terrain.colors}{terrain.colors}}.
\end{Value}
%
\begin{SeeAlso}\relax
Good starting points for interpolation are the ``sequential''
and ``diverging'' ColorBrewer palettes in the \pkg{RColorBrewer} package.

\code{\LinkA{splinefun}{splinefun}} or \code{\LinkA{approxfun}{approxfun}} are used for
interpolation.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Both return a *function* :
colorRamp(c("red","green"))( (0:4)/4 ) ## (x) , x in [0,1]
colorRampPalette(c("blue","red"))( 4 ) ## (n)

require(graphics)

## Here space="rgb" gives palettes that vary only in saturation,
## as intended.
## With space="Lab" the steps are more uniform, but the hues
## are slightly purple.
filled.contour(volcano,
               color.palette =
                   colorRampPalette(c("red", "white", "blue")),
               asp = 1)
filled.contour(volcano,
               color.palette =
                   colorRampPalette(c("red", "white", "blue"),
                                    space = "Lab"),
               asp = 1)

## Interpolating a 'sequential' ColorBrewer palette
YlOrBr <- c("#FFFFD4", "#FED98E", "#FE9929", "#D95F0E", "#993404")
filled.contour(volcano,
               color.palette = colorRampPalette(YlOrBr, space = "Lab"),
               asp = 1)
filled.contour(volcano,
               color.palette = colorRampPalette(YlOrBr, space = "Lab",
                                                bias = 0.5),
               asp = 1)

## 'jet.colors' is "as in Matlab"
## (and hurting the eyes by over-saturation)
jet.colors <-
  colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
                     "#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
filled.contour(volcano, color = jet.colors, asp = 1)

## space="Lab" helps when colors don't form a natural sequence
m <- outer(1:20,1:20,function(x,y) sin(sqrt(x*y)/3))
rgb.palette <- colorRampPalette(c("red", "orange", "blue"),
                                space = "rgb")
Lab.palette <- colorRampPalette(c("red", "orange", "blue"),
                                space = "Lab")
filled.contour(m, col = rgb.palette(20))
filled.contour(m, col = Lab.palette(20))
\end{ExampleCode}
\end{Examples}
\HeaderA{colors}{Color Names}{colors}
\aliasA{colours}{colors}{colours}
\keyword{color}{colors}
\keyword{dplot}{colors}
\keyword{sysdata}{colors}
%
\begin{Description}\relax
Returns the built-in color names which \R{} knows about.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
colors()
colours()
\end{verbatim}
\end{Usage}
%
\begin{Details}\relax
These color names can be used with a \code{col=} specification in
graphics functions.

An even wider variety of colors can be created with primitives
\code{rgb} and \code{hsv} or the derived \code{rainbow},
\code{heat.colors}, etc.
\end{Details}
%
\begin{Value}
A character vector containing all the built-in color names.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{palette}{palette}} for setting the `palette' of colors for
\code{par(col=}\emph{<num>}\code{)};
\code{\LinkA{rgb}{rgb}}, \code{\LinkA{hsv}{hsv}}, \code{\LinkA{hcl}{hcl}}, \code{\LinkA{gray}{gray}};
\code{\LinkA{rainbow}{rainbow}} for a nice example;
and \code{\LinkA{heat.colors}{heat.colors}}, \code{\LinkA{topo.colors}{topo.colors}} for images.

\code{\LinkA{col2rgb}{col2rgb}} for translating to RGB numbers and extended
examples.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
cl <- colors()
length(cl); cl[1:20]

### ----------- Show (almost) all named colors ---------------------

## 1) with traditional 'graphics' package:
showCols1 <- function(bg = "gray", cex = 0.75, srt = 30) {
    m <- ceiling(sqrt(n <- length(cl <- colors())))
    length(cl) <- m*m; cm <- matrix(cl, m)
    ##
    require("graphics")
    op <- par(mar=rep(0,4), ann=FALSE, bg = bg); on.exit(par(op))
    plot(1:m,1:m, type="n", axes=FALSE)
    text(col(cm), rev(row(cm)), cm,  col = cl, cex=cex, srt=srt)
}
showCols1()

## 2) with 'grid' package:
showCols2 <- function(bg = "grey", cex = 0.75, rot = 30) {
    m <- ceiling(sqrt(n <- length(cl <- colors())))
    length(cl) <- m*m; cm <- matrix(cl, m)
    ##
    require("grid")
    grid.newpage(); vp <- viewport(w = .92, h = .92)
    grid.rect(gp=gpar(fill=bg))
    grid.text(cm, x = col(cm)/m, y = rev(row(cm))/m, rot = rot,
              vp=vp, gp=gpar(cex = cex, col = cm))
}
showCols2()
showCols2(bg = "gray33")
\end{ExampleCode}
\end{Examples}
\HeaderA{contourLines}{Calculate Contour Lines}{contourLines}
\keyword{dplot}{contourLines}
%
\begin{Description}\relax
Calculate contour lines for a given set of data.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
contourLines(x = seq(0, 1, length.out = nrow(z)),
             y = seq(0, 1, length.out = ncol(z)),
             z, nlevels = 10,
             levels = pretty(range(z, na.rm=TRUE), nlevels))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] locations of grid lines at which the values in \code{z} are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If \code{x} is a \code{list},
its components \code{x\$x} and \code{x\$y} are used for \code{x}
and \code{y}, respectively. If the list has component \code{z} this
is used for \code{z}.
\item[\code{z}] a matrix containing the values to be plotted (\code{NA}s are
allowed).  Note that \code{x} can be used instead of \code{z} for
convenience.
\item[\code{nlevels}] number of contour levels desired \bold{iff}
\code{levels} is not supplied.
\item[\code{levels}] numeric vector of levels at which to draw contour
lines.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{contourLines} draws nothing, but returns a set of contour lines.

There is currently no documentation about the algorithm.
The source code is in \file{\var{\LinkA{R\_HOME}{R.Rul.HOME}}/src/main/plot3d.c}.
\end{Details}
%
\begin{Value}
A list of contours.
Each contour is a list with elements:
\begin{ldescription}
\item[\code{level }] The contour level.
\item[\code{x }] The x-coordinates of the contour.
\item[\code{y }] The y-coordinates of the contour.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{options}{options}("max.contour.segments")} for the maximal
complexity of a single contour line.

\code{\LinkA{contour}{contour}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- 10*1:nrow(volcano)
y <- 10*1:ncol(volcano)
contourLines(x, y, volcano)
\end{ExampleCode}
\end{Examples}
\HeaderA{convertColor}{Convert between Colour Spaces}{convertColor}
\aliasA{colorspaces}{convertColor}{colorspaces}
\keyword{color}{convertColor}
%
\begin{Description}\relax
Convert colours between their representations in standard colour spaces.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
convertColor(color, from, to, from.ref.white, to.ref.white,
             scale.in=1, scale.out=1, clip=TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{color}] A matrix whose rows specify colors. 
\item[\code{from,to }] Input and output color spaces.  See `Details' below.
\item[\code{from.ref.white,to.ref.white}] Reference whites or \code{NULL}
if these are built in to the definition, as for RGB
spaces. \code{D65} is the default, see `Details' for others.

\item[\code{scale.in, scale.out}] Input is divided by \code{scale.in}, output
is multiplied by \code{scale.out}. Use \code{NULL} to suppress
scaling when input or output is not numeric.
\item[\code{clip}] If \code{TRUE}, truncate RGB output to [0,1],
\code{FALSE} return out-of-range RGB, \code{NA} set out of range
colors to \code{NaN}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Color spaces are specified by objects of class \code{colorConverter},
created by \code{\LinkA{colorConverter}{colorConverter}} or \code{\LinkA{make.rgb}{make.rgb}}.
Built-in color spaces may be referenced by strings: \code{"XYZ"},
\code{"sRGB"}, \code{"Apple RGB"}, \code{"CIE RGB"}, \code{"Lab"},
\code{"Luv"}. The converters for these colour spaces are in the object
\code{colorspaces}.

The \code{"sRGB"} color space is that used by standard PC monitors.
\code{"Apple RGB"} is used by Apple monitors. \code{"Lab"} and
\code{"Luv"} are approximately perceptually uniform
spaces standardized by the Commission Internationale
d'Eclairage. \code{XYZ} is a 1931 CIE standard capable of representing
all visible colors (and then some), but not in a perceptually uniform
way.

The \code{Lab} and \code{Luv} spaces describe colors of objects, and
so require the specification of a reference `white light'
color.  Illuminant \code{D65} is a standard indirect daylight,
Illuminant \code{D50} is close to direct sunlight, and Illuminant
\code{A} is the light from a standard incandescent bulb. Other
standard CIE illuminants supported are \code{B}, \code{C}, \code{E} and
\code{D55}.  RGB colour spaces are defined relative to a particular
reference white, and can be only approximately translated to other
reference whites.  The Bradford chromatic adaptation algorithm is used
for this.

The RGB color spaces are specific to a particular class of display.
An RGB space cannot represent all colors, and the \code{clip} option
controls what is done to out-of-range colors.
\end{Details}
%
\begin{Value}
A 3-row matrix whose columns specify the colors.
\end{Value}
%
\begin{References}\relax
For all the conversion equations \url{http://www.brucelindbloom.com/}.

For the white points
\url{http://www.efg2.com/Lab/Graphics/Colors/Chromaticity.htm}.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{col2rgb}{col2rgb}} and \code{\LinkA{colors}{colors}} for ways to specify
colors in graphics.

\code{\LinkA{make.rgb}{make.rgb}} for specifying other colour spaces.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics); require(stats) # for na.omit
par(mfrow=c(2,2))
## The displayable colors from four planes of Lab space
ab <- expand.grid(a=(-10:15)*10,b=(-15:10)*10)

Lab <- cbind(L=20,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=20")

Lab <- cbind(L=40,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=40")

Lab <- cbind(L=60,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=60")

Lab <- cbind(L=80,ab)
srgb <- convertColor(Lab,from="Lab",to="sRGB",clip=NA)
clipped <- attr(na.omit(srgb),"na.action")
srgb[clipped,] <- 0
cols <- rgb(srgb[,1],srgb[,2],srgb[,3])
image((-10:15)*10,(-15:10)*10,matrix(1:(26*26),ncol=26),col=cols,
  xlab="a",ylab="b",main="Lab: L=80")

(cols <- t(col2rgb(palette())))
zapsmall(lab <- convertColor(cols,from="sRGB",to="Lab",scale.in=255))
round(convertColor(lab,from="Lab",to="sRGB",scale.out=255))
\end{ExampleCode}
\end{Examples}
\HeaderA{densCols}{Colors for Smooth Density Plots}{densCols}
\aliasA{blues9}{densCols}{blues9}
\keyword{dplot}{densCols}
%
\begin{Description}\relax
\code{densCols} produces a vector containing colors which encode the
local densities at each point in a scatterplot.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
densCols(x, y = NULL, nbin = 128, bandwidth,
         colramp = colorRampPalette(blues9[-(1:3)]))
blues9
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the \code{x} and \code{y} arguments provide the x and y
coordinates of the points.  Any reasonable way of defining the
coordinates is acceptable.  See the function \code{\LinkA{xy.coords}{xy.coords}}
for details.  If supplied separately, they must be of the same length.
\item[\code{nbin}] numeric vector of length one (for both directions) or two
(for x and y separately) specifying the number of equally spaced
grid points for the density estimation; directly used as
\code{gridsize} in \code{\LinkA{bkde2D}{bkde2D}()}.
\item[\code{bandwidth}] numeric vector (length 1 or 2) of smoothing bandwidth(s).
If missing, a more or less useful default is used. \code{bandwidth}
is subsequently passed to function \code{\LinkA{bkde2D}{bkde2D}}.
\item[\code{colramp}] function accepting an integer \code{n} as an argument and
returning \code{n} colors.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{densCols} computes and returns the set of colors that will be
used in plotting, calling \code{\LinkA{bkde2D}{bkde2D}(*,
  bandwidth, gridsize=nbin, ..)} from package \Rhref{http://CRAN.R-project.org/package=KernSmooth}{\pkg{KernSmooth}}.

\code{blues9} is a set of 9 color shades of blue used as the default in
plotting.
\end{Details}
%
\begin{Value}
\code{densCols} returns a vector of length \code{nrow(x)} that
contains colors to be used in a subsequent scatterplot.  Each color
represents the local density around the corresponding point.
\end{Value}
%
\begin{Author}\relax
Florian Hahne at FHCRC, originally
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{bkde2D}{bkde2D}} from package \Rhref{http://CRAN.R-project.org/package=KernSmooth}{\pkg{KernSmooth}};
further, \code{\LinkA{smoothScatter}{smoothScatter}()} (package \pkg{graphics}) which
builds on the same computations as \code{densCols}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x1  <- matrix(rnorm(1e3), ncol=2)
x2  <- matrix(rnorm(1e3, mean=3, sd=1.5), ncol=2)
x   <- rbind(x1,x2)

dcols <- densCols(x)
graphics::plot(x, col = dcols, pch=20, main = "n = 1000")
\end{ExampleCode}
\end{Examples}
\HeaderA{dev}{Control Multiple Devices}{dev}
\methaliasA{dev.cur}{dev}{dev.cur}
\methaliasA{dev.list}{dev}{dev.list}
\methaliasA{dev.new}{dev}{dev.new}
\methaliasA{dev.next}{dev}{dev.next}
\methaliasA{dev.off}{dev}{dev.off}
\methaliasA{dev.prev}{dev}{dev.prev}
\methaliasA{dev.set}{dev}{dev.set}
\aliasA{graphics.off}{dev}{graphics.off}
\keyword{device}{dev}
\keyword{iplot}{dev}
%
\begin{Description}\relax
These functions provide control over multiple graphics devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.cur()
dev.list()
dev.next(which = dev.cur())
dev.prev(which = dev.cur())
dev.off(which = dev.cur())
dev.set(which = dev.next())
dev.new(...)
graphics.off()
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{which}] An integer specifying a device number.
\item[\code{...}] arguments to be passed to the device selected.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Only one device is the `active' device: this is the device in
which all graphics operations occur.  There is a \code{"null device"}
which is always open but is really a placeholder: any attempt to use
it will open a new device specified by
\code{\LinkA{getOption}{getOption}("device")}).

Devices are associated with a name (e.g., \code{"X11"} or
\code{"postscript"}) and a number in the range 1 to 63; the
\code{"null device"} is always device 1.  Once a device has been
opened the null device is not considered as a possible active device.
There is a list of open devices, and this is considered as a circular
list not including the null device.  \code{dev.next} and
\code{dev.prev} select the next open device in the appropriate
direction, unless no device is open.

\code{dev.off} shuts down the specified (by default the current)
device.  If the current device is shut down and any other devices are
open, the next open device is made current.  It is an error to
attempt to shut down device 1.  \code{graphics.off()} shuts down all
open graphics devices.  Normal termination of a session runs the
internal equivalent of \code{graphics.off()}.

\code{dev.set} makes the specified device the active device.  If there
is no device with that number, it is equivalent to \code{dev.next}.
If \code{which = 1} it opens a new device and selects that.

\code{dev.new} opens a new device.  Normally \R{} will open a new device
automatically when needed, but this enables you to open further
devices in a platform-independent way.  (For which device is used see
\code{\LinkA{getOption}{getOption}("device")}.)  Note that care is needed with
file-based devices such as \code{\LinkA{pdf}{pdf}} and
\code{\LinkA{postscript}{postscript}} and in that case file names such as
\file{Rplots.pdf}, \file{Rplots1.pdf}, \dots, \file{Rplots999.pdf} are
tried in turn.  Only named arguments are passed to the device, and
then only if they match the argument list of the device.  Even so,
care is needed with the interpretation of e.g. \code{width}, and for
the standard bitmap devices \code{units="in", res=72} is forced if
neither is supplied but both \code{width} and \code{height} are.
\end{Details}
%
\begin{Value}
\code{dev.cur} returns a length-one named integer vector giving the
number and name of the active device, or 1, the null device, if none
is active.

\code{dev.list} returns the numbers of all open devices, except device
1, the null device.  This is a numeric vector with a
\code{\LinkA{names}{names}} attribute giving the device names, or \code{NULL} is
there is no open device.

\code{dev.next} and \code{dev.prev} return the number and name of the
next / previous device in the list of devices.  This will be the null
device if and only if there are no open devices.

\code{dev.off} returns the number and name of the new active device
(after the specified device has been shut down).

\code{dev.set} returns the number and name of the new active device.

\code{dev.new} returns the return value of the device opened, usually
invisible \code{NULL}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, such as \code{\LinkA{postscript}{postscript}}, etc.

\code{\LinkA{layout}{layout}} and its links for setting up plotting regions
on the current device.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: ## Unix-specific example
x11()
plot(1:10)
x11()
plot(rnorm(10))
dev.set(dev.prev())
abline(0,1)# through the 1:10 points
dev.set(dev.next())
abline(h=0, col="gray")# for the residual plot
dev.set(dev.prev())
dev.off(); dev.off()#- close the two X devices

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{dev.capabilities}{Query Capabilities of the Current Graphics Device}{dev.capabilities}
\keyword{dplot}{dev.capabilities}
%
\begin{Description}\relax
Query the capabilities of the current graphics device.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.capabilities(what = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{what}] a character vector partially matching the names of the
components listed in section `Value', or \code{NULL} which
lists all available capabilities.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The capabilities have to be specified by the author of the graphics
device, unless they can be deduced from missing hooks.  Thus they will
often by returned as \code{NA}, and may reflect the maximal
capabilities of the underlying device where several output formats are
supported by one device.

Most recent devices support semi-transparent colours provided the
graphics format does (which PostScript does not).  On the other hand,
relatively few graphics formats support (fully or semi-) transparent
backgrounds: generally the latter is found only in PDF and PNG plots.
\end{Details}
%
\begin{Value}
A named list with some or all of the following components, any of which may
take value \code{NA}:
\begin{ldescription}
\item[\code{semiTransparency}] logical:  Does the device support
semi-transparent colours?
\item[\code{transparentBackground}] character:  Does the device support
(semi)-transparent backgrounds?  Possible values are \code{"no"},
\code{"fully"} (only full transparency) and \code{"semi"}
(semi-transparent background colours are supported).
\item[\code{rasterImage}] character: To what extent does the device support
raster images as used by \code{\LinkA{rasterImage}{rasterImage}} and
\code{\LinkA{grid.raster}{grid.raster}}?  Possible values \code{"no"}, \code{"yes"} and
\code{"non-missing"} (support only for arrays without any missing
values). 
\item[\code{capture}] logical:  Does the current device
support raster capture as used by \code{\LinkA{grid.cap}{grid.cap}}?
\item[\code{locator}] logical:  Does the current device
support \code{\LinkA{locator}{locator}} and \code{\LinkA{identify}{identify}}?
\item[\code{events}] character:  Which events can be generated on this device?
Currently this will be a subset of \code{c("MouseDown",
    "MouseMove", "MouseUp", "Keybd")}, but other events may be
supported in the future.  
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
See \code{\LinkA{getGraphicsEvent}{getGraphicsEvent}} for details on interactive events.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
dev.capabilities()
\end{ExampleCode}
\end{Examples}
\HeaderA{dev.capture}{Capture device output as a raster image}{dev.capture}
\keyword{dplot}{dev.capture}
%
\begin{Description}\relax
\code{dev.capture} captures the current contents of a graphics device
as a raster (bitmap) image.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.capture(native = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{native}] Logical. If \code{FALSE} the result is a matrix of R
color names, if \code{TRUE} the output is returned as a
\code{nativeRaster} object which is more efficient for plotting, but
not portable.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Not all devices support capture of the output as raster bitmaps.
Typically, only image-based devices do and even not all of them.
\end{Details}
%
\begin{Value}
\code{NULL} if the device does not support capture, otherwise a
matrix of color names (for \code{native = FALSE}) or a
\code{nativeRaster} object (for \code{native = TRUE}).
\end{Value}
\HeaderA{dev.flush}{Hold or Flush Output on an On-Screen Graphics Device.}{dev.flush}
\aliasA{dev.hold}{dev.flush}{dev.hold}
\keyword{dplot}{dev.flush}
%
\begin{Description}\relax
This gives a way to hold/flush output on certain on-screen devices,
and is ignored by other devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.hold(level = 1L)
dev.flush(level = 1L)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{level}] Integer >= 0.  The amount by which to change the hold
level.  Negative values will be silently replaced by zero.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Devices which implement this maintain a stack of hold levels: calling
\code{dev.hold} increases the level and \code{dev.flush} decreases it.
Calling \code{dev.hold} when the hold level is zero increases the hold
level and inhibits graphics display.  When calling \code{dev.flush}
clears all pending holds the screen display is refreshed and normal
operation is resumed.

This is implemented for the cairo-based \code{X11} types
with buffering.  When the hold level is positive the `watch'
cursor is set on the device's window.

It is available on the \code{quartz} device on Mac OS X.

This is implemented for the \code{windows} device with
buffering selected (the default).  When the hold level is positive the
`busy' cursor is set on the device's window.
\end{Details}
%
\begin{Value}
The current level after the change, invisibly.  This is \code{0} on
devices where hold levels are not supported.
\end{Value}
\HeaderA{dev.interactive}{Is the Current Graphics Device Interactive?}{dev.interactive}
\aliasA{deviceIsInteractive}{dev.interactive}{deviceIsInteractive}
\keyword{device}{dev.interactive}
%
\begin{Description}\relax
Test if the current graphics device (or that which would be opened) is
interactive.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.interactive(orNone = FALSE)

deviceIsInteractive(name = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{orNone}] logical; if \code{TRUE}, the function also returns
\code{TRUE} when \code{\LinkA{.Device}{.Device} == "null device"} and
\code{\LinkA{getOption}{getOption}("device")} is among the known
interactive devices.
\item[\code{name}] one or more device names as a character vector,
or \code{NULL} to give the existing list.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The \code{X11} (Unix), \code{windows} (Windows) and \code{quartz}
(Mac OS X, on-screen types only) are regarded as interactive, together
with \code{JavaGD} (from the package of the same name) and
\code{CairoWin} and \code{CairoX11} (from package \Rhref{http://CRAN.R-project.org/package=Cairo}{\pkg{Cairo}}).
Packages can add their devices to the list by calling
\code{deviceIsInteractive}.
\end{Details}
%
\begin{Value}
\code{dev.interactive()} returns a logical, \code{TRUE} if and only if an
interactive (screen) device is in use.

\code{deviceIsInteractive} returns the updated list of known
interactive devices, invisibly unless \code{name = NULL}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}} for the available devices on your platform.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
dev.interactive()
print(deviceIsInteractive(NULL))
\end{ExampleCode}
\end{Examples}
\HeaderA{dev.size}{ Find Size of Device Surface }{dev.size}
\keyword{dplot}{dev.size}
%
\begin{Description}\relax
Find the dimensions of the device surface of the current device.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.size(units = c("in", "cm", "px"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{units}] the units in which to return the value -- inches, cm, or
pixels (device units).
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A two-element numeric vector giving width and height of the current
device; a new device is opened if there is none, similarly to
\code{\LinkA{dev.new}{dev.new}()}.
\end{Value}
%
\begin{SeeAlso}\relax
The size information in inches can be obtained by
\code{\LinkA{par}{par}("din")}, but this provides a way to access it
independent of the graphics sub-system in use.  Note that
\code{par("din")} is only updated when a new plot is started, whereas
\code{dev.size} tracks the size as an on-screen device is resized. 
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
dev.size("cm")
\end{ExampleCode}
\end{Examples}
\HeaderA{dev2}{Copy Graphics Between Multiple Devices}{dev2}
\aliasA{dev.control}{dev2}{dev.control}
\aliasA{dev.copy}{dev2}{dev.copy}
\aliasA{dev.copy2eps}{dev2}{dev.copy2eps}
\aliasA{dev.copy2pdf}{dev2}{dev.copy2pdf}
\aliasA{dev.print}{dev2}{dev.print}
\keyword{device}{dev2}
%
\begin{Description}\relax
\code{dev.copy} copies the graphics contents of the current device
to the device specified by \code{which} or to a new device which has
been created by the function specified by \code{device} (it is an
error to specify both \code{which} and \code{device}).  (If recording
is off on the current device, there are no contents to copy: this will
result in no plot or an empty plot.)
The device copied to becomes the current device.

\code{dev.print} copies the graphics contents of the current device
to a new device which has been created by the function specified by
\code{device} and then shuts the new device.

\code{dev.copy2eps} is similar to \code{dev.print} but produces an
EPSF output file in portrait orientation (\code{horizontal = FALSE}).
\code{dev.copy2pdf} is the analogue for PDF output.

\code{dev.control} allows the user to control the recording of
graphics operations in a device.  If \code{displaylist} is \code{"inhibit"}
(\code{"enable"}) then recording is turned off (on). It is only safe
to change this at the beginning of a plot (just before or just after a
new page).  Initially recording is on for screen devices, and off for
print devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
dev.copy(device, ..., which = dev.next())
dev.print(device = postscript, ...)
dev.copy2eps(...)
dev.copy2pdf(..., out.type = "pdf")
dev.control(displaylist = c("inhibit", "enable"))
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{device}] A device function (e.g., \code{x11},
\code{postscript}, \ldots)
\item[\code{...}] Arguments to the \code{device} function above: for
\code{dev.copy2eps} arguments to \code{\LinkA{postscript}{postscript}} and for
\code{dev.copy2pdf}, arguments to \code{\LinkA{pdf}{pdf}}.
For \code{dev.print}, this includes \code{which} and by default any
\code{\LinkA{postscript}{postscript}} arguments.
\item[\code{which}] A device number specifying the device to copy to.
\item[\code{out.type}] The name of the output device: can be \code{"pdf"}, or
\code{"quartz"} (some Mac OS X builds) or \code{"cairo"} (Windows
and some Unix-alikes, see \code{\LinkA{cairo\_pdf}{cairo.Rul.pdf}}).
\item[\code{displaylist}] A character string: the only valid values are
\code{"inhibit"} and \code{"enable"}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Note that these functions copy the \emph{device region} and not a
plot: the background colour of the device surface is part of what is
copied.  Most screen devices default to a transparent background, which
is probably not what is needed when copying to a device such as
\code{\LinkA{png}{png}}.

For \code{dev.copy2eps} and \code{dev.copy2pdf}, \code{width} and
\code{height} are taken from the current device unless otherwise
specified.  If just one of \code{width} and \code{height} is
specified, the other is adjusted to preserve the aspect ratio of the
device being copied.  The default file name is \code{Rplot.eps} or
\code{Rplot.pdf}, and can be overridden by specifying a \code{file}
argument.

Copying to devices such as \code{\LinkA{postscript}{postscript}} and
\code{\LinkA{pdf}{pdf}} which need font families pre-specified needs extra
care -- \R{} is unaware of which families were used in a plot and so
they will need to manually specified by the \code{fonts} argument
passed as part of \code{...}.  Similarly, if the device to be copied
from was opened with a \code{family} argument, a suitable
\code{family} argument will need to be included in \code{...}.

The default for \code{dev.print} is to produce and print a postscript
copy.  This will not work unless \code{\LinkA{options}{options}("printcmd")} is
set suitably and you have a PostScript printing system: see
\code{\LinkA{postscript}{postscript}} for how to set this up.  Windows users may
prefer to use \code{dev.print(win.print)}.

\code{dev.print} is most useful for producing a postscript print
(its default) when the following applies.  Unless
\code{file} is specified, the plot will be printed.  Unless
\code{width}, \code{height} and \code{pointsize} are specified
the plot dimensions will be taken from the current device, shrunk
if necessary to fit on the paper. (\code{pointsize} is rescaled if the
plot is shrunk.)  If \code{horizontal} is not specified and the plot
can be printed at full size by switching its value this is done
instead of shrinking the plot region.

If \code{dev.print} is used with a specified \code{device} (even
\code{postscript}) it sets the width and height in the same way as
\code{dev.copy2eps}.  This will not be appropriate unless the device
specifies dimensions in inches, in particular not for
\code{png}, \code{jpeg}, \code{tiff} and \code{bmp} unless
\code{units="inches"} is specified.
\end{Details}
%
\begin{Value}
\code{dev.copy} returns the name and number of the device which has
been copied to.

\code{dev.print}, \code{dev.copy2eps} and \code{dev.copy2pdf} return
the name and number of the device which has been copied from.
\end{Value}
%
\begin{Note}\relax
Most devices (including all screen devices) have a display list
which records all of the graphics operations that occur in the device.
\code{dev.copy} copies graphics contents by copying the display list
from one device to another device.  Also, automatic redrawing of
graphics contents following the resizing of a device depends on the
contents of the display list.

After the command \code{dev.control("inhibit")}, graphics operations
are not recorded in the display list so that \code{dev.copy} and
\code{dev.print} will not copy anything and the contents of a device
will not be redrawn automatically if the device is resized.

The recording of graphics operations is relatively expensive in
terms of memory so the command \code{dev.control("inhibit")} can be
useful if memory usage is an issue.
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{dev.cur}{dev.cur}} and other \code{dev.xxx} functions.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
x11() # on a Unix-alike
plot(rnorm(10), main="Plot 1")
dev.copy(device=x11)
mtext("Copy 1", 3)
dev.print(width=6, height=6, horizontal=FALSE) # prints it
dev.off(dev.prev())
dev.off()

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{dev2bitmap}{Graphics Device for Bitmap Files via Ghostscript}{dev2bitmap}
\aliasA{bitmap}{dev2bitmap}{bitmap}
\keyword{utilities}{dev2bitmap}
%
\begin{Description}\relax
\code{bitmap} generates a graphics file.
\code{dev2bitmap} copies the current graphics device to a file in a
graphics format.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
bitmap(file, type = "png16m", height = 7, width = 7, res = 72,
       units = "in", pointsize, taa = NA, gaa = NA, ...)

dev2bitmap(file, type = "png16m", height = 7, width = 7, res = 72,
           units = "in", pointsize, ...,
           method = c("postscript", "pdf"), taa = NA, gaa = NA)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] The output file name, with an appropriate extension.
\item[\code{type}] The type of bitmap.
\item[\code{width, height}] Dimensions of the display region.
\item[\code{res}] Resolution, in dots per inch.
\item[\code{units}] The units in which \code{height} and \code{width} are
given.  Can be \code{in} (inches), \code{px} (pixels), \code{cm} or
\code{mm}.
\item[\code{pointsize}] The pointsize to be used for text: defaults to
something reasonable given the width and height
\item[\code{...}] Other parameters passed to \code{\LinkA{postscript}{postscript}} or
\code{\LinkA{pdf}{pdf}}.
\item[\code{method}] Should the plot be done by \code{\LinkA{postscript}{postscript}} or
\code{\LinkA{pdf}{pdf}}?
\item[\code{taa, gaa}] Number of bits of antialiasing for text and for graphics
respectively.  Usually 4 (for best effect) or 2.  Not supported on
all types.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{dev2bitmap} works by copying the current device to a
\code{\LinkA{postscript}{postscript}} or \code{\LinkA{pdf}{pdf}} device, and
post-processing the output file using \code{ghostscript}.
\code{bitmap} works in the same way using a \code{postscript} device
and post-processing the output as `printing'.

You will need \code{ghostscript}: the full path to the executable can
be set by the environment variable \env{R\_GSCMD}. If this is unset, a
GhostScript executable will be looked for by name on your path: on a
Unix alike \code{"gs"} is used, and on Windows the setting of the
environment variable \env{GSC} is used, otherwise commands
\code{"gswi64c.exe"} then \code{"gswin32c.exe"} are tried.

The types available will depend on the version of \code{ghostscript},
but are likely to include
\code{"pcxmono"}, \code{"pcxgray"}, \code{"pcx16"}, \code{"pcx256"},
\code{"pcx24b"}, \code{"pcxcmyk"}, \code{"pbm"}, \code{"pbmraw"},
\code{"pgm"}, \code{"pgmraw"}, \code{"pgnm"}, \code{"pgnmraw"},
\code{"pnm"}, \code{"pnmraw"}, \code{"ppm"}, \code{"ppmraw"},
\code{"pkm"}, \code{"pkmraw"}, \code{"tiffcrle"}, \code{"tiffg3"},
\code{"tiffg32d"}, \code{"tiffg4"}, \code{"tifflzw"},
\code{"tiffpack"}, \code{"tiff12nc"}, \code{"tiff24nc"}, \code{"tiff32nc"}
\code{"psmono"}, \code{"psgray"}, \code{"psrgb"}, \code{"bit"},
\code{"bitrgb"}, \code{"bitcmyk"}, \code{"pngmono"}, \code{"pnggray"},
\code{"pngalpha"}, \code{"png16"}, \code{"png256"}, \code{"png16m"},
\code{"png48"}, \code{"jpeg"}, \code{"jpeggray"}, \code{"pdfwrite"}.

The default type, \code{"png16m"}, supports 24-bit colour and
anti-aliasing.  Versions of \R{} prior to 2.7.0 defaulted to
\code{"png256"}, which uses a palette of 256 colours and could be a
more compact representation.  Monochrome graphs can use
\code{"pngmono"}, or \code{"pnggray"} if anti-aliasing is desired.
Plots with a transparent background and varying degrees of
transparency should use \code{"pngalpha"}.

Note that for a colour TIFF image you probably want \code{"tiff24nc"},
which is 8-bit per channel RGB (the most common TIFF format).  None of
the listed TIFF types support transparency.  \code{"tiff32nc"} uses
8-bit per channel CMYK, which printers might require.

For formats which contain a single image, a file specification like
\code{Rplots\%03d.png} can be used: this is interpreted by Ghostscript.

For \code{dev2bitmap} if just one of \code{width} and \code{height} is
specified, the other is chosen to preserve aspect ratio of the
device being copied.  The main reason to prefer \code{method = "pdf"}
over the default would be to allow semi-transparent colours to be used.

For graphics parameters such as \code{"cra"} that need to work in
pixels, the default resolution of 72dpi is always used.

Paths for \code{file} and \env{R\_GSCMD} which contain spaces are
mapped to short names \emph{via} \code{\LinkA{shortPathName}{shortPathName}}.
\end{Details}
%
\begin{Value}
None.
\end{Value}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.  These
devices follow the underlying device, so when viewed at the stated
\code{res}:

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is (for the standard Ghostscript
setup) URW Nimbus Sans.
\item Line widths are as a multiple of 1/96 inch, with no minimum. 
\item Circle of any radius are allowed.
\item Colours are interpreted by the viewing/printing application.

\end{itemize}

\end{Section}
%
\begin{Note}\relax
Use of \code{bitmap} will leave a temporary file (with file name
starting \code{Rbit}).

Although using \code{type = "pdfwrite"} will work for simple plots, it
is not recommended.  Either use \code{\LinkA{pdf}{pdf}} to produce PDF
directly, or call \command{ps2pdf -dAutoRotatePages=/None} on the
output of \code{\LinkA{postscript}{postscript}}: that command is optimized to do
the conversion to PDF in ways that these functions are not.
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{savePlot}{savePlot}}, which for \code{windows} and
\code{X11(type = "cairo")} provides a simple way to record a PNG
record of the current plot.

\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf}{pdf}}, \code{\LinkA{png}{png}},
\code{\LinkA{jpeg}{jpeg}}, \code{\LinkA{tiff}{tiff}} and  \code{bmp}.

To display an array of data, see \code{\LinkA{image}{image}}.
\end{SeeAlso}
\HeaderA{devAskNewPage}{ Prompt before New Page }{devAskNewPage}
\keyword{dplot}{devAskNewPage}
%
\begin{Description}\relax
This function can be used to control (for the current device)
whether the user is prompted before starting a new page of output.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
devAskNewPage(ask = NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{ask}] \code{NULL} or a logical value.  If \code{TRUE}, the user
will in future be prompted before a new page of output is started.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If the current device is the null device, this will open a graphics device.

The default argument just returns the current setting and does not
change it.

The default value when a device is opened is taken from the
setting of \code{\LinkA{options}{options}("device.ask.default")}.

The precise circumstances when the user will be asked to confirm a new
page depend on the graphics subsystem.  Obviously this needs to be an
interactive session.  In addition `recording' needs to be in
operation, so only when the display list is enabled (see
\code{\LinkA{dev.control}{dev.control}}) which it usually is only on a screen device.
\end{Details}
%
\begin{Value}
The current prompt setting \emph{before} any new setting is applied.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.new}{plot.new}}, \code{\LinkA{grid.newpage}{grid.newpage}}
\end{SeeAlso}
\HeaderA{Devices}{List of Graphical Devices}{Devices}
\aliasA{device}{Devices}{device}
\keyword{device}{Devices}
%
\begin{Description}\relax
The following graphics devices are currently available:
\begin{itemize}

\item \code{\LinkA{windows}{windows}} The graphics device for Windows (on screen,
to printer and to Windows metafile).
\item \code{\LinkA{pdf}{pdf}} Write PDF graphics commands to a file
\item \code{\LinkA{postscript}{postscript}} Writes PostScript graphics commands to
a file
\item \code{\LinkA{xfig}{xfig}} Device for XFIG graphics file format
\item \code{\LinkA{bitmap}{bitmap}} bitmap pseudo-device via
\code{Ghostscript} (if available).
\item \code{\LinkA{pictex}{pictex}} Writes TeX/PicTeX graphics commands to a
file (of historical interest only)

\end{itemize}

The following devices will be functional if \R{} was compiled to use
them (they exist but will return with a warning on other systems):
\begin{itemize}

\item \code{\LinkA{cairo\_pdf}{cairo.Rul.pdf}}, \code{cairo\_ps} PDF and PostScript
devices based on cairo graphics.
\item \code{\LinkA{svg}{svg}} SVG device based on cairo graphics.
\item \code{\LinkA{png}{png}} PNG bitmap device
\item \code{\LinkA{jpeg}{jpeg}} JPEG bitmap device
\item \code{\LinkA{bmp}{bmp}} BMP bitmap device
\item \code{\LinkA{tiff}{tiff}} TIFF bitmap device

\end{itemize}

\end{Description}
%
\begin{Details}\relax
If no device is open, using a high-level graphics function will cause
a device to be opened.  Which device is given by
\code{\LinkA{options}{options}("device")} which is initially set as the most
appropriate for each platform: a screen device for most interactive use and
\code{\LinkA{pdf}{pdf}} (or the setting of \env{R\_DEFAULT\_DEVICE})
otherwise.  The exception is interactive use under Unix if no screen
device is known to be available, when \code{pdf()} is used.

It is possible for an \R{} package to provide further graphics devices
and several packages on CRAN do so.  These include other devices outputting
SVG and PGF/TiKZ (TeX-based graphics, see \url{http://pgf.sourceforge.net/}).
\end{Details}
%
\begin{SeeAlso}\relax
The individual help files for further information on any of the
devices listed here;
\code{\LinkA{windows.options}{windows.options}},
\code{\LinkA{ps.options}{ps.options}} and \code{\LinkA{pdf.options}{pdf.options}} for how to
customize devices.

\code{\LinkA{dev.interactive}{dev.interactive}},
\code{\LinkA{dev.cur}{dev.cur}}, \code{\LinkA{dev.print}{dev.print}},
\code{\LinkA{graphics.off}{graphics.off}}, \code{\LinkA{image}{image}},
\code{\LinkA{dev2bitmap}{dev2bitmap}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## open the default screen device on this platform if no device is
## open
if(dev.cur() == 1) dev.new()

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{embedFonts}{Embed Fonts in PostScript and PDF}{embedFonts}
\keyword{device}{embedFonts}
%
\begin{Description}\relax
Runs Ghostscript to process a PDF or PostScript file and
embed all fonts in the file.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
embedFonts(file, format, outfile = file, fontpaths = "",
           options = "")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the original file.
\item[\code{format}] either \code{"pswrite"} or \code{"pdfwrite"}.
If not specified, it is guessed from the suffix of \code{file}.
\item[\code{outfile}] the name of the new file (with fonts embedded).
\item[\code{fontpaths}] a character vector giving directories that
Ghostscript will search for fonts.
\item[\code{options}] a character string containing further options to
Ghostscript.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This function is not necessary if you just use the standard
default fonts for PostScript and PDF output.

If you use a special font, this function is useful for
embedding that font in your PostScript or PDF document
so that it can be shared with others without them having
to install your special font (provided the font licence allows this).

If the special font is not installed for Ghostscript,
you will need to tell Ghostscript where the font is, using
something like \code{options="-sFONTPATH=path/to/font"}.

You will need \code{ghostscript}: the full path to the executable can
be set by the environment variable \env{R\_GSCMD}. If this is
unset, a GhostScript executable will be looked for by name on your
path: on a Unix alike \code{"gs"} is used, and on Windows the setting
of the environment variable \env{GSC} is used, otherwise commands
\code{"gswi64c.exe"} then \code{"gswin32c.exe"} are tried.

Note that Ghostscript may do font substitution, so the font embedded
may differ from that specified in the original file.

Some other options which can be useful (see your Ghostscript
documentation) are \option{-dMaxSubsetPct=100},
\option{-dSubsetFonts=true} and  \option{-dEmbedAllFonts=true}.
\end{Details}
%
\begin{Value}
The shell command used to invoke Ghostscript is returned
invisibly. This may be useful for debugging purposes as
you can run the command by hand in a shell to look for problems.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscriptFonts}{postscriptFonts}},
\code{\LinkA{Devices}{Devices}}.

Paul Murrell and Brian Ripley (2006) Non-standard fonts in PostScript
and PDF graphics. \emph{R News}, 6(2):41--47.
\url{http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf}.
\end{SeeAlso}
\HeaderA{extendrange}{Extend a Numerical Range by a Small Percentage}{extendrange}
\keyword{dplot}{extendrange}
%
\begin{Description}\relax
Extends a numerical range by a small percentage, i.e., fraction,
\emph{on both sides}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
extendrange(x, r = range(x, na.rm = TRUE), f = 0.05)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] numeric vector; not used if \code{r} is specified.
\item[\code{r}] numeric vector of length 2; defaults to the
\code{\LinkA{range}{range}} of \code{x}.
\item[\code{f}] number specifying the fraction by which the range should be
extended.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A numeric vector of length 2, \code{r + c(-f,f) * diff(r)}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{range}{range}}; \code{\LinkA{pretty}{pretty}} which can be
considered a sophisticated extension of \code{extendrange}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
x <- 1:5
(r <- range(x))         # 1    5
extendrange(x)          # 0.8  5.2
extendrange(x, f= 0.01) # 0.96 5.04
## Use 'r' if you have it already:
stopifnot(identical(extendrange(r=r),
                    extendrange(x)))
\end{ExampleCode}
\end{Examples}
\HeaderA{getGraphicsEvent}{Wait for a mouse or keyboard event from a graphics window}{getGraphicsEvent}
\aliasA{getGraphicsEventEnv}{getGraphicsEvent}{getGraphicsEventEnv}
\aliasA{setGraphicsEventEnv}{getGraphicsEvent}{setGraphicsEventEnv}
\aliasA{setGraphicsEventHandlers}{getGraphicsEvent}{setGraphicsEventHandlers}
\keyword{iplot}{getGraphicsEvent}
%
\begin{Description}\relax
This function waits for input from a graphics window in the
form of a mouse or keyboard event.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
getGraphicsEvent(prompt = "Waiting for input", 
                 onMouseDown = NULL, onMouseMove = NULL,
                 onMouseUp = NULL, onKeybd = NULL,
                 consolePrompt = prompt)
setGraphicsEventHandlers(which = dev.cur(), ...)
getGraphicsEventEnv(which = dev.cur())
setGraphicsEventEnv(which = dev.cur(), env)

\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{prompt}] prompt to be displayed to the user in the graphics window
\item[\code{onMouseDown}] a function to respond to mouse clicks
\item[\code{onMouseMove}] a function to respond to mouse movement
\item[\code{onMouseUp}] a function to respond to mouse button releases
\item[\code{onKeybd}] a function to respond to key presses
\item[\code{consolePrompt}] prompt to be displayed to the user in the console
\item[\code{which}] which graphics device does the call apply to?
\item[\code{...}] items including handlers to be placed in the event environment
\item[\code{env}] an environment to be used as the event environment
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
These functions allow user input from some graphics devices (currently
only the \code{windows()} and \code{X11(type="Xlib")} screen displays
in base \R{}). Event handlers may be installed to respond to events
involving the mouse or keyboard.

The functions are related as follows.  If any of the first five
arguments to \code{getGraphicsEvent} are given, then it uses those
in a call to \code{setGraphicsEventHandlers} to replace any existing
handlers in the current device.  This is for compatibility with pre-2.12.0 \R{}
versions.  The current normal way to set up event handlers is to 
set them using \code{setGraphicsEventHandlers} or \code{setGraphicsEventEnv} on
one or more graphics devices, and then use \code{getGraphicsEvent()} with
no arguments to retrieve event data.
\code{getGraphicsEventEnv()} may be used to save the event environment
for use later.

The names of the arguments in \code{getGraphicsEvent} are special.  When
handling events, the graphics system will look through the event 
environment for functions named \code{onMouseDown}, \code{onMouseMove}, \code{onMouseUp}
and \code{onKeybd} and use them as event handlers.  It will use 
\code{prompt} for a label on the graphics device.  Two other special names are
\code{which}, which will identify the graphics device, and
\code{result}, where the result of the last event
handler will be stored before being returned by \code{getGraphicsEvent()}.

The mouse event handlers should be functions with header 
\code{function(buttons, x, y)}.  The coordinates \code{x}
and \code{y} will be passed to mouse event handlers in device independent
coordinates (i.e. the lower left corner of the window is \code{(0,0)}, 
the upper right is \code{(1,1)}).  The \code{buttons} argument 
will be a vector listing the buttons
that are pressed at the time of the event, with 0 for left, 1 for middle, and 2 
for right.

The keyboard event handler should be a function with header
\code{function(key)}.  A single element character vector will be passed
to this handler, corresponding to the key press.  Shift and other modifier
keys will have been processed, so \code{shift-a} will be passed as
\code{"A"}.  The following special keys may also be passed to the handler:
\begin{itemize}

\item Control keys, passed as \code{"Ctrl-A"}, etc.
\item Navigation keys, passed as one of \code{"Left", "Up", "Right", "Down",
     "PgUp", "PgDn", "End", "Home"}
\item Edit keys, passed as one of \code{"Ins", "Del"}
\item Function keys, passed as one of \code{"F1", "F2", ...}

\end{itemize}


The event handlers are standard R functions, and will be executed as though called
from the event environment.  

In an interactive session, events will be processed until
\begin{itemize}

\item one of the event handlers returns
a non-\code{NULL} value which will be returned as the value of
\code{getGraphicsEvent}, or 
\item the user interrupts the function from the
console.

\end{itemize}

\end{Details}
%
\begin{Value}
When run interactively, 
\code{getGraphicsEvent} returns a non-\code{NULL} value returned from one of the event handlers.
In a non-interactive session, \code{getGraphicsEvent} will return \code{NULL} immediately.

\code{getGraphicsEventEnv} returns the current event environment for the graphics device,
or \code{NULL} if none has been set.

\code{setGraphicsEventEnv} and \code{setGraphicsEventHandlers} return the previous
event environment for the graphics device.
\end{Value}
%
\begin{Author}\relax
Duncan Murdoch
\end{Author}
%
\begin{Examples}
\begin{ExampleCode}

savepar <- par(ask=FALSE)
dragplot <- function(..., xlim=NULL, ylim=NULL, xaxs="r", yaxs="r") {
    plot(..., xlim=xlim, ylim=ylim, xaxs=xaxs, yaxs=yaxs)
    startx <- NULL
    starty <- NULL
    usr <- NULL

    devset <- function()
        if (dev.cur() != eventEnv$which) dev.set(eventEnv$which)
        
    dragmousedown <- function(buttons, x, y) {
        startx <<- x
        starty <<- y
        devset()
        usr <<- par("usr")
        eventEnv$onMouseMove <- dragmousemove
        NULL
    }
    
    dragmousemove <- function(buttons, x, y) {
        devset()
        deltax <- diff(grconvertX(c(startx,x), "ndc", "user"))
        deltay <- diff(grconvertY(c(starty,y), "ndc", "user"))
        plot(..., xlim=usr[1:2]-deltax, xaxs="i",
                  ylim=usr[3:4]-deltay, yaxs="i")
        NULL
    }
    
    mouseup <- function(buttons, x, y) {    
    	eventEnv$onMouseMove <- NULL
    }	
        
    keydown <- function(key) {
        if (key == "q") return(invisible(1))
        eventEnv$onMouseMove <- NULL
        NULL
    }
    
    setGraphicsEventHandlers(prompt="Click and drag, hit q to quit",
                     onMouseDown = dragmousedown,
                     onMouseUp = mouseup,
                     onKeybd = keydown)
    eventEnv <- getGraphicsEventEnv()
}

dragplot(rnorm(1000), rnorm(1000))
# This currently only works on the Windows
# and X11(type = "Xlib") screen devices...
getGraphicsEvent()
par(savepar)

\end{ExampleCode}
\end{Examples}
\HeaderA{gray}{Gray Level Specification}{gray}
\aliasA{grey}{gray}{grey}
\keyword{color}{gray}
%
\begin{Description}\relax
Create a vector of colors from a vector of gray levels.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
gray(level)
grey(level)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{level}] a vector of desired gray levels between \code{0} and
\code{1}; zero indicates \code{"black"} and one indicates
\code{"white"}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The values returned by \code{gray} can be used with a \code{col=}
specification in graphics functions or in \code{\LinkA{par}{par}}.

\code{grey} is an alias for \code{gray}.
\end{Details}
%
\begin{Value}
A vector of colors of the same length as \code{level}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{hsv}{hsv}},
\code{\LinkA{hcl}{hcl}},
\code{\LinkA{rgb}{rgb}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
gray(0:8 / 8)
\end{ExampleCode}
\end{Examples}
\HeaderA{gray.colors}{Gray Color Palette}{gray.colors}
\aliasA{grey.colors}{gray.colors}{grey.colors}
\keyword{color}{gray.colors}
%
\begin{Description}\relax
Create a vector of \code{n} gamma-corrected gray colors.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
gray.colors(n, start = 0.3, end = 0.9, gamma = 2.2)
grey.colors(n, start = 0.3, end = 0.9, gamma = 2.2)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{n}] the number of gray colors (\eqn{\ge 1}{}) to be in the
palette.
\item[\code{start}] starting gray level in the palette (should be between
\code{0} and \code{1} where zero indicates \code{"black"} and one
indicates \code{"white"}).
\item[\code{end}] ending gray level in the palette.
\item[\code{gamma}] the gamma correction.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The function \code{gray.colors} chooses a series of \code{n}
gamma-corrected gray levels between \code{start} and \code{end}:
\code{seq(start\textasciicircum{}gamma, end\textasciicircum{}gamma, length = n)\textasciicircum{}(1/gamma)}.
The returned palette contains the corresponding gray colors.
This palette is used in \code{\LinkA{barplot.default}{barplot.default}}.

\code{grey.colors} is an alias for \code{gray.colors}.
\end{Details}
%
\begin{Value}
A vector of \code{n} gray colors.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{gray}{gray}},
\code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{palette}{palette}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

pie(rep(1,12), col = gray.colors(12))
barplot(1:12, col = gray.colors(12))
\end{ExampleCode}
\end{Examples}
\HeaderA{hcl}{HCL Color Specification}{hcl}
\keyword{color}{hcl}
\keyword{dplot}{hcl}
%
\begin{Description}\relax
Create a vector of colors from vectors specifying hue,
chroma and luminance.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
hcl(h = 0, c = 35, l = 85, alpha, fixup = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{h}] The hue of the color specified as an angle in the range
[0,360].  0 yields red, 120 yields green 240 yields blue, etc.
\item[\code{c}] The chroma of the color.  The upper bound for chroma depends
on hue and luminance.
\item[\code{l}] A value in the range [0,100] giving the luminance of the
colour.  For a given combination of hue and chroma, only
a subset of this range is possible.
\item[\code{alpha}] numeric vector of values in the range \code{[0,1]} for
alpha transparency channel (0 means transparent and 1 means opaque).
\item[\code{fixup}] a logical value which indicates whether the resulting
RGB values should be corrected to ensure that a real color results.
if \code{fixup} is \code{FALSE} RGB components lying outside the
range [0,1] will result in an \code{NA} value.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This function corresponds to polar coordinates in the CIE-LUV
color space. Steps of equal size in this space correspond to
approximately equal perceptual changes in color.  Thus, \code{hcl}
can be thought of as a perceptually based version of \code{\LinkA{hsv}{hsv}}.

The function is primarily intended as a way of computing
colors for filling areas in plots where area corresponds to a
numerical value (pie charts, bar charts, mosaic plots, histograms,
etc).  Choosing colors which have equal chroma and luminance
provides a way of minimising the irradiation illusion which
would otherwise produce a misleading impression of how large
the areas are.

The default values of chroma and luminance make it possible
to generate a full range of hues and have a relatively pleasant
pastel appearance.

The RGB values produced by this function correspond to the sRGB
color space used on most PC computer displays.  There are other
packages which provide more general color space facilities.

Semi-transparent colors (\code{0 < alpha < 1}) are supported only on
some devices: see \code{\LinkA{rgb}{rgb}}.
\end{Details}
%
\begin{Value}
A vector of character strings which can be used as color
specifications by R graphics functions.
\end{Value}
%
\begin{Note}\relax
At present there is no guarantee that the colours rendered by R
graphics devices will correspond to their sRGB description.
It is planned to adopt sRGB as the standard R color description
in future.
\end{Note}
%
\begin{Author}\relax
Ross Ihaka
\end{Author}
%
\begin{References}\relax
Ihaka, R. (2003).
Colour for Presentation Graphics, Proceedings of the 3rd International
Workshop on Distributed Statistical Computing (DSC 2003), March 20-22,
2003, Technische Universitt Wien, Vienna, Austria.
\url{http://www.ci.tuwien.ac.at/Conferences/DSC-2003}.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{hsv}{hsv}},
\code{\LinkA{rgb}{rgb}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

# The Foley and Van Dam PhD Data.
csd <- matrix(c( 4,2,4,6, 4,3,1,4, 4,7,7,1,
                 0,7,3,2, 4,5,3,2, 5,4,2,2,
                 3,1,3,0, 4,4,6,7, 1,10,8,7,
                 1,5,3,2, 1,5,2,1, 4,1,4,3,
                 0,3,0,6, 2,1,5,5), nrow=4)

csphd <- function(colors)
  barplot(csd, col = colors, ylim = c(0,30),
          names = 72:85, xlab = "Year", ylab = "Students",
          legend = c("Winter", "Spring", "Summer", "Fall"),
          main = "Computer Science PhD Graduates", las = 1)

# The Original (Metaphorical) Colors (Ouch!)
csphd(c("blue", "green", "yellow", "orange"))

# A Color Tetrad (Maximal Color Differences)
csphd(hcl(h = c(30, 120, 210, 300)))

# Same, but lighter and less colorful
# Turn off automatic correction to make sure
# that we have defined real colors.
csphd(hcl(h = c(30, 120, 210, 300),
          c = 20, l = 90, fixup = FALSE))

# Analogous Colors
# Good for those with red/green color confusion
csphd(hcl(h = seq(60, 240, by = 60)))

# Metaphorical Colors
csphd(hcl(h = seq(210, 60, length = 4)))

# Cool Colors
csphd(hcl(h = seq(120, 0, length = 4) + 150))

# Warm Colors
csphd(hcl(h = seq(120, 0, length = 4) - 30))

# Single Color
hist(stats::rnorm(1000), col = hcl(240))
\end{ExampleCode}
\end{Examples}
\HeaderA{Hershey}{Hershey Vector Fonts in R}{Hershey}
\keyword{aplot}{Hershey}
%
\begin{Description}\relax
If the \code{family} graphical parameter (see \code{\LinkA{par}{par}})
has been set to one of the Hershey fonts (see `Details')
Hershey vector fonts are used to render text.

When using the \code{\LinkA{text}{text}} and \code{\LinkA{contour}{contour}} functions
Hershey fonts may be selected via the \code{vfont} argument, which is
a character vector of length 2 (see `Details' for valid
values).  This allows Cyrillic to be selected, which is not available
via the font families.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
Hershey
\end{verbatim}
\end{Usage}
%
\begin{Details}\relax
The Hershey fonts have two advantages:\\{}
\begin{enumerate}

\item vector fonts describe each
character in terms of a set of points;  \R{} renders the character by
joining up the points with straight lines.  This intimate knowledge of
the outline of each character means that \R{} can arbitrarily transform
the characters, which can mean that the vector fonts look better
for rotated text.
\item this implementation was adapted from the GNU libplot library
which provides support for non-ASCII and non-English fonts.  This means
that it is possible, for example, to produce weird plotting symbols and
Japanese characters.

\end{enumerate}

Drawback:\\{}
You cannot use mathematical expressions (\code{\LinkA{plotmath}{plotmath}}) with
Hershey fonts.

The Hershey characters are organised into a set of fonts.  A
particular font is selected by specifying one of the following
font families via \code{par(family)} and specifying the desired font
face (plain, bold, italic, bold-italic) via \code{par(font)}.



\Tabular{ll}{
family & faces available \\{}
\code{"HersheySerif"} & plain, bold, italic, bold-italic \\{}
\code{"HersheySans"} & plain, bold, italic, bold-italic \\{}
\code{"HersheyScript"} & plain, bold \\{}
\code{"HersheyGothicEnglish"} & plain \\{}
\code{"HersheyGothicGerman"} & plain \\{}
\code{"HersheyGothicItalian"} & plain \\{}
\code{"HersheySymbol"} & plain, bold, italic, bold-italic \\{}
\code{"HersheySansSymbol"} & plain, italic \\{}
}

In the \code{vfont} specification for the \code{text} and
\code{contour} functions, the Hershey font is specified by a typeface
(e.g., \code{serif} or \code{sans serif}) and a fontindex or
`style' (e.g., \code{plain} or \code{italic}). The first
element of \code{vfont} specifies the typeface and the second element
specifies the fontindex.  The first table produced by
\code{demo(Hershey)} shows the character \code{a} produced by each of
the different fonts.

The available \code{typeface} and \code{fontindex} values are
available as list components of the variable \code{Hershey}.
The allowed pairs for \code{(typeface, fontindex)} are:




\Tabular{ll}{
serif & plain \\{}
serif & italic \\{}
serif & bold \\{}
serif & bold italic \\{}
serif & cyrillic \\{}
serif & oblique cyrillic \\{}
serif & EUC \\{}
sans serif & plain \\{}
sans serif & italic \\{}
sans serif & bold \\{}
sans serif & bold italic \\{}
script & plain \\{}
script & italic \\{}
script & bold \\{}
gothic english & plain \\{}
gothic german & plain \\{}
gothic italian & plain \\{}
serif symbol & plain \\{}
serif symbol & italic \\{}
serif symbol & bold \\{}
serif symbol & bold italic \\{}
sans serif symbol & plain \\{}
sans serif symbol & italic \\{}
}
and the indices of these are available as \code{Hershey\$allowed}.

\begin{description}

\item[Escape sequences:] The string to be drawn can include escape
sequences, which all begin with a \samp{\bsl{}}.   When \R{} encounters a
\samp{\bsl{}}, rather than drawing the \samp{\bsl{}}, it treats the
subsequent character(s) as a coded description of what to draw.

One useful escape sequence (in the current context) is of the
form: \samp{\bsl{}123}.  The three digits following the \samp{\bsl{}}
specify an octal code for a character.  For example, the octal
code for \code{p} is 160 so the strings \code{"p"} and
\code{"\bsl{}160"} are equivalent. This is useful for producing
characters when there is not an appropriate key on your keyboard.

The other useful escape sequences all begin with \samp{\bsl{}\bsl{}}.
These are described below.  Remember that backslashes have to be
doubled in \R{} character strings, so they need to be entered with
\emph{four} backslashes.


\item[Symbols:] an entire string of Greek symbols can be produced by
selecting the HersheySymbol or HersheySansSymbol family or the
Serif Symbol or Sans Serif Symbol typeface.  To allow Greek
symbols to be embedded in a string which uses a non-symbol
typeface, there are a set of symbol escape sequences of the form
\samp{\bsl{}\bsl{}ab}. For example, the escape sequence \samp{\bsl{}\bsl{}*a}
produces a Greek alpha.  The second table in \code{demo(Hershey)}
shows all of the symbol escape sequences and the symbols that they
produce.


\item[ISO Latin-1:] further escape sequences of the form
\samp{\bsl{}\bsl{}ab} are provided for producing ISO Latin-1 characters.
Another option is to use the appropriate octal code.  The
(non-ASCII) ISO Latin-1 characters are in the range 241\dots377.
For example, \samp{\bsl{}366} produces the character o with an umlaut.
The third table in \code{demo(Hershey)} shows all of the ISO
Latin-1 escape sequences.

These characters can be used directly.  (Characters not in Latin-1
are replaced by a dot.)

Several characters are missing, c-cedilla has no cedilla and
`sharp s' (\samp{U+00DF}, also known as `esszett')
is rendered as \code{ss}.


\item[Special Characters:] a set of characters are provided which
do not fall into any standard font.  These can only be accessed by
escape sequence.  For example, \samp{\bsl{}\bsl{}LI} produces the zodiac sign for
Libra, and \samp{\bsl{}\bsl{}JU} produces the astronomical sign for Jupiter.
The fourth table in \code{demo(Hershey)} shows all of the
special character escape sequences.


\item[Cyrillic Characters:] cyrillic characters are implemented
according to the K018-R encoding, and can be used directly in such
a locale using the Serif typeface and Cyrillic (or Oblique Cyrillic)
fontindex.  Alternatively they can be specified via an octal code
in the range 300 to 337 for lower case characters or 340 to 377 for
upper case characters.  The fifth table in \code{demo(Hershey)} shows the
octal codes for the available Cyrillic characters.

Cyrillic has to be selected via a \code{("serif", fontindex)} pair
rather than via a font family.


\item[Japanese Characters:] 83 Hiragana, 86 Katakana, and 603 Kanji
characters are implemented according to the EUC-JP (Extended Unix Code)
encoding. Each character is identified by a unique hexadecimal code.
The Hiragana characters
are in the range 0x2421 to 0x2473, Katakana are in the range 0x2521 to
0x2576, and Kanji are (scattered about) in the range 0x3021 to 0x6d55.

When using the Serif typeface and EUC
fontindex, these characters can be produced by a \emph{pair} of octal
codes.  Given the hexadecimal code (e.g., 0x2421), take the first two
digits and add 0x80 and do the same to the second two digits (e.g.,
0x21 and 0x24 become 0xa4 and 0xa1), then convert both to octal (e.g.,
0xa4 and 0xa1 become 244 and 241).  For example, the first Hiragana
character is produced by \samp{\bsl{}244\bsl{}241}.

It is also possible to use the hexadecimal code directly.  This works
for all non-EUC fonts by specifying an escape sequence of the form
\samp{\bsl{}\#J1234}.  For example, the first Hiragana character is produced
by \samp{\bsl{}\#J2421}.

The Kanji characters may be specified in a third way, using the
so-called "Nelson Index", by specifying an escape sequence of the form
\samp{\bsl{}\#N1234}.  For example, the (obsolete) Kanji for `one' is
produced by \samp{\bsl{}\#N0001}.

\code{demo(Japanese)} shows the available Japanese characters.


\item[Raw Hershey Glyphs:] all of the characters in the Hershey
fonts are stored in a large array.  Some characters are not
accessible in any of the Hershey fonts.  These characters can only
be accessed via an escape sequence of the form \samp{\bsl{}\#H1234}.
For example, the fleur-de-lys is produced by \samp{\bsl{}\#H0746}.
The sixth and seventh tables of \code{demo(Hershey)} shows all of
the available raw glyphs.


\end{description}

\end{Details}
%
\begin{References}\relax
\url{http://www.gnu.org/software/plotutils/plotutils.html}.
\end{References}
%
\begin{SeeAlso}\relax
 \code{\LinkA{demo}{demo}(Hershey)}, \code{\LinkA{par}{par}},
\code{\LinkA{text}{text}}, \code{\LinkA{contour}{contour}}.

\code{\LinkA{Japanese}{Japanese}} for the Japanese characters in the Hershey fonts.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
Hershey

## for tables of examples, see demo(Hershey)
\end{ExampleCode}
\end{Examples}
\HeaderA{hsv}{HSV Color Specification}{hsv}
\keyword{color}{hsv}
\keyword{dplot}{hsv}
%
\begin{Description}\relax
Create a vector of colors from vectors specifying hue, saturation and
value.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
hsv(h = 1, s = 1, v = 1, alpha)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{h,s,v}] numeric vectors of values in the range \code{[0, 1]} for
`hue', `saturation' and `value' to be combined
to form a vector of colors.  Values in shorter arguments are
recycled.
\item[\code{alpha}] numeric vector of values in the range \code{[0, 1]} for
alpha transparency channel (0 means transparent and 1 means opaque).
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Semi-transparent colors (\code{0 < alpha < 1}) are supported only on
some devices: see \code{\LinkA{rgb}{rgb}}.
\end{Details}
%
\begin{Value}
This function creates a vector of colors corresponding to the
given values in HSV space.  The values returned by \code{hsv} can be
used with a \code{col=} specification in graphics functions or in
\code{par}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{hcl}{hcl}} for a perceptually based version of \code{hsv()},
\code{\LinkA{rgb}{rgb}} and \code{\LinkA{rgb2hsv}{rgb2hsv}} for RGB to HSV conversion;
\code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{gray}{gray}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

hsv(.5,.5,.5)

## Red tones:
n <- 20;  y <- -sin(3*pi*((1:n)-1/2)/n)
op <- par(mar=rep(1.5,4))
plot(y, axes = FALSE, frame.plot = TRUE,
     xlab = "", ylab = "", pch = 21, cex = 30,
     bg = rainbow(n, start=.85, end=.1),
     main = "Red tones")
par(op)
\end{ExampleCode}
\end{Examples}
\HeaderA{Japanese}{Japanese characters in R}{Japanese}
\keyword{aplot}{Japanese}
%
\begin{Description}\relax
The implementation of Hershey vector fonts provides a large number of
Japanese characters (Hiragana, Katakana, and Kanji).
\end{Description}
%
\begin{Details}\relax
Without keyboard support for typing Japanese characters, the only way
to produce these characters is to use special escape sequences: see
\code{\LinkA{Hershey}{Hershey}}.

For example, the Hiragana character for the sound "ka" is produced
by \samp{\bsl{}\#J242b} and the Katakana character for this sound is
produced by \samp{\bsl{}\#J252b}.  The Kanji ideograph for "one" is
produced by \samp{\bsl{}\#J306c} or \samp{\bsl{}\#N0001}.

The output from \code{\LinkA{demo}{demo}(Japanese)} shows tables of the escape
sequences for the available Japanese characters.
\end{Details}
%
\begin{References}\relax
\url{http://www.gnu.org/software/plotutils/plotutils.html}
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{demo}{demo}(Japanese)}, \code{\LinkA{Hershey}{Hershey}}, \code{\LinkA{text}{text}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

plot(1:9, type="n", axes=FALSE, frame=TRUE, ylab="",
     main= "example(Japanese)", xlab= "using Hershey fonts")
par(cex=3)
Vf <- c("serif", "plain")

text(4, 2, "\#J2438\#J2421\#J2451\#J2473", vfont = Vf)
text(4, 4, "\#J2538\#J2521\#J2551\#J2573", vfont = Vf)
text(4, 6, "\#J467c\#J4b5c", vfont = Vf)
text(4, 8, "Japan", vfont = Vf)
par(cex=1)
text(8, 2, "Hiragana")
text(8, 4, "Katakana")
text(8, 6, "Kanji")
text(8, 8, "English")
\end{ExampleCode}
\end{Examples}
\HeaderA{make.rgb}{Create colour spaces }{make.rgb}
\aliasA{colorConverter}{make.rgb}{colorConverter}
\keyword{color}{make.rgb}
%
\begin{Description}\relax
These functions specify colour spaces for use in
\code{\LinkA{convertColor}{convertColor}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
make.rgb(red, green, blue, name = NULL, white = "D65",
         gamma = 2.2)

colorConverter(toXYZ, fromXYZ, name, white=NULL)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{red,green,blue}] Chromaticity (xy or xyY) of RGB primaries
\item[\code{name}] Name for the colour space
\item[\code{white}] Character string specifying the reference white (see
`Details'.)
\item[\code{gamma}] Display gamma (nonlinearity). A positive number or the
string \code{"sRGB"} 
\item[\code{fromXYZ}] Function to convert from XYZ tristimulus coordinates
to this space
\item[\code{toXYZ}] Function to convert from this space to XYZ tristimulus
coordinates.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
An RGB colour space is defined by the chromaticities of the  red, green and
blue primaries.  These are given as vectors of length 2 or 3 in xyY
coordinates (the Y component is not used and may be omitted).
The chromaticities are defined relative to a reference white, which
must be one of the CIE standard illuminants: "A", "B", "C",
"D50", "D55", "D60", "E" (usually "D65").

The display gamma is most commonly 2.2, though 1.8 is used for Apple RGB.
The sRGB standard specifies a more complicated function that is close
to a gamma of 2.2; \code{gamma="sRGB"} uses this function.

Colour spaces other than RGB can be specified directly by giving
conversions to and from XYZ tristimulus coordinates.
The functions  should take two arguments. The first is a vector giving the
coordinates for one colour. The second argument is the reference
white. If a specific reference white is included in the definition of
the colour space (as for the RGB spaces) this second argument should
be ignored and may be \code{...}.
\end{Details}
%
\begin{Value}
An object of class \code{colorConverter}
\end{Value}
%
\begin{References}\relax
Conversion algorithms from \url{http://www.brucelindbloom.com}.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{convertColor}{convertColor}
  }
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
(pal <- make.rgb(red=  c(0.6400, 0.3300),
                 green=c(0.2900, 0.6000),
                 blue= c(0.1500, 0.0600),
                 name = "PAL/SECAM RGB"))

## converter for sRGB in #rrggbb format
hexcolor <- colorConverter(toXYZ = function(hex,...) {
                            rgb <- t(col2rgb(hex))/255
                            colorspaces$sRGB$toXYZ(rgb, ...) },
                           fromXYZ = function(xyz,...) {
                              rgb <- colorspaces$sRGB$fromXYZ(xyz, ..)
                              rgb <- round(rgb,5)
                              if (min(rgb) < 0 || max(rgb) > 1)
                                   as.character(NA)
                              else rgb(rgb[1], rgb[2], rgb[3])},
                           white = "D65", name = "#rrggbb")

(cols <- t(col2rgb(palette())))
zapsmall(luv <- convertColor(cols,from="sRGB", to="Luv", scale.in=255))
(hex <- convertColor(luv, from="Luv",  to=hexcolor, scale.out=NULL))

## must make hex a matrix before using it
(cc <- round(convertColor(as.matrix(hex), from= hexcolor, to= "sRGB",
                          scale.in=NULL, scale.out=255)))
stopifnot(cc == cols)
\end{ExampleCode}
\end{Examples}
\HeaderA{msgWindow}{Manipulate a Window}{msgWindow}
\keyword{device}{msgWindow}
%
\begin{Description}\relax
\code{msgWindow} sends a message to manipulate the specified screen
device's window.  With argument \code{which = -1} it applies to the GUI
console (which only accepts the first three actions).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
msgWindow(type = c("minimize", "restore", "maximize",
                   "hide", "recordOn", "recordOff"),
          which = dev.cur())
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{type}] action to be taken.
\item[\code{which}] a device number, or \code{-1}.
\end{ldescription}
\end{Arguments}
%
\begin{SeeAlso}\relax
\code{\LinkA{bringToTop}{bringToTop}}, \code{\LinkA{windows}{windows}}
\end{SeeAlso}
\HeaderA{n2mfrow}{Compute Default mfrow From Number of Plots}{n2mfrow}
\keyword{dplot}{n2mfrow}
\keyword{utilities}{n2mfrow}
%
\begin{Description}\relax
Easy setup for plotting multiple figures (in a rectangular layout) on
one page.  This computes a sensible default for
\code{\LinkA{par}{par}(mfrow)}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
n2mfrow(nr.plots)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{nr.plots}] integer; the number of plot figures you'll want to draw.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A length two integer vector \code{nr, nc} giving the number of rows
and columns, fulfilling \code{nr >= nc >= 1} and \code{nr * nc >= nr.plots}.
\end{Value}
%
\begin{Author}\relax
Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{par}{par}}, \code{\LinkA{layout}{layout}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

n2mfrow(8) # 3 x 3

n <- 5 ; x <- seq(-2,2, len=51)
## suppose now that 'n' is not known {inside function}
op <- par(mfrow = n2mfrow(n))
for (j in 1:n)
   plot(x, x^j, main = substitute(x^ exp, list(exp = j)), type = "l",
   col = "blue")

sapply(1:10, n2mfrow)
\end{ExampleCode}
\end{Examples}
\HeaderA{nclass}{Compute the Number of Classes for a Histogram}{nclass}
\methaliasA{nclass.FD}{nclass}{nclass.FD}
\methaliasA{nclass.scott}{nclass}{nclass.scott}
\methaliasA{nclass.Sturges}{nclass}{nclass.Sturges}
\keyword{univar}{nclass}
%
\begin{Description}\relax
Compute the number of classes for a histogram.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
nclass.Sturges(x)
nclass.scott(x)
nclass.FD(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] 
A data vector.

\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
\code{nclass.Sturges} uses Sturges' formula, implicitly basing bin
sizes on the range of the data.

\code{nclass.scott} uses Scott's choice for a normal distribution based on
the estimate of the standard error, unless that is zero where it
returns \code{1}.

\code{nclass.FD} uses the Freedman-Diaconis choice based on the
inter-quartile range (\code{\LinkA{IQR}{IQR}}) unless that's zero where it
reverts to \code{\LinkA{mad}{mad}(x, constant=2)} and when that is \eqn{0}{}
as well, returns \code{1}.
\end{Details}
%
\begin{Value}
The suggested number of classes.
\end{Value}
%
\begin{References}\relax
Venables, W. N. and Ripley, B. D. (2002)
\emph{Modern Applied Statistics with S-PLUS.}
Springer, page 112.

Freedman, D. and Diaconis, P. (1981)
On the histogram as a density estimator: \eqn{L_2}{} theory.
\emph{Zeitschrift fr Wahrscheinlichkeitstheorie
und verwandte Gebiete} \bold{57}, 453--476.

Scott, D. W. (1979) On optimal and data-based histograms.
\emph{Biometrika} \bold{66}, 605--610.

Scott, D. W. (1992)
\emph{Multivariate Density Estimation. Theory, Practice, and
Visualization}. Wiley.

Sturges, H. A. (1926)  The choice of a class interval.
\emph{Journal of the American Statistical Association} \bold{21}, 65--66.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{hist}{hist}} and \code{\LinkA{truehist}{truehist}} (package
\Rhref{http://CRAN.R-project.org/package=MASS}{\pkg{MASS}});  \code{\LinkA{dpih}{dpih}} (package
\Rhref{http://CRAN.R-project.org/package=KernSmooth}{\pkg{KernSmooth}}) for a plugin bandwidth proposed by Wand(1995).
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
set.seed(1)
x <- stats::rnorm(1111)
nclass.Sturges(x)

## Compare them:
NC <- function(x) c(Sturges = nclass.Sturges(x),
      Scott = nclass.scott(x), FD = nclass.FD(x))
NC(x)
onePt <- rep(1, 11)
NC(onePt) # no longer gives NaN
\end{ExampleCode}
\end{Examples}
\HeaderA{palette}{Set or View the Graphics Palette}{palette}
\keyword{color}{palette}
\keyword{sysdata}{palette}
%
\begin{Description}\relax
View or manipulate the color palette which is used when a \code{col=}
has a numeric index.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
palette(value)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{value}] an optional character vector.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If \code{value} has length 1, it is taken to be the name of
a built in color palette.  If \code{value} has length greater
than 1 it is assumed to contain a description of the colors
which are to make up the new palette (either by name or
by RGB levels).

If \code{value} is omitted or has length 0, no change is made
the current palette.

Currently, the only built-in palette is \code{"default"}.
\end{Details}
%
\begin{Value}
The palette which \emph{was} in effect.  This is \code{\LinkA{invisible}{invisible}}
unless the argument is omitted.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{colors}{colors}} for the vector of built-in named colors;
\code{\LinkA{hsv}{hsv}}, \code{\LinkA{gray}{gray}}, \code{\LinkA{rainbow}{rainbow}},
\code{\LinkA{terrain.colors}{terrain.colors}},\dots to construct colors.

\code{\LinkA{adjustcolor}{adjustcolor}}, e.g., for tweaking existing palettes;
\code{\LinkA{colorRamp}{colorRamp}} to interpolate colors, making custom palettes;
\code{\LinkA{col2rgb}{col2rgb}} for translating colors to RGB 3-vectors.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

palette()               # obtain the current palette
palette(rainbow(6))     # six color rainbow

(palette(gray(seq(0,.9,len=25)))) # gray scales; print old palette
matplot(outer(1:100,1:30), type='l', lty=1,lwd=2, col=1:30,
        main = "Gray Scales Palette",
        sub = "palette(gray(seq(0,.9,len=25)))")
palette("default")      # reset back to the default

## on a device where alpha-transparency is supported,
##  use 'alpha = 0.3' transparency with the default palette :
mycols <- adjustcolor(palette(), alpha.f = 0.3)
opal <- palette(mycols)
x <- rnorm(1000); xy <- cbind(x, 3*x + rnorm(1000))
plot (xy, lwd=2,
       main = "Alpha-Transparency Palette\n alpha = 0.3")
xy[,1] <- -xy[,1]
points(xy, col=8, pch=16, cex = 1.5)
palette("default")
\end{ExampleCode}
\end{Examples}
\HeaderA{Palettes}{Color Palettes}{Palettes}
\aliasA{cm.colors}{Palettes}{cm.colors}
\aliasA{heat.colors}{Palettes}{heat.colors}
\aliasA{rainbow}{Palettes}{rainbow}
\aliasA{terrain.colors}{Palettes}{terrain.colors}
\aliasA{topo.colors}{Palettes}{topo.colors}
\keyword{color}{Palettes}
\keyword{dplot}{Palettes}
%
\begin{Description}\relax
Create a vector of \code{n} contiguous colors.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rainbow(n, s = 1, v = 1, start = 0, end = max(1,n - 1)/n, alpha = 1)
heat.colors(n, alpha = 1)
terrain.colors(n, alpha = 1)
topo.colors(n, alpha = 1)
cm.colors(n, alpha = 1)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{n}] the number of colors (\eqn{\ge 1}{}) to be in the
palette.
\item[\code{s,v}] the `saturation' and `value' to be used
to complete the HSV color descriptions.
\item[\code{start}] the (corrected) hue in [0,1] at which the rainbow
begins.
\item[\code{end}] the (corrected) hue in [0,1] at which the rainbow ends.
\item[\code{alpha}] the alpha transparency, a number in [0,1], see argument
\code{alpha} in \code{\LinkA{hsv}{hsv}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Conceptually, all of these functions actually use (parts of) a line
cut out of the 3-dimensional color space, parametrized by
\code{\LinkA{hsv}{hsv}(h,s,v)}, and hence,
equispaced hues in RGB space tend to cluster at
the red, green and blue primaries.

Some applications such as contouring require a palette
of colors which do not wrap around to give a final
color close to the starting one.

With \code{rainbow}, the parameters \code{start} and \code{end} can be used
to specify particular subranges of hues.
The following values can be used when generating such a subrange:
red=0, yellow=\eqn{\frac 1 6}{}, green=\eqn{\frac 2 6}{},
cyan=\eqn{\frac 3 6}{}, blue=\eqn{\frac 4 6}{}
and magenta=\eqn{\frac 5 6}{}.
\end{Details}
%
\begin{Value}
A character vector, \code{cv}, of color names.  This can be used
either to create a user--defined color palette for subsequent
graphics by \code{\LinkA{palette}{palette}(cv)}, a \code{col=} specification
in graphics functions or in \code{par}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{colors}{colors}}, \code{\LinkA{palette}{palette}}, \code{\LinkA{hsv}{hsv}},
\code{\LinkA{hcl}{hcl}}, \code{\LinkA{rgb}{rgb}}, \code{\LinkA{gray}{gray}} and
\code{\LinkA{col2rgb}{col2rgb}} for translating to RGB numbers.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)
# A Color Wheel
pie(rep(1,12), col=rainbow(12))

##------ Some palettes ------------
demo.pal <-
  function(n, border = if (n<32) "light gray" else NA,
           main = paste("color palettes;  n=",n),
           ch.col = c("rainbow(n, start=.7, end=.1)", "heat.colors(n)",
                      "terrain.colors(n)", "topo.colors(n)",
                      "cm.colors(n)"))
{
    nt <- length(ch.col)
    i <- 1:n; j <- n / nt; d <- j/6; dy <- 2*d
    plot(i,i+d, type="n", yaxt="n", ylab="", main=main)
    for (k in 1:nt) {
        rect(i-.5, (k-1)*j+ dy, i+.4, k*j,
             col = eval(parse(text=ch.col[k])), border = border)
        text(2*j,  k * j +dy/4, ch.col[k])
    }
}
n <- if(.Device == "postscript") 64 else 16
     # Since for screen, larger n may give color allocation problem
demo.pal(n)
\end{ExampleCode}
\end{Examples}
\HeaderA{pdf}{PDF Graphics Device}{pdf}
\keyword{device}{pdf}
%
\begin{Description}\relax
\code{pdf} starts the graphics device driver for producing PDF
graphics.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
pdf(file = ifelse(onefile, "Rplots.pdf", "Rplot%03d.pdf"),
    width, height, onefile, family, title, fonts, version,
    paper, encoding, bg, fg, pointsize, pagecentre, colormodel,
    useDingbats, useKerning, fillOddEven, maxRasters, compress)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the file.
If it is of the form \code{"|cmd"}, the output is piped to the
command given by \command{cmd}.  If it is \code{NULL},
then no external file is created (effectively, no drawing occurs),
but the device may still be queried (e.g., for size of text).

For use with \code{onefile = FALSE} give a C integer format such
as \code{"Rplot\%03d.pdf"} (the default in that case).
(See \code{\LinkA{postscript}{postscript}} for further details.)

Tilde expansion (see \code{\LinkA{path.expand}{path.expand}}) is done.

\item[\code{width, height}] the width and height of the graphics region in
inches.  The default values are \code{7}.
\item[\code{onefile}] logical: if true (the default) allow multiple figures
in one file.  If false, generate a file with name containing the page
number for each page.  Defaults to \code{TRUE}, and forced to true
if \code{file} is a pipe.
\item[\code{family}] the font family to be used, see
\code{\LinkA{postscript}{postscript}}.  Defaults to \code{"Helvetica"}.
\item[\code{title}] title string to embed as the \samp{/Title} field in the
file.  Defaults to \code{"R Graphics Output"}.
\item[\code{fonts}] a character vector specifying \R{} graphics font family
names for additional fonts which will be included in the PDF file.
Defaults to \code{NULL}.
\item[\code{version}] a string describing the PDF version that will be
required to view the output.  This is a minimum, and will be
increased (with a warning) if necessary.  Defaults to \code{"1.4"},
but see `Details'.
\item[\code{paper}] the target paper size.  The choices are
\code{"a4"}, \code{"letter"}, \code{"legal"} (or \code{"us"}) and
\code{"executive"} (and these can be capitalized), or \code{"a4r"}
and \code{"USr"} for rotated (`landscape').
The default is \code{"special"}, which means that the \code{width}
and \code{height} specify the paper size.  A further choice is
\code{"default"}; if this is selected, the
papersize is taken from the option \code{"papersize"}
if that is set and as \code{"a4"} if it is unset or empty.
Defaults to \code{"special"}.

\item[\code{encoding}] the name of an encoding file.  See
\code{\LinkA{postscript}{postscript}} for details.  Defaults to \code{"default"}.
\item[\code{bg}] the initial background color to be used.  Defaults to
\code{"transparent"}.
\item[\code{fg}] the initial foreground color to be used.  Defaults to
\code{"black"}.
\item[\code{pointsize}] the default point size to be used.  Strictly
speaking, in bp, that is 1/72 of an inch, but approximately in
points.  Defaults to \code{12}.
\item[\code{pagecentre}] logical: should the device region be centred on the
page? -- is only relevant for \code{paper != "special"}.  
Defaults to \code{TRUE}.
\item[\code{colormodel}] a character string describing the color model:
currently allowed values are \code{"srgb"}, \code{"gray"} (or
\code{"grey"}) and \code{"cmyk"}.  Defaults to \code{"srgb"}.  See section
`Color models'.
\item[\code{useDingbats}] logical.  Should small circles be rendered
\emph{via} the Dingbats font?  Defaults to \code{TRUE}, which produces
smaller and better output.  Setting this to \code{FALSE} can work
around font display problems in broken PDF viewers: although this
font is one of the 14 guaranteed to be available in all PDF viewers,
that guarantee is not always honoured.

\item[\code{useKerning}] logical.  Should kerning corrections be included in
setting text and calculating string widths?  Defaults to \code{TRUE}.
\item[\code{fillOddEven}] logical controlling the polygon fill mode:  see
\code{\LinkA{polygon}{polygon}} for details.  Defaults to \code{FALSE}.
\item[\code{maxRasters}] integer.  Unused in \R{} >= 2.14.0, previously the
maximum number of raster images to be stored in this PDF document
(default \code{64} in \R{} < 2.13.2).
\item[\code{compress}] logical.  Should PDF streams be generated with Flate
compression?  Defaults to \code{TRUE}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
All arguments except \code{file} default to values given by
\code{\LinkA{pdf.options}{pdf.options}()}.  The ultimate defaults are quoted in the
arguments section.

\code{pdf()} opens the file \code{file} and the PDF commands needed to
plot any graphics requested are sent to that file.

The \code{file} argument is interpreted as a C integer format as used
by \code{\LinkA{sprintf}{sprintf}}, with integer argument the page number.
The default gives files \file{Rplot001.pdf}, \dots, \file{Rplot999.pdf},
\file{Rplot1000.pdf}, \dots.

The \code{family} argument can be used to specify a PDF-specific
font family as the initial/default font for the device.  If additional
font families are to be used they should be included in the
\code{fonts} argument.

If a device-independent \R{} graphics font family is specified (e.g., via
\code{par(family=)} in the graphics package), the PDF device makes use
of the PostScript font mappings to convert the \R{} graphics font family
to a PDF-specific font family description.  (See the
documentation for \code{\LinkA{pdfFonts}{pdfFonts}}.)

This device does \emph{not} embed fonts in the PDF file, so it is only
straightforward to use mappings to the font families that can be
assumed to be available in any PDF viewer: \code{"Times"}
(equivalently \code{"serif"}), \code{"Helvetica"} (equivalently
\code{"sans"}) and \code{"Courier"} (equivalently \code{"mono"}).
Other families may be specified, but it is the user's responsibility
to ensure that these fonts are available on the system and third-party
software (e.g., Ghostscript) may be required to embed the fonts so
that the PDF can be included in other documents (e.g., LaTeX): see
\code{\LinkA{embedFonts}{embedFonts}}.  The URW-based families described for
\code{\LinkA{postscript}{postscript}} can be used with viewers
such as GSView which utilise URW fonts.
Since \code{\LinkA{embedFonts}{embedFonts}} makes use of Ghostscript, it should be
able to embed the URW-based families for use with other viewers.

See \code{\LinkA{postscript}{postscript}} for details of encodings, as the internal
code is shared between the drivers.  The native PDF encoding is given
in file \file{PDFDoc.enc}.

The PDF produced is fairly simple, with each page being represented as
a single stream (by default compressed and possibly with references to
raster images).  The \R{} graphics model does not distinguish graphics
objects at the level of the driver interface.

The \code{version} argument declares the version of PDF that gets
produced.  The version must be at least 1.2 when compression is used,
1.4 for semi-transparent output to be understood, and at least 1.3 if
CID fonts are to be used: if any of these features are used the
version number will be increased (with a warning).  (PDF 1.4 was first
supported by Acrobat 5 in 2001; it is very unlikely not to be
supported in a current viewer.)

Line widths as controlled by \code{par(lwd=)} are in multiples of
1/96 inch.  Multiples less than 1 are allowed.  \code{pch="."} with
\code{cex = 1} corresponds to a square of side 1/72 inch, which is
also the `pixel' size assumed for graphics parameters such as
\code{"cra"}.

The \code{paper} argument sets the \samp{/MediaBox} entry in the file,
which defaults to \code{width} by \code{height}.  If it is set to
something other than \code{"special"}, a device region of the
specified size is (by default) centred on the rectangle given by the
paper size: if either \code{width} or \code{height} is less
than \code{0.1} or too large to give a total margin of 0.5 inch, it is
reset to the corresponding paper dimension minus 0.5.  Thus if you
want the default behaviour of \code{\LinkA{postscript}{postscript}} use
\code{pdf(paper="a4r", width=0, height=0)} to centre the device region
on a landscape A4 page with 0.25 inch margins.

When the background colour is fully transparent (as is the initial
default value), the PDF produced does not paint the background.  Most
PDF viewers will use a white canvas so the visual effect is if the
background were white.  This will not be the case when printing onto
coloured paper, though.
\end{Details}
%
\begin{Section}{Color models}
The default color model (\code{"srgb"}) is sRGB.  Model \code{"gray"}
(or \code{"grey"}) maps sRGB colors to greyscale using perceived
luminosity (biased towards green).  \code{"cmyk"} outputs in CMYK
colorspace.  The simplest possible conversion from sRGB to CMYK is
used
(\url{http://en.wikipedia.org/wiki/CMYK_color_model#Mapping_RGB_to_CMYK}),
and raster images are output in RGB.

Also available for backwards compatibility is model \code{"rgb"} which
uses uncalibrated RGB and corresponds to the model used with that name
in \R{} prior to 2.13.0.  Some viewers may render some plots in that
colorspace faster than in sRGB, and the plot files will be smaller.
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are as a multiple of 1/96 inch, with a minimum
of 0.01 enforced.
\item Circles of any radius are allowed.  Unless \code{useDingbats =
      FALSE}, opaque circles of less than 10 big points radius are
rendered using char 108 in the Dingbats font: all semi-transparent
and larger circles using a Bzier curve for each
quadrant.
\item Colours are by default specified as sRGB.

\end{itemize}


At very small line widths, the line type may be forced to solid.
\end{Section}
%
\begin{Section}{Printing}
Except on Windows it is possible to print directly from \code{pdf} by
something like (this is appropriate for a CUPS printing system):
\begin{alltt}
    pdf("|lp -o landscape", paper = "a4r")
\end{alltt}

This forces \code{onefile = TRUE}.
\end{Section}
%
\begin{Note}\relax
If you see problems with PDF output, do remember that the problem is
much more likely to be in your viewer than in \R{}.  Try another
viewer if possible.  Symptoms for which the viewer has been at fault
are apparent grids on image plots (turn off graphics anti-aliasing
in your viewer if you can) and missing or incorrect glyphs in text
(viewers silently doing font substitution).

Unfortunately the default viewers on most Linux and Mac OS X systems
have these problems, and no obvious way to turn off graphics anti-aliasing.

Acrobat Reader does not use the fonts specified but rather emulates
them from multiple-master fonts.  This can be seen in imprecise
centering of characters, for example the multiply and divide signs in
Helvetica.  This can be circumvented by embedding fonts where
possible.  Most other viewers substitute fonts, e.g. URW fonts for the
standard Helvetica and Times fonts, and these too often have different
font metrics from the true fonts.

Acrobat Reader can be extended by `font packs', and these will
be needed for the full use of encodings other than Latin-1 (although
they may be downloaded as needed).  See
\url{http://www.adobe.com/downloads/updates} for Reader 9 and X, and
\url{http://www.adobe.com/products/acrobat/acrrasianfontpack.html} for
Reader 6 to 8.

The TeXworks PDF viewer is one of those which has been seen to fail to
display Dingbats correctly.  Whereas on other platforms the problems
seen are incorrect output, on Windows points are silently omitted.  One
workaround is to use the argument \code{useDingbats = FALSE}: another
it to use a better PDF viewer.
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{pdfFonts}{pdfFonts}}, \code{\LinkA{pdf.options}{pdf.options}},
\code{\LinkA{embedFonts}{embedFonts}},
\code{\LinkA{Devices}{Devices}},
\code{\LinkA{postscript}{postscript}}.

\code{\LinkA{cairo\_pdf}{cairo.Rul.pdf}} and (on Mac OS X only) \code{quartz}
for other devices that can produce PDF.

More details of font families and encodings and especially handling
text in a non-Latin-1 encoding and embedding fonts can be found in

Paul Murrell and Brian Ripley (2006) Non-standard fonts in PostScript
and PDF graphics. \emph{R News}, 6(2):41--47.
\url{http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## Test function for encodings
TestChars <- function(encoding="ISOLatin1", ...)
{
    pdf(encoding=encoding, ...)
    par(pty="s")
    plot(c(-1,16), c(-1,16), type="n", xlab="", ylab="",
         xaxs="i", yaxs="i")
         title(paste("Centred chars in encoding", encoding))
    grid(17, 17, lty=1)
    for(i in c(32:255)) {
        x <- i %% 16
        y <- i %/% 16
        points(x, y, pch=i)
    }
    dev.off()
}
## there will be many warnings.
TestChars("ISOLatin2")
## this does not view properly in older viewers.
TestChars("ISOLatin2", family="URWHelvetica")
## works well for viewing in gs-based viewers, and often in xpdf.

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{pdf.options}{Auxiliary Function to Set/View Defaults for Arguments of pdf}{pdf.options}
\keyword{device}{pdf.options}
%
\begin{Description}\relax
The auxiliary function \code{pdf.options} can be used to set or view
(if called without arguments) the default values for some of the
arguments to \code{\LinkA{pdf}{pdf}}.

\code{pdf.options} needs to be called before calling \code{pdf},
and the default values it sets can be overridden by supplying
arguments to \code{pdf}.

\end{Description}
%
\begin{Usage}
\begin{verbatim}
pdf.options(..., reset = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] arguments \code{width}, \code{height}, \code{onefile},
\code{family}, \code{title}, \code{fonts}, \code{paper},
\code{encoding}, \code{pointsize}, \code{bg}, \code{fg},
\code{pagecentre}, \code{useDingbats}, \code{colormodel},
\code{fillOddEven} and \code{compress} can be supplied.
\item[\code{reset}] logical: should the defaults be reset to their
`factory-fresh' values?
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If both \code{reset = TRUE} and \code{...} are supplied the defaults
are first reset to the `factory-fresh' values and then the new
values are applied.
\end{Details}
%
\begin{Value}
A named list of all the defaults.  If any arguments are
supplied the return values are the old values and the result has the
visibility flag turned off.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{pdf}{pdf}}, \code{\LinkA{ps.options}{ps.options}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
pdf.options(bg = "pink")
utils::str(pdf.options())
pdf.options(reset = TRUE) # back to factory-fresh
\end{ExampleCode}
\end{Examples}
\HeaderA{pictex}{A PicTeX Graphics Driver}{pictex}
\keyword{device}{pictex}
%
\begin{Description}\relax
This function produces simple graphics suitable for inclusion in TeX
and LaTeX documents.  It dates from the very early days of \R{} and is
for historical interest only.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
pictex(file = "Rplots.tex", width = 5, height = 4, debug = FALSE,
       bg = "white", fg = "black")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] the file where output will appear.
\item[\code{width}] The width of the plot in inches.
\item[\code{height}] the height of the plot in inches.
\item[\code{debug}] should debugging information be printed.
\item[\code{bg}] the background color for the plot.  Ignored.
\item[\code{fg}] the foreground color for the plot.  Ignored.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This driver is much more basic than the other graphics drivers
included in \R{}.  It does not have any font metric information, so the
use of \code{\LinkA{plotmath}{plotmath}} is not supported.

Line widths are ignored except when setting the spacing of line textures.
\code{pch="."} corresponds to a square of side 1pt.

This device does not support colour (nor does the PicTeX package),
and all colour settings are ignored.

Note that text is recorded in the file as-is, so annotations involving
TeX special characters (such as ampersand and underscore) need to be
quoted as they would be when entering TeX.

Multiple plots will be placed as separate environments in the output file.  
\end{Details}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 5 inches by 4 inches.
\item There is no \code{pointsize} argument: the default size is
interpreted as 10 point.
\item The only font family is \code{cmss10}.
\item Line widths are only used when setting the spacing on line textures.
\item Circle of any radius are allowed.
\item Colour is not supported.

\end{itemize}

\end{Section}
%
\begin{Author}\relax
This driver was provided around 1996--7 by Valerio Aimale
of the Department of Internal Medicine, University of Genoa, Italy.
\end{Author}
%
\begin{References}\relax
Knuth, D. E. (1984)
\emph{The TeXbook.}
Reading, MA: Addison-Wesley.

Lamport, L. (1994)
\emph{LATEX: A Document Preparation System.}
Reading, MA: Addison-Wesley.

Goossens, M., Mittelbach, F. and Samarin, A. (1994)
\emph{The LATEX Companion.}
Reading, MA: Addison-Wesley.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf}{pdf}}, \code{\LinkA{Devices}{Devices}}.

The \code{tikzDevice} in the CRAN package of that name for more modern
TeX-based graphics (\url{http://pgf.sourceforge.net/}, although
including PDF figures \emph{via} \command{pdftex} is most common
in (La)TeX documents).
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

pictex()
plot(1:11,(-5:5)^2, type='b', main="Simple Example Plot")
dev.off()
##--------------------
## Not run: 
%% LaTeX Example
\documentclass{article}
\usepackage{pictex}
\usepackage{graphics} % for \rotatebox
\begin{document}
%...
\begin{figure}[h]
  \centerline{\input{Rplots.tex}}
  \caption{}
\end{figure}
%...
\end{document}

## End(Not run)
##--------------------
unlink("Rplots.tex")
\end{ExampleCode}
\end{Examples}
\HeaderA{plotmath}{Mathematical Annotation in R}{plotmath}
\aliasA{atop}{plotmath}{atop}
\aliasA{bar}{plotmath}{bar}
\aliasA{bgroup}{plotmath}{bgroup}
\aliasA{bold}{plotmath}{bold}
\aliasA{bolditalic}{plotmath}{bolditalic}
\aliasA{displaystyle}{plotmath}{displaystyle}
\aliasA{dot}{plotmath}{dot}
\aliasA{frac}{plotmath}{frac}
\aliasA{group}{plotmath}{group}
\aliasA{hat}{plotmath}{hat}
\aliasA{inf}{plotmath}{inf}
\aliasA{integral}{plotmath}{integral}
\aliasA{italic}{plotmath}{italic}
\aliasA{over}{plotmath}{over}
\aliasA{phantom}{plotmath}{phantom}
\aliasA{plain}{plotmath}{plain}
\aliasA{ring}{plotmath}{ring}
\aliasA{scriptscriptstyle}{plotmath}{scriptscriptstyle}
\aliasA{scriptstyle}{plotmath}{scriptstyle}
\aliasA{sup}{plotmath}{sup}
\aliasA{symbol}{plotmath}{symbol}
\aliasA{textstyle}{plotmath}{textstyle}
\aliasA{underline}{plotmath}{underline}
\aliasA{widehat}{plotmath}{widehat}
\aliasA{widetilde}{plotmath}{widetilde}
\keyword{aplot}{plotmath}
%
\begin{Description}\relax
If the \code{text} argument to one of the text-drawing functions
(\code{\LinkA{text}{text}}, \code{\LinkA{mtext}{mtext}}, \code{\LinkA{axis}{axis}},
\code{\LinkA{legend}{legend}}) in \R{} is an expression, the argument is
interpreted as a mathematical expression and the output will be
formatted according to TeX-like rules.  Expressions can also be used
for titles, subtitles and x- and y-axis labels (but not for axis
labels on \code{persp} plots).

In most cases other language objects (names and calls, including
formulas) are coerced to expressions and so can also be used.
\end{Description}
%
\begin{Details}\relax
A mathematical expression must obey the normal rules of syntax for any
\R{} expression, but it is interpreted according to very different rules
than for normal \R{} expressions.

It is possible to produce many different mathematical symbols, generate
sub- or superscripts, produce fractions, etc.

The output from \code{demo(plotmath)} includes several tables which
show the available features.  In these tables, the columns of grey text
show sample \R{} expressions, and the columns of black text show the
resulting output.

The available features are also described in the tables below:


\Tabular{ll}{
\bold{Syntax} & \bold{Meaning} \\{}

\code{x + y}   & x plus y   \\{}
\code{x - y}   & x minus y \\{}
\code{x*y}    & juxtapose x and y \\{}
\code{x/y}    & x forwardslash y \\{}
\code{x \%+-\% y}   & x plus or minus y \\{}
\code{x \%/\% y}   & x divided by y \\{}
\code{x \%*\% y}   & x times y \\{}
\code{x \%.\% y}   & x cdot y \\{}
\code{x[i]}   & x subscript i \\{}
\code{x\textasciicircum{}2}    & x superscript 2 \\{}
\code{paste(x, y, z)} & juxtapose x, y, and z \\{}
\code{sqrt(x)}   & square root of x \\{}
\code{sqrt(x, y)}   & yth root of x \\{}
\code{x == y}   & x equals y \\{}
\code{x != y}   & x is not equal to y \\{}
\code{x < y}   & x is less than y \\{}
\code{x <= y}   & x is less than or equal to y \\{}
\code{x > y}   & x is greater than y \\{}
\code{x >= y}   & x is greater than or equal to y \\{}
\code{x \%\textasciitilde{}\textasciitilde{}\% y}   & x is approximately equal to y \\{}
\code{x \%=\textasciitilde{}\% y}   & x and y are congruent \\{}
\code{x \%==\% y}   & x is defined as y \\{}
\code{x \%prop\% y}  & x is proportional to y \\{}
\code{plain(x)}   & draw x in normal font \\{}
\code{bold(x)}   & draw x in bold font \\{}
\code{italic(x)}   & draw x in italic font \\{}
\code{bolditalic(x)} & draw x in bolditalic font \\{}
\code{symbol(x)} & draw x in symbol font \\{}
\code{list(x, y, z)} & comma-separated list \\{}
\code{...}    & ellipsis (height varies) \\{}
\code{cdots}   & ellipsis (vertically centred) \\{}
\code{ldots}   & ellipsis (at baseline) \\{}
\code{x \%subset\% y} & x is a proper subset of y \\{}
\code{x \%subseteq\% y} & x is a subset of y \\{}
\code{x \%notsubset\% y} & x is not a subset of y \\{}
\code{x \%supset\% y} & x is a proper superset of y \\{}
\code{x \%supseteq\% y} & x is a superset of y \\{}
\code{x \%in\% y}   & x is an element of y \\{}
\code{x \%notin\% y} & x is not an element of y \\{}
\code{hat(x)}   & x with a circumflex \\{}
\code{tilde(x)}   & x with a tilde \\{}
\code{dot(x)} & x with a dot \\{}
\code{ring(x)}   & x with a ring \\{}
\code{bar(xy)}   & xy with bar \\{}
\code{widehat(xy)}   & xy with a wide circumflex \\{}
\code{widetilde(xy)} & xy with a wide tilde \\{}
\code{x \%<->\% y}   & x double-arrow y \\{}
\code{x \%->\% y}   & x right-arrow y \\{}
\code{x \%<-\% y}   & x left-arrow y \\{}
\code{x \%up\% y}   & x up-arrow y \\{}
\code{x \%down\% y}  & x down-arrow y \\{}
\code{x \%<=>\% y}   & x is equivalent to y \\{}
\code{x \%=>\% y}   & x implies y \\{}
\code{x \%<=\% y}   & y implies x \\{}
\code{x \%dblup\% y}   & x double-up-arrow y \\{}
\code{x \%dbldown\% y} & x double-down-arrow y \\{}
\code{alpha} -- \code{omega} & Greek symbols \\{}
\code{Alpha} -- \code{Omega} & uppercase Greek symbols \\{}
\code{theta1, phi1, sigma1, omega1} & cursive Greek symbols\\{}
\code{Upsilon1} & capital upsilon with hook\\{}
\code{aleph} & first letter of Hebrew alphabet\\{}
\code{infinity}   & infinity symbol \\{}
\code{partialdiff} & partial differential symbol \\{}
\code{nabla} & nabla, gradient symbol\\{}
\code{32*degree}   & 32 degrees \\{}
\code{60*minute}   & 60 minutes of angle \\{}
\code{30*second}   & 30 seconds of angle \\{}
\code{displaystyle(x)} & draw x in normal size (extra spacing) \\{}
\code{textstyle(x)}  & draw x in normal size \\{}
\code{scriptstyle(x)} & draw x in small size \\{}
\code{scriptscriptstyle(x)} & draw x in very small size \\{}
\code{underline(x)}   & draw x underlined\\{}
\code{x \textasciitilde{}\textasciitilde{} y}        & put extra space between x and y \\{}
\code{x + phantom(0) + y} & leave gap for "0", but don't draw it \\{}
\code{x + over(1, phantom(0))} & leave vertical gap for "0" (don't draw) \\{}
\code{frac(x, y)}   & x over y \\{}
\code{over(x, y)}   & x over y \\{}
\code{atop(x, y)}   & x over y (no horizontal bar) \\{}
\code{sum(x[i], i==1, n)} & sum x[i] for i equals 1 to n \\{}
\code{prod(plain(P)(X==x), x)} & product of P(X=x) for all values of x \\{}
\code{integral(f(x)*dx, a, b)} & definite integral of f(x) wrt x \\{}
\code{union(A[i], i==1, n)} & union of A[i] for i equals 1 to n \\{}
\code{intersect(A[i], i==1, n)} & intersection of A[i] \\{}
\code{lim(f(x), x \%->\% 0)} & limit of f(x) as x tends to 0 \\{}
\code{min(g(x), x > 0)} & minimum of g(x) for x greater than 0 \\{}
\code{inf(S)}        & infimum of S \\{}
\code{sup(S)}   & supremum of S \\{}
\code{x\textasciicircum{}y + z}   & normal operator precedence \\{}
\code{x\textasciicircum{}(y + z)}    & visible grouping of operands \\{}
\code{x\textasciicircum{}\{y + z\}}  & invisible grouping of operands \\{}
\code{group("(",list(a, b),"]")} & specify left and right delimiters \\{}
\code{bgroup("(",atop(x,y),")")} & use scalable delimiters \\{}
\code{group(lceil, x, rceil)} & special delimiters \\{}
}

The symbol font uses Adobe Symbol encoding so, for example, a lower
case mu can be obtained either by the special symbol \code{mu} or by
\code{symbol("m")}.  This provides access to symbols that have no
special symbol name, for example, the universal, or forall, symbol is
\code{symbol("\bsl{}042")}.  To see what symbols are available in this way
use \code{TestChars(font=5)} as given in the examples for
\code{\LinkA{points}{points}}: some are only available on some devices.

Note to TeX users: TeX's \samp{\bsl{}Upsilon} is \code{Upsilon1}, TeX's
\samp{\bsl{}varepsilon} is close to \code{epsilon}, and there is no
equivalent of TeX's \samp{\bsl{}epsilon}.  TeX's \samp{\bsl{}varpi} is close to
\code{omega1}.  \code{vartheta}, \code{varphi} and \code{varsigma} are
allowed as synonyms for \code{theta1}, \code{phi1} and \code{sigma1}.

\code{sigma1} is also known as \code{stigma}, its Unicode name.

Control characters (e.g. \samp{\bsl{}n}) are not interpreted in character
strings in plotmath, unlike normal plotting.

The fonts used are taken from the current font family, and so can be
set by \code{\LinkA{par}{par}(family=)} in base graphics, and
\code{\LinkA{gpar}{gpar}(fontfamily=)} in package \pkg{grid}.

Note that \code{bold}, \code{italic} and \code{bolditalic} do not
apply to symbols, and hence not to the Greek \emph{symbols} such as
\code{mu} which are displayed in the symbol font.  They also do not
apply to numeric constants.
\end{Details}
%
\begin{Section}{Other symbols}
On many OSes and some graphics devices many other symbols are
available as part of the standard text font, and all of the symbols in
the Adobe Symbol encoding are in principle available \emph{via}
changing the font face or (see `Details') plotmath: see the
examples section of \code{\LinkA{points}{points}} for a function to display
them.  (`In principle' because some of the glyphs are missing
from some implementations of the symbol font.)  Unfortunately,
\code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}} have support for little
more than European (not Greek) and CJK characters and the Adobe Symbol
encoding (and in a few fonts, also Cyrillic characters).

Any Unicode character can be entered into a text string \emph{via} a
\samp{\bsl{}uxxxx} escape, or used by number in a call to
\code{\LinkA{points}{points}}.  The \code{\LinkA{windows}{windows}} family of devices can
display such characters if they are available in the font in use.
This can often be used to display Greek \emph{letters} in bold or italic.

A good way to both find out which characters are available in a font
and to determine the Unicode number is to use the `Character
Map' accessory (usually on the `Start' menu under
`Accessories->System Tools').  You can also copy-and-paste
characters from the `Character Map' window to the \code{Rgui}
console (but not to \code{Rterm}).
\end{Section}
%
\begin{References}\relax
Murrell, P. and Ihaka, R. (2000) An approach to providing
mathematical annotation in plots.
\emph{Journal of Computational and Graphical Statistics},
\bold{9}, 582--599.

The symbol codes can be found in octal in the Adobe reference manuals,
e.g. for Postscript
\url{http://www.adobe.com/products/postscript/pdfs/PLRM.pdf}
or PDF
\url{http://www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf}
and in decimal, octal and hex at
\url{http://www.stat.auckland.ac.nz/~paul/R/CM/AdobeSym.html}.
\end{References}
%
\begin{SeeAlso}\relax
\code{demo(plotmath)},
\code{\LinkA{axis}{axis}},
\code{\LinkA{mtext}{mtext}},
\code{\LinkA{text}{text}},
\code{\LinkA{title}{title}},
\code{\LinkA{substitute}{substitute}}
\code{\LinkA{quote}{quote}}, \code{\LinkA{bquote}{bquote}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

x <- seq(-4, 4, len = 101)
y <- cbind(sin(x), cos(x))
matplot(x, y, type = "l", xaxt = "n",
        main = expression(paste(plain(sin) * phi, "  and  ",
                                plain(cos) * phi)),
        ylab = expression("sin" * phi, "cos" * phi), # only 1st is taken
        xlab = expression(paste("Phase Angle ", phi)),
        col.main = "blue")
axis(1, at = c(-pi, -pi/2, 0, pi/2, pi),
     labels = expression(-pi, -pi/2, 0, pi/2, pi))


## How to combine "math" and numeric variables :
plot(1:10, type="n", xlab="", ylab="", main = "plot math & numbers")
theta <- 1.23 ; mtext(bquote(hat(theta) == .(theta)), line= .25)
for(i in 2:9)
    text(i,i+1, substitute(list(xi,eta) == group("(",list(x,y),")"),
                           list(x=i, y=i+1)))
## note that both of these use calls rather than expressions.
##
text(1,10,  "Derivatives:", adj=0)
text(1,9.6, expression(
 "             first: {f * minute}(x) " == {f * minute}(x)), adj=0)
text(1,9.0, expression(
 "     second: {f * second}(x) "        == {f * second}(x)), adj=0)


plot(1:10, 1:10)
text(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y))
text(4, 8.4, "expression(hat(beta) == (X^t * X)^{-1} * X^t * y)",
     cex = .8)
text(4, 7, expression(bar(x) == sum(frac(x[i], n), i==1, n)))
text(4, 6.4, "expression(bar(x) == sum(frac(x[i], n), i==1, n))",
     cex = .8)
text(8, 5, expression(paste(frac(1, sigma*sqrt(2*pi)), " ",
                            plain(e)^{frac(-(x-mu)^2, 2*sigma^2)})),
     cex = 1.2)

## some other useful symbols
plot.new(); plot.window(c(0,4), c(15,1))
text(1, 1, "universal", adj=0); text(2.5, 1,  "\\042")
text(3, 1, expression(symbol("\042")))
text(1, 2, "existential", adj=0); text(2.5, 2,  "\\044")
text(3, 2, expression(symbol("\044")))
text(1, 3, "suchthat", adj=0); text(2.5, 3,  "\\047")
text(3, 3, expression(symbol("\047")))
text(1, 4, "therefore", adj=0); text(2.5, 4,  "\\134")
text(3, 4, expression(symbol("\134")))
text(1, 5, "perpendicular", adj=0); text(2.5, 5,  "\\136")
text(3, 5, expression(symbol("\136")))
text(1, 6, "circlemultiply", adj=0); text(2.5, 6,  "\\304")
text(3, 6, expression(symbol("\304")))
text(1, 7, "circleplus", adj=0); text(2.5, 7,  "\\305")
text(3, 7, expression(symbol("\305")))
text(1, 8, "emptyset", adj=0); text(2.5, 8,  "\\306")
text(3, 8, expression(symbol("\306")))
text(1, 9, "angle", adj=0); text(2.5, 9,  "\\320")
text(3, 9, expression(symbol("\320")))
text(1, 10, "leftangle", adj=0); text(2.5, 10,  "\\341")
text(3, 10, expression(symbol("\341")))
text(1, 11, "rightangle", adj=0); text(2.5, 11,  "\\361")
text(3, 11, expression(symbol("\361")))
\end{ExampleCode}
\end{Examples}
\HeaderA{png}{BMP, JPEG, PNG and TIFF graphics devices}{png}
\aliasA{bmp}{png}{bmp}
\aliasA{jpeg}{png}{jpeg}
\aliasA{tiff}{png}{tiff}
\keyword{device}{png}
%
\begin{Description}\relax
Graphics devices for BMP, JPEG, PNG and TIFF format bitmap files.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
bmp(filename = "Rplot%03d.bmp",
    width = 480, height = 480, units = "px", pointsize = 12,
    bg = "white", res = NA, family = "", restoreConsole = TRUE,
    type = c("windows", "cairo"), antialias)

jpeg(filename = "Rplot%03d.jpg",
     width = 480, height = 480, units = "px", pointsize = 12,
     quality = 75,
     bg = "white", res = NA, family = "", restoreConsole = TRUE,
     type = c("windows", "cairo"), antialias)

png(filename = "Rplot%03d.png",
    width = 480, height = 480, units = "px", pointsize = 12,
    bg = "white", res = NA, family = "", restoreConsole = TRUE,
    type = c("windows", "cairo", "cairo-png"), antialias)

tiff(filename = "Rplot%03d.tif",
     width = 480, height = 480, units = "px", pointsize = 12,
     compression = c("none", "rle", "lzw", "jpeg", "zip"),
     bg = "white", res = NA, family = "", restoreConsole = TRUE,
     type = c("windows", "cairo"), antialias)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] the name of the output file, up to 511 characters.  The
page number is substituted if a C integer format is included in the
character string, as in the default, and tilde-expansion is
performed (see \code{\LinkA{path.expand}{path.expand}}).   (The result must be less than
600 characters long.  See \code{\LinkA{postscript}{postscript}} for further
details.)

\item[\code{width}] the width of the device.
\item[\code{height}] the height of the device.
\item[\code{units}] The units in which \code{height} and \code{width} are
given.  Can be \code{px} (pixels, the default), \code{in} (inches),
\code{cm} or \code{mm}.
\item[\code{pointsize}] the default pointsize of plotted text, interpreted as
big points (1/72 inch) at \code{res} ppi.
\item[\code{bg}] the initial background colour: can be overridden by setting
par("bg").
\item[\code{quality}] the `quality' of the JPEG image, as a
percentage.  Smaller values will give more compression but also more
degradation of the image.
\item[\code{compression}] the type of compression to be used.
\item[\code{res}] The nominal resolution in ppi which will be recorded in the
bitmap file, if a positive integer.  Also used for units other than
the default.  If not specified, taken as 72 ppi to set the size of
text and line widths.
\item[\code{family}] A length-one character vector specifying the default
font family.  The default means to use the font numbers on the
Windows GDI versions and \code{"sans"} on the cairographics
versions.
\item[\code{restoreConsole}] See the `Details' section of
\code{\LinkA{windows}{windows}}.  For \code{type == "windows"} only.
\item[\code{type}] Should be plotting be done using Windows GDI or cairographics?
\item[\code{antialias}] Length-one character vector.

For allowed values and their effect on fonts with \code{type =
      "windows"} see \code{\LinkA{windows}{windows}}: for that type if the
argument is missing the default is taken from
\code{windows.options()\$bitmap.aa.win}.

For allowed values and their effect (on fonts
and lines) with \code{type = "cairo"} see \code{\LinkA{svg}{svg}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
  
Plots in PNG and JPEG format can easily be converted to many other
bitmap formats, and both can be displayed in modern web browsers.  The
PNG format is lossless and is best for line diagrams and blocks of
colour.  The JPEG format is lossy, but may be useful for image plots,
for example.  The BMP format is standard on Windows, and supported by
most viewers elsewhere.  TIFF is a meta-format: the default format
written by \code{tiff} is lossless and stores RGB values
uncompressed---such files are widely accepted, which is their main
virtue over PNG.

Windows GDI imposes limits on the size of bitmaps: these are not
documented in the SDK and may depend on the version of Windows.
It seems that \code{width} and \code{height} are each limited to
\eqn{2^{15}-1}{}.  In addition, there are limits on the total
number of pixels which depend on the graphics hardware.

By default no resolution is recorded in the file.  Viewers will often
assume a nominal resolution of 72 ppi when none is recorded.  As
resolutions in PNG files are recorded in pixels/metre, the reported
ppi value will be changed slightly.

For graphics parameters that make use of dimensions in inches,
\code{res} ppi (default 72) is assumed.

Both \code{bmp} and \code{png} will use a palette if there are fewer
than 256 colours on the page, and record a 24-bit RGB file otherwise.
For the \code{png} device, \code{type = "cairo"} does the PNG output in
the driver and so is compatible with the \code{"windows"} type.
\code{type = "cairo-png"} uses cairographics' PNG backend which will
never use a palette and normally creates a larger 32-bit ARGB
file---this may work better for specialist uses with semi-transparent
colours.

\code{png(type = "windows")} supports transparent backgrounds on 16-bit
(`High Color') or better screens: use \code{bg =
    "transparent"}.  There is also support for semi-transparent colours
of lines, fills and text.  However, as there is only partial support
for transparency in the graphics toolkit used: if there is a
transparent background semi-transparent colours are painted onto a
slightly off-white background and hence the pixels are opaque.

Not all PNG viewers render files with transparency correctly.
\end{Details}
%
\begin{Value}
A plot device is opened: nothing is returned to the \R{} interpreter.
\end{Value}
%
\begin{Section}{Warnings}
Note that by default the \code{width} and \code{height} values are in
pixels not inches.  A warning will be issued if both are less than 20.

If you plot more than one page on one of these devices and do not
include something like \code{\%d} for the sequence number in
\code{file}, the file will contain the last page plotted.
\end{Section}
%
\begin{Section}{Differences between OSes}
These functions are interfaces to three or more different underlying
devices.
\begin{itemize}

\item On Windows, devices based on plotting to a hidden screen using
Windows' GDI calls.

\item On platforms with support for X11, plotting to a hidden X11
display.

\item On Mac OS X when working at the console and when \R{} is
compiled with suitable support, using Apple's Quartz plotting
system.

\item Where support has been compiled in for cairographics, plotting
on cairo surfaces.  This may use the native platform support for
fonts, or it may use \code{fontconfig} to support a wide range of
font formats.  (This was first available on Windows in \R{} 2.14.0.)

\end{itemize}

Inevitably there will be differences between the options supported and
output produced.  Perhaps the most important are support for
antialiased fonts and semi-transparent colours: the best results are
likely to be obtained with the cairo- or Quartz-based devices where
available.

The default extensions are \file{.jpg} and \file{.tif} on Windows, and
\file{.jpeg} and \file{.tiff} elsewhere.
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is in pixels.
\item Font sizes are in big points interpreted at \code{res} ppi.
\item The default font family is Arial.
\item Line widths are a multiple of 1/96 inch (interpreted at
\code{res} ppi), with a minimum of one pixel (\code{type =
      "windows"}) or 0.01 (\code{type = "cairo"}).
\item The minimum radius of a circle is 1 pixel for \code{type =
      "windows"}.
\item Colours are interpreted by the viewing application.

\end{itemize}

\end{Section}
%
\begin{Note}\relax
The \code{type = "windows"} versions of these devices effectively
plot on a hidden screen and then copy the image to the required
format.  This means that they have the same colour handling as the
actual screen device, and work best if that is set to a 24-bit or
32-bit colour mode.

For high-quality plots you will probably want \code{antialias =
    "cleartype"} if this is not the default on your Windows system.  On
the other hand, \code{png(antialias = "none")} will give the most
compact files
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}}, \code{\LinkA{dev.print}{dev.print}}

\code{\LinkA{bitmap}{bitmap}} provides an alternative way to generate plots in
many bitmap formats if GhostScript is available.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## copy current plot to a (large) PNG file
## Not run: dev.print(png, file = "myplot.png", width = 1024, height = 768)

png(file = "myplot.png", bg = "transparent")
plot(1:10)
rect(1, 5, 3, 7, col = "white")
dev.off()

jpeg(file = "myplot.jpeg")
example(rect)
dev.off()

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{postscript}{PostScript Graphics}{postscript}
\aliasA{.ps.prolog}{postscript}{.ps.prolog}
\keyword{device}{postscript}
%
\begin{Description}\relax
\code{postscript} starts the graphics device driver for producing
PostScript graphics.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
postscript(file = ifelse(onefile, "Rplots.ps", "Rplot%03d.ps"),
           onefile, family, title, fonts, encoding, bg, fg,
           width, height, horizontal, pointsize,
           paper, pagecentre, print.it, command,
           colormodel, useKerning, fillOddEven)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the file.  If it is
\code{""}, the output is piped to the command given by the argument
\code{command}.
If it is of the form \code{"|cmd"}, the output is piped to the
command given by \command{cmd}.

For use with \code{onefile = FALSE} give a \code{printf} format such
as \code{"Rplot\%03d.ps"} (the default in that case).  The string
should not otherwise contain a \code{\%}: if it is really necessary,
use \code{\%\%} in the string for \code{\%} in the file name.
A single integer format matching the \LinkA{regular expression}{regular expression}
\code{"\%[\#0 +=-]*[0-9.]*[diouxX]"} is allowed.

Tilde expansion (see \code{\LinkA{path.expand}{path.expand}}) is done.

\item[\code{onefile}] logical: if true (the default) allow multiple figures
in one file.  If false, generate a file name containing the page
number for each page and use an EPSF header and no
\code{DocumentMedia} comment.  Defaults to the \code{TRUE}.
\item[\code{family}] the initial font family to be used, normally as a
character string.  See the section `Families'.  Defaults to
\code{"Helvetica"}.
\item[\code{title}] title string to embed as the \code{Title} comment in the
file.  Defaults to \code{"R Graphics Output"}.
\item[\code{fonts}] a character vector specifying additional \R{} graphics font
family names for font families whose declarations will be included
in the PostScript file and are available for use with the device.
See `Families' below.  Defaults to \code{NULL}.
\item[\code{encoding}] the name of an encoding file.  Defaults to
\code{"default"}.  The latter is interpreted as
\file{"CP1250.enc"} (Central European), \code{"CP1251.enc"} (Cyrillic),
\code{"CP1253.enc"} (Greek) or \code{"CP1257.enc"} (Baltic) if one
of those codepages is in use, otherwise \file{"WinAnsi.enc"}
(codepage 1252).
The file is looked for in the \file{enc} directory of package
\pkg{grDevices} if the path does not contain a path separator.  An
extension \code{".enc"} can be omitted.

\item[\code{bg}] the initial background color to be used.  If
\code{"transparent"} (or any other non-opaque colour), no background
is painted.  Defaults to \code{"transparent"}.
\item[\code{fg}] the initial foreground color to be used.  Defaults to
\code{"black"}.
\item[\code{width, height}] the width and height of the graphics region in
inches.  Default to \code{0}.

If \code{paper != "special"} and \code{width} or \code{height} is less
than \code{0.1} or too large to give a total margin of 0.5 inch, the
graphics region is reset to the corresponding paper dimension minus 0.5.

\item[\code{horizontal}] the orientation of the printed image, a logical.
Defaults to true, that is landscape orientation on paper sizes
with width less than height.
\item[\code{pointsize}] the default point size to be used.  Strictly
speaking, in bp, that is 1/72 of an inch, but approximately in
points.  Defaults to \code{12}.
\item[\code{paper}] the size of paper in the printer.  The choices are
\code{"a4"}, \code{"letter"} (or \code{"us"}), \code{"legal"} and
\code{"executive"} (and these can be capitalized).
Also, \code{"special"} can be used, when arguments \code{width}
and \code{height} specify the paper size.  A further choice is
\code{"default"} (the default): If this is selected, the papersize
is taken from the option \code{"papersize"} if that is set and to
\code{"a4"} if it is unset or empty.
\item[\code{pagecentre}] logical: should the device region be centred on the
page?  Defaults to true.
\item[\code{print.it}] logical: should the file be printed when the device is
closed?  (This only applies if \code{file} is a real file name.)
Defaults to false.
\item[\code{command}] the command to be used for `printing'.  Defaults
to \code{"default"}, the value of option \code{"printcmd"}.  The
length limit is \code{2*PATH\_MAX},
520 bytes.

\item[\code{colormodel}] a character string describing the color model:
currently allowed values as \code{"srgb"}, \code{"srgb+gray"},
\code{"rgb"}, \code{"rgb-nogray"}, \code{"gray"} (or \code{"grey")} and
\code{"cmyk"}.  Defaults to \code{"srgb"}.  See section
`Color models'.
\item[\code{useKerning}] logical.  Should kerning corrections be included in
setting text and calculating string widths?  Defaults to \code{TRUE}.
\item[\code{fillOddEven}] logical controlling the polygon fill mode:  see
\code{\LinkA{polygon}{polygon}} for details.  Default \code{FALSE}.   
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
All arguments except \code{file} default to values given by
\code{\LinkA{ps.options}{ps.options}()}.  The ultimate defaults are quoted in the
arguments section.

\code{postscript} opens the file \code{file} and the PostScript
commands needed to plot any graphics requested are written to that
file.  This file can then be printed on a suitable device to obtain
hard copy.

The \code{file} argument is interpreted as a C integer format as used
by \code{\LinkA{sprintf}{sprintf}}, with integer argument the page number.
The default gives files \file{Rplot001.ps}, \dots, \file{Rplot999.ps},
\file{Rplot1000.ps}, \dots.

The postscript produced for a single \R{} plot is EPS (\emph{Encapsulated
PostScript}) compatible, and can be included into other documents,
e.g., into LaTeX, using \code{\bsl{}includegraphics\{<filename>\}}.  For use
in this way you will probably want to use \code{\LinkA{setEPS}{setEPS}()} to
set the defaults as \code{horizontal = FALSE, onefile = FALSE, paper =
    "special"}.  Note that the bounding box is for the \emph{device}
region: if you find the white space around the plot region excessive,
reduce the margins of the figure region via \code{\LinkA{par}{par}(mar=)}.

Most of the PostScript prologue used is taken from the \R{} character
vector \code{.ps.prolog}.  This is marked in the output, and can be
changed by changing that vector.  (This is only advisable for
PostScript experts: the standard version is in
\code{namespace:grDevices}.)

A PostScript device has a default family, which can be set by the user
via \code{family}.  If other font families are to be used when drawing
to the PostScript device, these must be declared when the device is
created via \code{fonts};  the font family names for this argument are
\R{} graphics font family names (see the documentation for
\code{\LinkA{postscriptFonts}{postscriptFonts}}).

Line widths as controlled by \code{par(lwd=)} are in multiples of
1/96 inch: multiples less than 1 are allowed.  \code{pch="."} with
\code{cex = 1} corresponds to a square of side 1/72 inch, which is
also the `pixel' size assumed for graphics parameters such as
\code{"cra"}.

When the background colour is fully transparent (as is the initial
default value), the PostScript produced does not paint the
background. Almost all PostScript viewers will use a white canvas so
the visual effect is if the background were white.  This will not be
the case when printing onto coloured paper, though.
\end{Details}
%
\begin{Section}{Families}
Font families are collections of fonts covering the five font faces,
(conventionally plain, bold, italic, bold-italic and symbol) selected
by the graphics parameter \code{\LinkA{par}{par}(font=)} or the grid
parameter \code{\LinkA{gpar}{gpar}(fontface=)}.  Font families can be
specified either as an an initial/default font family for the device
via the \code{family} argument or after the device is opened by
the graphics parameter \code{\LinkA{par}{par}(family=)} or the grid
parameter \code{\LinkA{gpar}{gpar}(fontfamily=)}.  Families which will be
used in addition to the initial family must be specified in the
\code{fonts} argument when the device is opened.

Font families are declared via a call to \code{\LinkA{postscriptFonts}{postscriptFonts}}.

The argument \code{family} specifies the initial/default font family
to be used.  In normal use it is one of \code{"AvantGarde"},
\code{"Bookman"}, \code{"Courier"}, \code{"Helvetica"},
\code{"Helvetica-Narrow"}, \code{"NewCenturySchoolbook"},
\code{"Palatino"} or \code{"Times"}, and refers to the standard Adobe
PostScript fonts families of those names which are included (or
cloned) in all common PostScript devices.

Many PostScript emulators (including those based on
\code{ghostscript}) use the URW equivalents of these fonts, which are
\code{"URWGothic"}, \code{"URWBookman"}, \code{"NimbusMon"},
\code{"NimbusSan"}, \code{"NimbusSanCond"}, \code{"CenturySch"},
\code{"URWPalladio"} and \code{"NimbusRom"} respectively.  If your
PostScript device is using URW fonts, you will obtain access to more
characters and more appropriate metrics by using these names.  To make
these easier to remember, \code{"URWHelvetica" == "NimbusSan"} and
\code{"URWTimes" == "NimbusRom"} are also supported.

Another type of family makes use of CID-keyed fonts for East Asian
languages -- see \code{\LinkA{postscriptFonts}{postscriptFonts}}.

The \code{family} argument is normally a character string naming a
font family, but family objects generated by \code{\LinkA{Type1Font}{Type1Font}}
and \code{\LinkA{CIDFont}{CIDFont}} are also accepted.  For compatibility with
earlier versions of \R{}, the initial family can also be specified as a
vector of four or five afm files.

Note that \R{} does not embed the font(s) used in the PostScript output:
see \code{\LinkA{embedFonts}{embedFonts}} for a utility to help do so.

Viewers and embedding applications frequently substitute fonts for
those specified in the family, and the substitute will often have
slightly different font metrics. \code{useKerning=TRUE} spaces the
letters in the string using kerning corrections for the intended
family: this may look uglier than \code{useKerning=FALSE}.
\end{Section}
%
\begin{Section}{Encodings}
Encodings describe which glyphs are used to display the character codes
(in the range 0--255).  Most commonly \R{} uses ISOLatin1 encoding, and
the examples for \code{\LinkA{text}{text}} are in that encoding.  However,
the encoding used on machines running \R{} may well be different, and by
using the \code{encoding} argument the glyphs can be matched to
encoding in use.  This suffices for European and Cyrillic languages,
but not for CJK languages.  For the latter, composite CID fonts are
used.  These fonts are useful for other languages: for example they
may contain Greek glyphs. (The rest of this section applies only when CID
fonts are not used.)

None of this will matter if only ASCII characters (codes 32--126) are
used as all the encodings (except \code{"TeXtext"}) agree over that
range.  Some encodings are supersets of ISOLatin1, too.  However, if
accented and special characters do not come out as you expect, you may
need to change the encoding.  Some other encodings are supplied with
\R{}: \code{"WinAnsi.enc"} and \code{"MacRoman.enc"} correspond to the
encodings normally used on Windows and Classic Mac OS (at least by
Adobe), and \code{"PDFDoc.enc"} is the first 256 characters of the
Unicode encoding, the standard for PDF.  There are also encodings
\code{"ISOLatin2.enc"}, \code{"CP1250.enc"}, \code{"ISOLatin7.enc"}
(ISO 8859-13), \code{"CP1257.enc"}, and \code{"ISOLatin9.enc"} (ISO
8859-15), \code{"Cyrillic.enc"} (ISO 8859-5), \code{"KOI8-R.enc"},
\code{"KOI8-U.enc"}, \code{"CP1251.enc"}, \code{"Greek.enc"} (ISO
8859-7) and \code{"CP1253.enc"}.  Note that many glyphs in these
encodings are not in the fonts corresponding to the standard families.
(The Adobe ones for all but Courier, Helvetica and Times cover little
more than Latin-1, whereas the URW ones also cover Latin-2, Latin-7,
Latin-9 and Cyrillic but no Greek.  The Adobe exceptions cover the
Latin character sets, but not the Euro.)

If you specify the encoding, it is your responsibility to ensure that
the PostScript font contains the glyphs used.  One issue here is the Euro
symbol which is in the WinAnsi and MacRoman encodings but may well not
be in the PostScript fonts.  (It is in the URW variants; it is not in
the supplied Adobe Font Metric files.)

There is an exception.  Character 45 (\code{"-"}) is always set
as minus (its value in Adobe ISOLatin1) even though it is hyphen in
the other encodings.  Hyphen is available as character 173 (octal
0255) in all the Latin encodings, Cyrillic and Greek.  (This can be
entered as \code{"\bsl{}uad"} in a UTF-8 locale.)  There are some
discrepancies in accounts of glyphs 39 and 96: the supplied encodings
(except CP1250 and CP1251) treat these as `quoteright' and
`quoteleft' (rather than `quotesingle'/`acute'
and `grave' respectively), as they are in the Adobe
documentation.
\end{Section}
%
\begin{Section}{TeX fonts}
TeX has traditionally made use of fonts such as Computer Modern which
are encoded rather differently, in a 7-bit encoding.  This encoding
can be specified by \code{encoding = "TeXtext.enc"}, taking care that
the ASCII characters \code{< > \bsl{} \_ \{ \}} are not available in those
fonts.

There are supplied families \code{"ComputerModern"} and
\code{"ComputerModernItalic"} which use this encoding, and which are
only supported for \code{postscript} (and not \code{pdf}).  They are
intended to use with the Type 1 versions of the TeX CM fonts.  It will
normally be possible to include such output in TeX or LaTeX provided
it is processed with \code{dvips -Ppfb -j0} or the equivalent on your
system. (\code{-j0} turns off font subsetting.)  When \code{family =
    "ComputerModern"} is used, the italic/bold-italic fonts used are
slanted fonts (\code{cmsl10} and \code{cmbxsl10}).  To use text italic
fonts instead, set \code{family = "ComputerModernItalic"}.

These families use the TeX math italic and  symbol fonts for a
comprehensive but incomplete coverage of the glyphs covered by the
Adobe symbol font in other families.  This is achieved by
special-casing the postscript code generated from the supplied
\file{CM\_symbol\_10.afm}.
\end{Section}
%
\begin{Section}{Color models}
The default color model (\code{"srgb"}) is sRGB.

The alternative \code{"srgb+gray"} uses sRGB for colors, but with pure
gray colors (including black and white) expressed as greyscales (which
results in smaller files and can be advantageous with some printer
drivers).  Conversely, its files can be rendered much slower on some
viewers, and there can be a noticeable discontinuity in color
gradients involving gray or white.

Other possibilities are \code{"gray"} (or \code{"grey"}) which used
only greyscales (and converts other colours to a luminance), and
\code{"cmyk"}.  The simplest possible conversion from sRGB to CMYK is
used
(\url{http://en.wikipedia.org/wiki/CMYK_color_model#Mapping_RGB_to_CMYK}),
and raster images are output in RGB.

Color models provided for backwards compatibility are \code{"rgb"})
(which is RGB+gray) and \code{"rgb-nogray"} which use uncalibrated RGB
(as used in \R{} prior to 2.13.0).  These result in slightly smaller
files which may render faster, but do rely on the viewer being
properly calibrated.
\end{Section}
%
\begin{Section}{Printing}
A postscript plot can be printed via \code{postscript} in two ways.
\begin{enumerate}

\item Setting \code{print.it = TRUE} causes the command given in
argument \code{command} to be called with argument \code{"file"}
when the device is closed.  Note that the plot file is not deleted
unless \code{command} arranges to delete it.

\item \code{file=""} or \code{file="|cmd"} can be used to print
using a pipe.  Failure to open the command will probably be reported
to the terminal but not to \R{}, in which case close the
device by \code{dev.off} immediately.

\end{enumerate}

On Windows the default
\code{"printcmd"} is empty and will give an error if
\code{print.it=TRUE} is used.  Suitable commands to spool a PostScript
file to a printer can be found in \file{RedMon} suite available from
\url{http://www.cs.wisc.edu/~ghost/index.html}.  The command will be
run in a minimized window.   GSView 4.x provides \file{gsprint.exe}
which may be more convenient (it requires Ghostscript version 6.50
or later).
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are as a multiple of 1/96 inch, with a minimum
of 0.01 enforced.   
\item Circle of any radius are allowed.
\item Colours are by default specified as sRGB.

\end{itemize}


At very small line widths, the line type may be forced to solid.

Raster images are currently limited to opaque colours.
\end{Section}
%
\begin{Note}\relax
If you see problems with postscript output, do remember that the
problem is much more likely to be in your viewer than in \R{}.  Try
another viewer if possible.  Symptoms for which the viewer has been at
fault are apparent grids on image plots (turn off graphics
anti-aliasing in your viewer if you can) and missing or incorrect glyphs
in text (viewers silently doing font substitution).

Unfortunately the default viewers on most Linux and Mac OS X systems
have these problems, and no obvious way to turn off graphics anti-aliasing.
\end{Note}
%
\begin{Author}\relax
Support for Computer Modern fonts is based on a contribution by
Brian D'Urso \email{durso@hussle.harvard.edu}.
\end{Author}
%
\begin{References}\relax
Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
\emph{The New S Language}.
Wadsworth \& Brooks/Cole.
\end{References}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscriptFonts}{postscriptFonts}},
\code{\LinkA{Devices}{Devices}},
and \code{\LinkA{check.options}{check.options}} which is called from both
\code{\LinkA{ps.options}{ps.options}} and \code{postscript}.

\code{\LinkA{cairo\_ps}{cairo.Rul.ps}} for another device that can produce PostScript.

More details of font families and encodings and especially handling
text in a non-Latin-1 encoding and embedding fonts can be found in

Paul Murrell and Brian Ripley (2006) Non-standard fonts in PostScript
and PDF graphics. \emph{R News}, 6(2):41--47.
\url{http://cran.r-project.org/doc/Rnews/Rnews_2006-2.pdf}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)
## Not run: 
# open the file "foo.ps" for graphics output
postscript("foo.ps")
# produce the desired graph(s)
dev.off()              # turn off the postscript device
options(printcmd='redpr -P"\\printhost\lw"')
postscript(file=tempfile("Rps."), print.it=TRUE)
# produce the desired graph(s)
dev.off()              # send plot file to the printer
## alternative using GSView 4.x
options(printcmd='/GhostGum/gsview/gsprint -query')

# for URW PostScript devices
postscript("foo.ps", family = "NimbusSan")

## for inclusion in Computer Modern TeX documents, perhaps
postscript("cm_test.eps", width = 4.0, height = 3.0,
           horizontal = FALSE, onefile = FALSE, paper = "special",
           family = "ComputerModern", encoding = "TeXtext.enc")
## The resultant postscript file can be used by dvips -Ppfb -j0.

## To test out encodings, you can use
TestChars <- function(encoding="ISOLatin1", family="URWHelvetica")
{
    postscript(encoding=encoding, family=family)
    par(pty="s")
    plot(c(-1,16), c(-1,16), type="n", xlab="", ylab="",
         xaxs="i", yaxs="i")
    title(paste("Centred chars in encoding", encoding))
    grid(17, 17, lty=1)
    for(i in c(32:255)) {
        x <- i %% 16
        y <- i %/% 16
        points(x, y, pch=i)
    }
    dev.off()
}
## there will be many warnings.  We use URW to get a complete enough
## set of font metrics.
TestChars()
TestChars("ISOLatin2")
TestChars("WinAnsi")

## End(Not run)

\end{ExampleCode}
\end{Examples}
\HeaderA{postscriptFonts}{PostScript and PDF Font Families}{postscriptFonts}
\aliasA{pdfFonts}{postscriptFonts}{pdfFonts}
\keyword{device}{postscriptFonts}
%
\begin{Description}\relax
These functions handle the translation of a \R{} graphics
font family name to a PostScript or PDF font description, used by the
\code{\LinkA{postscript}{postscript}} or \code{\LinkA{pdf}{pdf}} graphics devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
postscriptFonts(...)
pdfFonts(...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] either character strings naming mappings to display,
or named arguments specifying mappings to add or change.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If these functions are called with no argument they list all the
existing mappings, whereas if they are called with named arguments
they add (or change) mappings.

A PostScript or PDF device is created with a default font family (see the
documentation for \code{\LinkA{postscript}{postscript}}), but it is also possible
to specify a font family when drawing to the device (for example, see
the documentation for \code{"family"} in \code{\LinkA{par}{par}} and for
\code{"fontfamily"} in \code{\LinkA{gpar}{gpar}} in the \pkg{grid} package).

The font family sent to the device is a simple string name, which must be
mapped to a set of PostScript fonts.  Separate lists of mappings for
\code{postscript} and \code{pdf} devices are  maintained for the
current \R{} session and can be added to by the user.

The \code{postscriptFonts} and \code{pdfFonts} functions can be used
to list existing mappings and to define new mappings.  The
\code{\LinkA{Type1Font}{Type1Font}} and \code{\LinkA{CIDFont}{CIDFont}} functions can be
used to create new mappings, when the \code{xxxFonts} function is used
to add them to the database.  See the examples.

Default mappings are provided for three device-independent family
names: \code{"sans"} for a sans-serif font (to \code{"Helvetica"}),
\code{"serif"} for a serif font (to \code{"Times"}) and \code{"mono"}
for a monospaced font (to \code{"Courier"}).

Mappings for a number of standard Adobe fonts (and URW equivalents)
are also provided: \code{"AvantGarde"},
\code{"Bookman"}, \code{"Courier"}, \code{"Helvetica"},
\code{"Helvetica-Narrow"}, \code{"NewCenturySchoolbook"},
\code{"Palatino"} and \code{"Times"};
\code{"URWGothic"}, \code{"URWBookman"}, \code{"NimbusMon"},
\code{"NimbusSan"} (synonym \code{"URWHelvetica"}),
\code{"NimbusSanCond"}, \code{"CenturySch"}, \code{"URWPalladio"} and
\code{"NimbusRom"} (synonym \code{"URWTimes"}).

There are also mappings for \code{"ComputerModern"} and
\code{"ComputerModernItalic"}.

Finally, there are some default mappings for East Asian locales
described in a separate section.

The specification of font metrics and encodings is described in the help
for the \code{\LinkA{postscript}{postscript}} function.

The fonts are not embedded in the resulting PostScript or PDF file, so
software including the PostScript or PDF plot file should either embed
the font outlines (usually from \file{.pfb} or \file{.pfa} files) or
use DSC comments to instruct the print spooler or including
application to do so (see also \code{\LinkA{embedFonts}{embedFonts}}).

A font family has both an \R{}-level name, the argument name used when
\code{postscriptFonts} was called, and an internal name, the
\code{family} component.  These two names are the same for all the
pre-defined font families.

Once a font family is in use it cannot be changed.  `In use'
means that it has been specified \emph{via} a \code{family} or
\code{fonts} argument to an invocation of the same graphics device
already in the \R{} session.  (For these purposes \code{xfig} counts the
same as \code{postscript} but only uses some of the predefined mappings.)
\end{Details}
%
\begin{Value}
A list of one or more font mappings.
\end{Value}
%
\begin{Section}{East Asian fonts}
There are some default mappings for East Asian locales:\\{}
\code{"Japan1"}, \code{"Japan1HeiMin"}, \code{"Japan1GothicBBB"},
and \code{"Japan1Ryumin"} for Japanese;
\code{"Korea1"} and \code{"Korea1deb"} for Korean;
\code{"GB1"} (Simplified Chinese) for mainland China and Singapore;
\code{"CNS1"} (Traditional Chinese) for Hong Kong and Taiwan.

These refer to the following fonts

\Tabular{ll}{
Japan1 (PS) & \code{HeiseiKakuGo-W5}\\{} & Linotype Japanese printer font\\{}
Japan1 (PDF) & \code{KozMinPro-Regular-Acro}\\{} & from Adobe Reader 7.0 Japanese Font Pack\\{}
Japan1HeiMin (PS) & \code{HeiseiMin-W3}\\{} & Linotype Japanese printer font\\{}
Japan1HeiMin (PDF) & \code{HeiseiMin-W3-Acro}\\{} & from Adobe Reader 7.0 Japanese Font Pack\\{}
Japan1GothicBBB & \code{GothicBBB-Medium}\\{} & Japanese-market PostScript printer font\\{}
Japan1Ryumin & \code{Ryumin-Light}\\{} & Japanese-market PostScript printer font\\{}
Korea1 (PS) & \code{Baekmuk-Batang}\\{}  & TrueType font found on some Linux systems\\{}
Korea1 (PDF) & \code{HYSMyeongJoStd-Medium-Acro}\\{}  & from Adobe Reader 7.0 Korean Font Pack\\{}
Korea1deb (PS) & \code{Batang-Regular}\\{}  & another name for Baekmuk-Batang\\{}
Korea1deb (PDF) & \code{HYGothic-Medium-Acro}\\{}  & from Adobe Reader 4.0 Korean Font Pack\\{}
GB1 (PS) & \code{BousungEG-Light-GB}\\{}  & TrueType font found on some Linux systems\\{}
GB1 (PDF) & \code{STSong-Light-Acro}\\{}  & from Adobe Reader 7.0 Simplified Chinese Font Pack\\{}
CNS1 (PS) & \code{MOESung-Regular}\\{} & Ken Lunde's CJKV resources\\{}
CNS1 (PDF) & \code{MSungStd-Light-Acro}\\{}  & from Adobe Reader 7.0 Traditional Chinese Font Pack\\{}
}
\code{Baekmuk-Batang} can be found at \url{ftp://ftp.mizi.com/pub/baekmuk/}.
\code{BousungEG-Light-GB} can be found at
\url{ftp://ftp.gnu.org/pub/non-gnu/chinese-fonts-truetype/}.
Ken Lunde's CJKV resources are at
\url{ftp://ftp.oreilly.com/pub/examples/nutshell/cjkv/adobe/samples/}.
These will need to be installed or otherwise made available to the
postscript/PDF interpreter such as ghostscript (and not all
interpreters can handle TrueType fonts).

You may well find that your postscript/PDF interpreters has been set
up to provide aliases for many of these fonts.  For example,
ghostscript on Windows can optionally be installed to map common CJK
fonts names to Windows TrueType fonts.  (You may want to add the
\code{-Acro} versions as well.)

Adding a mapping for a CID-keyed font is for gurus only.
\end{Section}
%
\begin{Author}\relax
Support for Computer Modern fonts is based on a contribution by
Brian D'Urso \email{durso@hussle.harvard.edu}.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}};  \code{\LinkA{Type1Font}{Type1Font}}
and \code{\LinkA{CIDFont}{CIDFont}} for specifying new font mappings.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
postscriptFonts()
## This duplicates "ComputerModernItalic".
CMitalic <- Type1Font("ComputerModern2",
                      c("CM_regular_10.afm", "CM_boldx_10.afm",
                        "cmti10.afm", "cmbxti10.afm",
                         "CM_symbol_10.afm"),
                      encoding = "TeXtext.enc")
postscriptFonts(CMitalic = CMitalic)

## A CID font for Japanese using a different CMap and
## corresponding cmapEncoding.
`Jp_UCS-2` <- CIDFont("TestUCS2",
                  c("Adobe-Japan1-UniJIS-UCS2-H.afm",
                    "Adobe-Japan1-UniJIS-UCS2-H.afm",
                    "Adobe-Japan1-UniJIS-UCS2-H.afm",
                    "Adobe-Japan1-UniJIS-UCS2-H.afm"),
                  "UniJIS-UCS2-H", "UCS-2")
pdfFonts(`Jp_UCS-2` = `Jp_UCS-2`)
names(pdfFonts())
\end{ExampleCode}
\end{Examples}
\HeaderA{pretty.Date}{Pretty Breakpoints for Date-Time Classes}{pretty.Date}
\aliasA{pretty.POSIXt}{pretty.Date}{pretty.POSIXt}
\keyword{dplot}{pretty.Date}
%
\begin{Description}\relax
Compute a  sequence of about \code{n+1} equally spaced `nice'
values which cover the range of the values in \code{x}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
## S3 method for class 'Date'
pretty(x, n = 5, min.n = n %/% 2, sep = " ", ...)
## S3 method for class 'POSIXt'
pretty(x, n = 5, min.n = n %/% 2, sep = " ", ...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] an object of class \code{"Date"} or \code{"POSIXt"} (i.e.,
\code{"POSIXct"} or \code{"POSIXlt"}). 
\item[\code{n}] integer giving the \emph{desired} number of
intervals.  
\item[\code{min.n}] nonnegative integer giving the \emph{minimal} number of
intervals.  
\item[\code{sep}] character string, serving as a separator for certain
formats (e.g., between month and year). 
\item[\code{...}] further arguments for compatibility with the generic,
ignored.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A vector (of the suitable class) of locations, with attribute
\code{"labels"} giving corresponding formatted character labels.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{pretty}{pretty}} for the default method.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}

steps <-
    list("10 secs", "1 min", "5 mins", "30 mins", "6 hours", "12 hours",
         "1 DSTday", "2 weeks", "1 month", "6 months", "1 year",
         "10 years", "50 years", "1000 years")

names(steps) <- paste("span =", unlist(steps))

x <- as.POSIXct("2002-02-02 02:02")
lapply(steps,
       function(s) {
           at <- pretty(seq(x, by = s, length = 2), n = 5)
           attr(at, "labels")
       })

\end{ExampleCode}
\end{Examples}
\HeaderA{ps.options}{Auxiliary Function to Set/View Defaults for Arguments of postscript}{ps.options}
\aliasA{setEPS}{ps.options}{setEPS}
\aliasA{setPS}{ps.options}{setPS}
\keyword{device}{ps.options}
%
\begin{Description}\relax
The auxiliary function \code{ps.options} can be used to set or view
(if called without arguments) the default values for some of the
arguments to \code{\LinkA{postscript}{postscript}}.

\code{ps.options} needs to be called before calling \code{postscript},
and the default values it sets can be overridden by supplying
arguments to \code{postscript}.

\end{Description}
%
\begin{Usage}
\begin{verbatim}
ps.options(..., reset = FALSE, override.check = FALSE)

setEPS(...)
setPS(...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] arguments \code{onefile}, \code{family}, \code{title},
\code{fonts},
\code{encoding}, \code{bg}, \code{fg}, \code{width}, \code{height},
\code{horizontal}, \code{pointsize},  \code{paper},
\code{pagecentre}, \code{print.it}, \code{command},
\code{colormodel} and \code{fillOddEven} can be supplied.  \code{onefile},
\code{horizontal} and \code{paper} are \emph{ignored}
for \code{setEPS} and \code{setPS}.
\item[\code{reset}] logical: should the defaults be reset to their
`factory-fresh' values?
\item[\code{override.check}] logical argument passed to
\code{\LinkA{check.options}{check.options}}.  See the Examples.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If both \code{reset = TRUE} and \code{...} are supplied the defaults
are first reset to the `factory-fresh' values and then the new
values are applied.

For backwards compatibility argument \code{append} is accepted but
ignored with a warning.

\code{setEPS} and \code{setPS} are wrappers to set defaults
appropriate for figures for inclusion in documents (the default size
is 7 inches square unless \code{width} or \code{height} is supplied)
and for spooling to a PostScript printer respectively.  For historical
reasons the latter is the ultimate default.
\end{Details}
%
\begin{Value}
A named list of all the previous defaults.  If \code{...} or
\code{reset = TRUE} is supplied the result has the visibility flag
turned off.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf.options}{pdf.options}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
ps.options(bg = "pink")
utils::str(ps.options())

### ---- error checking of arguments: ----
ps.options(width=0:12, onefile=0, bg=pi)
# override the check for 'width', but not 'bg':
ps.options(width=0:12, bg=pi, override.check = c(TRUE,FALSE))
utils::str(ps.options())
ps.options(reset = TRUE) # back to factory-fresh
\end{ExampleCode}
\end{Examples}
\HeaderA{recordGraphics}{Record Graphics Operations}{recordGraphics}
\keyword{device}{recordGraphics}
%
\begin{Description}\relax
Records arbitrary code on the graphics engine display list.
Useful for encapsulating calculations with graphical output
that depends on the calculations.
Intended \emph{only} for expert use.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
recordGraphics(expr, list, env)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{expr}] object of mode \code{\LinkA{expression}{expression}} or \code{call} or
an unevaluated expression.
\item[\code{list}] a list defining the environment in which \code{expr} is to
be evaluated.
\item[\code{env}] An \code{\LinkA{environment}{environment}} specifying
where \R{} looks for objects not found in
\code{envir}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The code in \code{expr} is evaluated in an environment constructed
from \code{list}, with \code{env} as the parent of that environment.

All three arguments are saved on the graphics engine display list
so that on a device resize or copying between devices, the original
evaluation environment can be recreated and the code can be
re-evaluated to reproduce the graphical output.
\end{Details}
%
\begin{Value}
The value from evaluating \code{expr}.
\end{Value}
%
\begin{Section}{Warning}
This function is not intended for general use.  Incorrect or
improper use of this function could lead to unintended and/or
undesirable results.

An example of acceptable use is querying the current state
of a graphics device or graphics system setting and then
calling a graphics function.

An example of improper use would be calling the \code{assign} function
to performing assignments in the global environment.
\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{eval}{eval}} 
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
require(graphics)

plot(1:10)
# This rectangle remains 1inch wide when the device is resized
recordGraphics(
  {
    rect(4, 2,
         4 + diff(par("usr")[1:2])/par("pin")[1], 3)
  },
  list(),
  getNamespace("graphics"))
\end{ExampleCode}
\end{Examples}
\HeaderA{recordPlot}{Record and Replay Plots}{recordPlot}
\aliasA{print.recordedplot}{recordPlot}{print.recordedplot}
\aliasA{replayPlot}{recordPlot}{replayPlot}
\keyword{iplot}{recordPlot}
%
\begin{Description}\relax
Functions to save the current plot in an \R{} variable, and to replay it.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
recordPlot()
replayPlot(x)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] A saved plot.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
These functions record and replay the displaylist of the current
graphics device.  The returned object is of class
\code{"recordedplot"}, and \code{replayPlot} acts as a \code{print}
method for that class.

The returned object is stored as a pairlist, but the usual methods for
examining \R{} objects such as \code{\LinkA{deparse}{deparse}} and
\code{\LinkA{str}{str}} are liable to mislead. 
\end{Details}
%
\begin{Value}
\code{recordPlot} returns an object of class \code{"recordedplot"}.

\code{replayPlot} has no return value.
\end{Value}
%
\begin{Section}{Warning}
The format of recorded plots may change between \R{} versions.
Recorded plots should \strong{not} be used as a permanent
storage format for \R{} plots.

\R{} will always attempt to replay a recorded plot, but if the plot was 
recorded with a different \R{} version then bad things may happen.
\end{Section}
\HeaderA{rgb}{RGB Color Specification}{rgb}
\keyword{color}{rgb}
%
\begin{Description}\relax
This function creates colors corresponding to the given
intensities (between 0 and \code{max}) of the red, green and blue
primaries.  The colour specification refers to the
standard sRGB colorspace (IEC standard 61966).

An alpha transparency value can also be specified (as an opacity, so
\code{0} means fully transparent and \code{max} means opaque).  If
\code{alpha} is not specified, an opaque colour is generated.

The \code{names} argument may be used to provide names for the
colors.

The values returned by these functions can be used with a
\code{col=} specification in graphics functions or in \code{\LinkA{par}{par}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rgb(red, green, blue, alpha, names = NULL, maxColorValue = 1)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{red, blue, green, alpha}] numeric vectors with values in \eqn{[0, M]}{}
where \eqn{M}{} is \code{maxColorValue}.  When this is \code{255}, the
\code{red}, \code{blue}, \code{green}, and \code{alpha}
values are coerced to integers in \code{0:255} and the result is
computed most efficiently.
\item[\code{names}] character. The names for the resulting vector.
\item[\code{maxColorValue}] number giving the maximum of the color values
range, see above.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
The colors may be specified by passing a matrix or dataframe as argument
\code{red}, and leaving \code{blue} and \code{green} missing.
In this case the first three columns of \code{red} are taken to be
the \code{red}, \code{green} and \code{blue} values.

Semi-transparent colors (\code{0 < alpha < 1}) are supported only on
some devices: at the time of writing on the \code{\LinkA{pdf}{pdf}},
\code{windows}, \code{quartz} and \code{X11(type="cairo")} devices and
associated bitmap devices (\code{jpeg}, \code{png}, \code{bmp},
\code{tiff} and \code{bitmap}). They are supported by several
third-party devices such as those in packages \Rhref{http://CRAN.R-project.org/package=Cairo}{\pkg{Cairo}},
\Rhref{http://CRAN.R-project.org/package=cairoDevice}{\pkg{cairoDevice}} and \Rhref{http://CRAN.R-project.org/package=JavaGD}{\pkg{JavaGD}}.  Only some of these
devices support semi-transparent backgrounds.

Most other graphics devices plot semi-transparent colors as fully
transparent, usually with a warning when first encountered.
\end{Details}
%
\begin{Value}
A character vector with elements of 7 or 9 characters, \code{"\#"}
followed by the red, blue, green and optionally alpha values in
hexadecimal (after rescaling to \code{0 ... 255}).  The optional alpha
values range from \code{0} (fully transparent) to \code{255} (opaque).

\R{} does \strong{not} use `premultiplied alpha'.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{col2rgb}{col2rgb}} for translating \R{} colors to RGB vectors;
\code{\LinkA{rainbow}{rainbow}}, \code{\LinkA{hsv}{hsv}}, \code{\LinkA{hcl}{hcl}},
\code{\LinkA{gray}{gray}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
rgb(0,1,0)

rgb((0:15)/15, green=0, blue=0, names=paste("red",0:15,sep="."))

rgb(0, 0:12, 0, max = 255)# integer input

ramp <- colorRamp(c("red", "white"))
rgb( ramp(seq(0, 1, length = 5)), max = 255)
\end{ExampleCode}
\end{Examples}
\HeaderA{rgb2hsv}{RGB to HSV Conversion}{rgb2hsv}
\keyword{color}{rgb2hsv}
\keyword{dplot}{rgb2hsv}
%
\begin{Description}\relax
\code{rgb2hsv} transforms colors
from RGB space (red/green/blue)
into HSV space (hue/saturation/value).
\end{Description}
%
\begin{Usage}
\begin{verbatim}
rgb2hsv(r, g = NULL, b = NULL, maxColorValue = 255)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{r}] vector of `red' values in \eqn{[0, M]}{}, (\eqn{M
      = }{}\code{maxColorValue}) or 3-row rgb matrix.
\item[\code{g}] vector of `green' values, or \code{\LinkA{NULL}{NULL}} when
\code{r} is a matrix.
\item[\code{b}] vector of `blue' values, or \code{\LinkA{NULL}{NULL}} when
\code{r} is a matrix.
\item[\code{maxColorValue}] number giving the maximum of the RGB color values
range.  The default \code{255} corresponds to the typical \code{0:255}
RGB coding as in \code{\LinkA{col2rgb}{col2rgb}()}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Value (brightness) gives the amount of light in the color.\\{}
Hue describes the dominant wavelength.\\{}
Saturation is the amount of Hue mixed into the color.

An HSV colorspace is relative to an RGB colorspace, which in \R{}
is sRGB, which has an implicit gamma correction.
\end{Details}
%
\begin{Value}
A matrix with a column for each color.  The three rows of the matrix
indicate hue, saturation and value and are named \code{"h"},
\code{"s"}, and \code{"v"} accordingly.
\end{Value}
%
\begin{Author}\relax
\R{} interface by Wolfram Fischer \email{wolfram@fischer-zim.ch};\\{}
C code mainly by Nicholas Lewin-Koh \email{nikko@hailmail.net}.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{hsv}{hsv}}, \code{\LinkA{col2rgb}{col2rgb}}, \code{\LinkA{rgb}{rgb}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## These (saturated, bright ones) only differ by hue
(rc <- col2rgb(c("red", "yellow","green","cyan", "blue", "magenta")))
(hc <- rgb2hsv(rc))
6 * hc["h",] # the hues are equispaced


(rgb3 <- floor(256 * matrix(stats::runif(3*12), 3,12)))
(hsv3 <- rgb2hsv(rgb3))
## Consistency :
stopifnot(rgb3 == col2rgb(hsv(h=hsv3[1,], s=hsv3[2,], v=hsv3[3,])),
          all.equal(hsv3, rgb2hsv(rgb3/255, maxColorValue = 1)))

## A (simplified) pure R version -- originally by Wolfram Fischer --
## showing the exact algorithm:
rgb2hsvR <- function(rgb, gamma = 1, maxColorValue = 255)
{
    if(!is.numeric(rgb)) stop("rgb matrix must be numeric")
    d <- dim(rgb)
    if(d[1] != 3) stop("rgb matrix must have 3 rows")
    n <- d[2]
    if(n == 0) return(cbind(c(h=1,s=1,v=1))[,0])
    rgb <- rgb/maxColorValue
    if(gamma != 1) rgb <- rgb ^ (1/gamma)

    ## get the max and min
    v <- apply( rgb, 2, max)
    s <- apply( rgb, 2, min)
    D <- v - s # range

    ## set hue to zero for undefined values (gray has no hue)
    h <- numeric(n)
    notgray <- ( s != v )

    ## blue hue
    idx <- (v == rgb[3,] & notgray )
    if (any (idx))
        h[idx] <- 2/3 + 1/6 * (rgb[1,idx] - rgb[2,idx]) / D[idx]
    ## green hue
    idx <- (v == rgb[2,] & notgray )
    if (any (idx))
        h[idx] <- 1/3 + 1/6 * (rgb[3,idx] - rgb[1,idx]) / D[idx]
    ## red hue
    idx <- (v == rgb[1,] & notgray )
    if (any (idx))
        h[idx] <-       1/6 * (rgb[2,idx] - rgb[3,idx]) / D[idx]

    ## correct for negative red
    idx <- (h < 0)
    h[idx] <- 1+h[idx]

    ## set the saturation
    s[! notgray] <- 0;
    s[notgray] <- 1 - s[notgray] / v[notgray]

    rbind( h=h, s=s, v=v )
}

## confirm the equivalence:
all.equal(rgb2hsv (rgb3),
          rgb2hsvR(rgb3), tol=1e-14) # TRUE
\end{ExampleCode}
\end{Examples}
\HeaderA{savePlot}{Save Windows Plot to a File}{savePlot}
\keyword{misc}{savePlot}
%
\begin{Description}\relax
Saves the current plot on a \code{windows} device to a file.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
savePlot(filename = "Rplot",
         type = c("wmf", "emf", "png", "jpg", "jpeg", "bmp",
                  "tif", "tiff", "ps", "eps", "pdf"),
         device = dev.cur(),
         restoreConsole = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] The filename under which to save the plot.
Tilde-expansion (see \code{\LinkA{path.expand}{path.expand}} is supported.
\item[\code{type}] The type of plot, Windows metafile, PNG, JPEG, BMP
(Windows bitmap format), TIFF, PostScript or PDF.
\item[\code{device}] A device number of a \code{windows} device, by default
the current device.
\item[\code{restoreConsole}] See the `Details' section
of \code{\LinkA{windows}{windows}}.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
This is equivalent to selecting the `Save as' menu item on the
`File' menu of a \code{\LinkA{windows}{windows}} device.

If \code{filename} does not include a dot (`.'), savePlot
will add the file type as an extension; that is, the filename will
be set to \code{paste(filename,type,".")}. If a dot is present in
\code{filename}, the filename is assumed to include an extension and
is used without change.

Using \code{filename} as \code{"clipboard"} or \code{""} with
\code{type = "wmf"} will copy to the clipboard.

Types \code{"eps"} and \code{"ps"} are the same thing apart from the
extension for the default \code{filename}.  Similarly
\code{"wmf"}/\code{"emf"}, \code{"jpeg"}/\code{"jpg"} and
\code{"tiff"}/\code{"tif"}.

JPEG quality is 75\%, and TIFF is saved without compression.
\end{Details}
%
\begin{Value}
None, but a plot file will be created.
\end{Value}
%
\begin{Note}\relax
There is a similar function of the same name but fewer types for
cairo-based \code{X11} devices on Unix-alikes
\end{Note}
%
\begin{SeeAlso}\relax
\code{\LinkA{png}{png}}, \code{\LinkA{dev.print}{dev.print}}
\end{SeeAlso}
\HeaderA{trans3d}{3D to 2D Transformation for Perspective Plots}{trans3d}
\keyword{dplot}{trans3d}
%
\begin{Description}\relax
Projection of 3-dimensional to 2-dimensional points using a 4x4
viewing transformation matrix.  Mainly for adding to
perspective plots such as \code{\LinkA{persp}{persp}}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
trans3d(x,y,z, pmat)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y, z}] numeric vectors of equal length, specifying points in
3D space.
\item[\code{pmat}] a \eqn{4 \times 4}{} \emph{viewing transformation matrix},
suitable for projecting the 3D coordinates \eqn{(x,y,z)}{} into the 2D
plane using homogeneous 4D coordinates \eqn{(x,y,z,t)}{};
such matrices are returned by \code{\LinkA{persp}{persp}()}.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
a list with two components
\begin{ldescription}
\item[\code{x,y}] the projected 2d coordinates of the 3d input \code{(x,y,z)}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
 \code{\LinkA{persp}{persp}} 
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}

## See  help(persp) {after attaching the 'graphics' package}
##      -----------
\end{ExampleCode}
\end{Examples}
\HeaderA{Type1Font}{Type 1 and CID Fonts}{Type1Font}
\aliasA{CIDFont}{Type1Font}{CIDFont}
\keyword{device}{Type1Font}
%
\begin{Description}\relax
These functions are used to define the translation of a \R{} graphics
font family name to a Type 1 or CID font descriptions, used by both
the \code{\LinkA{postscript}{postscript}} and \code{\LinkA{pdf}{pdf}} graphics devices.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
Type1Font(family, metrics, encoding = "default")

CIDFont(family, cmap, cmapEncoding, pdfresource = "")
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{family}] a character string giving the name to be used internally
for a Type 1 or CID-keyed font family.  This needs to uniquely
identify each family, so if you modify a family which is in use
(see \code{\LinkA{postscriptFonts}{postscriptFonts}}) you need to change the family name.
\item[\code{metrics}] a character vector of four or five strings giving paths
to the afm (Adobe Font Metric) files for the font.
\item[\code{cmap}] the name of a CMap file for a CID-keyed font.
\item[\code{encoding}] for \code{Type1Font}, the name of an encoding file.
Defaults to \code{"default"}, which maps on Unix-alikes to
\code{"ISOLatin1.enc"} and on Windows to \code{"WinAnsi.enc"}.
Otherwise, a file name in the \file{enc} directory of the
\pkg{grDevices} package, which is used if the path does not contain a
path separator.  An extension \code{".enc"} can be omitted.
\item[\code{cmapEncoding}] 
The name of a character encoding to be used with the named CMap
file: strings will be translated to this encoding when written to
the file.
\item[\code{pdfresource}] A chunk of PDF code;  only required for using
a CID-keyed font on \code{pdf}; users should not be expected to
provide this.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
For \code{Type1Fonts}, if four \file{.afm} files are supplied the
fifth is taken to be \code{"Symbol.afm"}.  Relative paths are taken
relative to the directory \file{\var{\LinkA{R\_HOME}{R.Rul.HOME}}/library/grDevices/afm}.
The fifth (symbol) font must be in \code{AdobeSym} encoding.
However, the glyphs in the first four fonts are referenced by name
and any encoding given within the \file{.afm} files is not used.

As from \R{} 2.14.0 the \file{.afm} files may be compressed with (or
without) final extension \file{.gz}: the files which ship with \R{} are
installed as compressed files with this extension.

Glyphs in CID-keyed fonts are accessed by ID (number) and not by name.
The CMap file maps encoded strings (usually in a MBCS) to IDs, so
\code{cmap} and \code{cmapEncoding} specifications must match.  There
are no real bold or italic versions of CID fonts (bold/italic were
very rarely used in traditional CJK topography), and for the
\code{\LinkA{pdf}{pdf}} device all four font faces will be identical.
However, for the \code{\LinkA{postscript}{postscript}} device, bold and italic (and
bold italic) are emulated.

CID-keyed fonts are intended only for use for the glyphs of CJK
languages, which are all monospaced and are all treated as filling the
same bounding box.  (Thus \code{\LinkA{plotmath}{plotmath}} will work with such
characters, but the spacing will be less carefully controlled than
with Western glyphs.)  The CID-keyed fonts do contain other
characters, including a Latin alphabet:  non-CJK glyphs are regarded
as monospaced with half the width of CJK glyphs.  This is often the
case, but sometimes Latin glyphs designed for proportional spacing are
used (and may look odd).  We strongly recommend that CID-keyed fonts
are \bold{only} used for CJK glyphs.
\end{Details}
%
\begin{Value}
A list of class \code{"Type1Font"} or \code{"CIDFont"}.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{postscript}{postscript}}, \code{\LinkA{pdf}{pdf}},
\code{\LinkA{postscriptFonts}{postscriptFonts}}, and \code{\LinkA{pdfFonts}{pdfFonts}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## This duplicates "ComputerModernItalic".
CMitalic <- Type1Font("ComputerModern2",
                      c("CM_regular_10.afm", "CM_boldx_10.afm",
                        "cmti10.afm", "cmbxti10.afm",
                        "CM_symbol_10.afm"),
                      encoding = "TeXtext.enc")

## Not run: 
## This could be used by
postscript(family = CMitalic)
## or
postscriptFonts(CMitalic = CMitalic)  # once in a session
postscript(family = "CMitalic", encoding = "TeXtext.enc")

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{windows}{Windows Graphics Devices}{windows}
\aliasA{print.SavedPlots}{windows}{print.SavedPlots}
\aliasA{win.graph}{windows}{win.graph}
\aliasA{win.metafile}{windows}{win.metafile}
\aliasA{win.print}{windows}{win.print}
\aliasA{X11}{windows}{X11}
\aliasA{x11}{windows}{x11}
\aliasA{[.SavedPlots}{windows}{[.SavedPlots}
\keyword{device}{windows}
%
\begin{Description}\relax
A graphics device is opened.  For \code{windows}, \code{win.graph},
\code{x11} and \code{X11} this is a window on the current
Windows display: the multiple names are for compatibility with other
systems.  \code{win.metafile} prints to a file and \code{win.print} to
the Windows print system.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
windows(width, height, pointsize, record, rescale, xpinch, ypinch,
        bg, canvas, gamma, xpos, ypos, buffered, title,
        restoreConsole, clickToConfirm, fillOddEven,
        family, antialias)

win.graph(width, height, pointsize)
x11(width, height, pointsize, bg, gamma, xpos, ypos, title)
X11(width, height, pointsize, bg, gamma, xpos, ypos, title)

win.metafile(filename = "", width = 7, height = 7, pointsize = 12,
             family, restoreConsole = TRUE)

win.print(width = 7, height = 7, pointsize = 12, printer = "",
          family, antialias, restoreConsole = TRUE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{width, height}] the (nominal) width and height of the canvas of
the plotting window in inches.  Default \code{7}.
\item[\code{pointsize}] the default pointsize of plotted text, interpreted as
big points (1/72 inch).  Values are rounded to the nearest integer:
values less than or equal to zero are reset to \code{12}, the
default.
\item[\code{record}] logical: sets the initial state of the flag for
recording plots.  Default \code{FALSE}.
\item[\code{rescale}] character, one of \code{c("R", "fit", "fixed")}.
Controls the action for resizing of the device.  Default
\code{"R"}.  See the `Resizing options' section.
\item[\code{xpinch, ypinch}] double.  Pixels per inch, horizontally and
vertically.  Default \code{NA\_real\_}, which means to take the
value from Windows.
\item[\code{bg}] color.  The initial background color.  Default
\code{"transparent"}.
\item[\code{canvas}] color.  The color of the canvas which is visible
when the background color is transparent.  Should be a solid color
(and any alpha value will be ignored).  Default \code{"white"}.
\item[\code{gamma}] gamma correction fudge factor.
Colours in R are sRGB;  if your monitor does not conform to
sRGB, you might be able to improve things by tweaking this
parameter to apply additional gamma correction to the RGB channels.
By default 1 (no additional gamma correction).
\item[\code{xpos, ypos}] integer.  Position of the top left of the window, in
pixels.  Negative values are taken from the opposite edge of the
monitor.  Missing values (the default) mean take the default from the
\file{\LinkA{Rconsole}{Rconsole}} file, which in turn defaults to
\code{xpos=-25, ypos=0}: this puts the right edge of the window 25
pixels from the right edge of the monitor.
\item[\code{buffered}] logical.  Should the screen output be double-buffered?
Default \code{TRUE}.
\item[\code{title}] character string, up to 100 bytes.  With the default
\code{""}, a suitable title is created internally.  A C-style format
for an integer will be substituted by the device number.
\item[\code{filename}] the name of the output file: it will be an enhanced
Windows metafile, usually given extension \file{.emf} or
\file{.wmf}.  Up to 511 characters are allowed. The page number is
substituted if an integer format is included in the character
string (see \code{\LinkA{postscript}{postscript}} for further details) and
tilde-expansion (see \code{\LinkA{path.expand}{path.expand}}) is performed. (The
result must be less than 600 characters long.)  The default,
\code{""}, means the clipboard.
\item[\code{printer}] The name of a printer as known to Windows. The default
causes a dialog box to come up for the user to choose a printer.
\item[\code{restoreConsole}] logical:  see the `Details' below.  Defaults to
\code{FALSE} for screen devices.
\item[\code{clickToConfirm}] logical: if true confirmation of a new frame
will be by clicking on the device rather than answering a problem in
the console.  Default \code{TRUE}.
\item[\code{fillOddEven}] logical controlling the polygon fill mode:  see
\code{\LinkA{polygon}{polygon}} for details.  Default \code{TRUE}.
\item[\code{family}] A length-one character vector specifying the default
font family.  See section `Fonts'.
\item[\code{antialias}] A length-one character vector, requesting control
over font antialiasing.  This is partially matched to
\code{"default"}, \code{"none"}, \code{"cleartype"} or
\code{"gray"}.  See the `Fonts' section.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
All these devices are implemented as variants of the same device.

All arguments of \code{windows} have defaults set by
\code{\LinkA{windows.options}{windows.options}}: the defaults given in the arguments section
are the defaults for the defaults.  These defaults also apply to the
internal values of \code{gamma}, \code{xpinch}, \code{ypinch},
\code{buffered}, \code{restoreConsole} and \code{antialias} for
\code{win.graph}, \code{x11} and \code{X11}.

The size of a window is computed from information provided about the
display: it depends on the system being configured accurately.
By default a screen device asks Windows for the number of pixels per
inch.  This can be overridden (it is often wrong) by specifying
\code{xpinch} and \code{ypinch}, most conveniently \emph{via}
\code{\LinkA{windows.options}{windows.options}}.  For example, a 13.3 inch 1280x800
screen (a typical laptop display) was reported as 96 dpi even though
it is physically about 114 dpi.

The different colours need to be distinguished carefully.  Areas
outside the device region are coloured in the Windows application background
colour.  The device region is coloured in the canvas colour.  This is
over-painted by the background colour of a plot when a new page is
called for, but that background colour can be transparent (and is by
default).  One difference between setting the canvas colour and the
background colour is that when a plot is saved the background
colour is copied but the canvas colour is not.  The argument \code{bg}
sets the initial value of \code{\LinkA{par}{par}("bg")} in base graphics and
\code{\LinkA{gpar}{gpar}("fill")} in grid graphics

Recorded plot histories are of class \code{"SavedPlots"}.  They have a
\code{print} method, and a subset method.  As the individual plots are
of class \code{"recordedplot"} they can be replayed by printing them:
see \code{\LinkA{recordPlot}{recordPlot}}.  The active plot history is stored in
variable \code{.SavedPlots} in the workspace.

When a screen device is double-buffered (the default) the
screen is updated 100ms after last plotting call or every 500ms during
continuous plotting.  These times can be altered by setting
\code{options("windowsTimeout")} to a vector of two integers before
opening the device.

Line widths as controlled by \code{par(lwd=)} are in multiples of
1/96inch.  Multiples less than 1 are allowed, down to one pixel width.

For \code{win.metafile} only one plot is allowed per file, and Windows
seems to disallow reusing the file.  So the \emph{only} way to allow
multiple plots is to use a parametrized \code{filename} as in the
example.  If the \code{filename} is omitted (or specified as
\code{""}), the output is copied to the clipboard when the device is
closed.

The \code{restoreConsole} argument is a temporary fix for a problem
in the current implementation of several Windows graphics devices,
and is likely to be removed in an upcoming release.  If set to
\code{FALSE}, the console will not receive the focus after the new
device is opened.  

There is support for semi-transparent colours of lines, fills and text
on the screen devices.  These work for saving (from the
`File' menu) to PDF, PNG, BMP, JPEG and TIFF, but will be ignored if
saving to Metafile and PostScript.
\end{Details}
%
\begin{Value}
A plot device is opened: nothing is returned to the \R{} interpreter.
\end{Value}
%
\begin{Section}{Resizing options}
If a screen device is re-sized, the default behaviour (\code{"R"}) is
to redraw the plot(s) as if the new size had been specified
originally.  Using \code{"fit"} will rescale the existing plot(s) to
fit the new device region, preserving the aspect ratio.  Using
\code{"fixed"} will leave the plot size unchanged, adding scrollbars
if part of the plot is obscured.

A graphics window will never be created at more than 85\% of
the screen width or height, but can be resized to a larger size.
For the first two \code{rescale} options the width and height are
rescaled proportionally if necessary, and if \code{rescale = "fit"}
the plot(s) are rescaled accordingly.  If \code{rescale = "fixed"}
the initially displayed portion is selected within these constraints,
separately for width and height.  In MDI mode,
the limit is 85\% of the MDI client region.

Using \code{\LinkA{strwidth}{strwidth}} or \code{\LinkA{strheight}{strheight}} after a window
has been rescaled (when using \code{"fit"}) gives dimensions in the
original units, but only approximately as they are derived from the
metrics of the rescaled fonts (which are in integer sizes)

The displayed region may be bigger than the `paper' size, and
area(s) outside the `paper' are coloured in the Windows
application background colour.  Graphics parameters such as
\code{"din"} refer to the scaled plot if rescaling is in effect.
\end{Section}
%
\begin{Section}{Fonts}
The fonts used for text drawn in a Windows device may be controlled in
two ways.  The file \code{R\_HOME\bsl{}etc\bsl{}\LinkA{Rdevga}{Rdevga}} can be used to
specify mappings for \code{par(font=)} (or the \pkg{grid} equivalent).
Alternatively, a font family can be specified by a non-empty
\code{family} argument (or by e.g. \code{par(family=)} in the graphics
package) and this will be used for fonts 1:4 via the Windows font
database (see \code{\LinkA{windowsFonts}{windowsFonts}}).

How the fonts look depends on the antialiasing settings, both through
the \code{antialias} argument and the machine settings.  These are
hints to Windows GDI that may not be able to be followed, but
\code{antialias = "none"} should ensure that no antialiasing is used.
For a screen device the default depends on the machine settings: it
will be \code{"cleartype"} if that has been enabled.  Note that the
greyscale antialiasing that is used only for small fonts (below about
9 pixels, around 7 points on a typical display).

When accessing a system through Remote Desktop, both the Remote
Desktop settings \emph{and} the user's local account settings are
relevant to whether antialiasing is used.

Some fonts are intended only to be used with ClearType antialiasing,
for example the \code{Meiryo} Japanese font.
\end{Section}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is 7 inches square, although this is
often incorrectly implemented by Windows: see `Details'.
\item Font sizes are in big points.
\item The default font family is Arial.
\item Line widths are as a multiple of 1/96 inch, with a minimum of
one pixel. 
\item The minimum radius of a circle is 1 pixel.
\item \code{pch="."} with \code{cex = 1} corresponds to a rectangle of sides
the larger of one pixel and 0.01 inch.
\item Colours are interpreted via the unprofiled colour mapping of
the graphics card -- this is \emph{assumed} to conform to sRGB.

\end{itemize}

\end{Section}
%
\begin{SeeAlso}\relax
\code{\LinkA{windowsFonts}{windowsFonts}},
\code{\LinkA{savePlot}{savePlot}}, \code{\LinkA{bringToTop}{bringToTop}},
\code{\LinkA{Devices}{Devices}}, \code{\LinkA{postscript}{postscript}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: ## A series of plots written to a sequence of metafiles
win.metafile("Rplot%02d.wmf", pointsize = 10)

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{windows.options}{Auxiliary Function to Set/View Defaults for Arguments of windows()}{windows.options}
\keyword{device}{windows.options}
%
\begin{Description}\relax
The auxiliary function \code{windows.options} can be used to set or view
(if called without arguments) the default values for the arguments of
\code{\LinkA{windows}{windows}}.

\code{windows.options} needs to be called before calling \code{windows},
and the default values it sets can be overridden by supplying
arguments to \code{windows}.

\end{Description}
%
\begin{Usage}
\begin{verbatim}
windows.options(..., reset = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{...}] arguments \code{width}, \code{height}, \code{pointsize},
\code{record}, \code{rescale}, \code{xpinch}, \code{ypinch},
\code{bg}, \code{canvas}, \code{gamma}, \code{xpos}, \code{ypos},
\code{buffered}, \code{restoreConsole}, \code{clickToConfirm},
\code{title}, \code{fillOddEven} and \code{antialias} can be supplied.
\item[\code{reset}] logical: should the defaults be reset to their
`factory-fresh' values?
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
If both \code{reset = TRUE} and \code{...} are supplied the defaults
are first reset to the `factory-fresh' values and then the new
values are applied.

Option \code{antialias} applies to screen devices (\code{windows},
\code{win.graph}, \code{X11} and \code{x11})).  There is a separate option,
\code{bitmap.aa.win}, for bitmap devices with \code{type = "windows"}.
\end{Details}
%
\begin{Value}
A named list of all the defaults.  If any arguments are supplied the
returned values are the old values and the result has the visibility
flag turned off.
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{windows}{windows}}, \code{\LinkA{ps.options}{ps.options}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
## Not run: 
## put something like this is your .Rprofile to customize the defaults
setHook(packageEvent("grDevices", "onLoad"),
        function(...)
            grDevices::windows.options(width=8, height=6,
                                       xpos=0, pointsize=10,
                                       bitmap.aa.win="cleartype"))

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{windowsFonts}{Windows Fonts}{windowsFonts}
\aliasA{windowsFont}{windowsFonts}{windowsFont}
\keyword{device}{windowsFonts}
%
\begin{Description}\relax
These functions handle the translation of a device-independent R graphics
font family name to a windows font description.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
windowsFont(family)

windowsFonts(...)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{family}] a character vector containing the font family name
(\code{"TT"} as the first two characters indicates a TrueType font).

\item[\code{...}] either character strings naming mappings to display,
or new (named) mappings to define.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
A windows device is created with a default font (see
the documentation for \code{windows}), but it is also possible
to specify a font family when drawing to the device (for example, see
the documentation for \code{"family"} in \code{\LinkA{par}{par}} and for
\code{"fontfamily"} in \code{\LinkA{gpar}{gpar}} in the \pkg{grid} package).

The font family sent to the device is a simple string name, which must be
mapped to something more specific to windows fonts.  A list of
mappings is maintained and can be modified by the user.

The \code{windowsFonts} function can be used to list existing
mappings and to define new mappings.  The \code{windowsFont}
function can be used to create a new mapping.

Default mappings are provided for three device-independent font family
names: \code{"sans"} for a sans-serif font, \code{"serif"} for a serif
font and \code{"mono"} for a monospaced font.

These mappings will only be used if the current font face is
1 (plain), 2 (bold), 3 (italic), or 4 (bolditalic).
\end{Details}
%
\begin{SeeAlso}\relax
\code{\LinkA{windows}{windows}}
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
windowsFonts()
windowsFonts("mono")

## Not run: ## set up for Japanese: needs the fonts installed
windows()  # make sure we have the right device type
Sys.setlocale("LC_ALL", "ja")
windowsFonts(JP1 = windowsFont("MS Mincho"),
             JP2 = windowsFont("MS Gothic"),
             JP3 = windowsFont("Arial Unicode MS"))
plot(1:10)
text(5, 2, "\u{4E10}\u{4E00}\u{4E01}", family = "JP1")
text(7, 2, "\u{4E10}\u{4E00}\u{4E01}", family = "JP1", font=2)
text(5, 1.5, "\u{4E10}\u{4E00}\u{4E01}", family = "JP2")
text(9, 2, "\u{5100}", family = "JP3")

## End(Not run)
\end{ExampleCode}
\end{Examples}
\HeaderA{xfig}{XFig Graphics Device}{xfig}
\keyword{device}{xfig}
%
\begin{Description}\relax
\code{xfig} starts the graphics device driver for producing XFig
(version 3.2) graphics.

The auxiliary function \code{ps.options} can be used to set and view
(if called without arguments) default values for the arguments to
\code{xfig} and \code{postscript}.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xfig(file = ifelse(onefile, "Rplots.fig", "Rplot%03d.fig"),
     onefile = FALSE, encoding = "none",
     paper = "default", horizontal = TRUE,
     width = 0, height = 0, family = "Helvetica",
     pointsize = 12, bg = "transparent", fg = "black",
     pagecentre = TRUE, defaultfont = FALSE, textspecial = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{file}] a character string giving the name of the file.   For use
with \code{onefile = FALSE} give a C integer format such as
\code{"Rplot\%03d.fig"} (the default in that case).
(See \code{\LinkA{postscript}{postscript}} for further details.)

\item[\code{onefile}] logical: if true allow multiple figures
in one file. If false, assume only one page per file and generate a
file number containing the page number.
\item[\code{encoding}] The encoding in which to write text strings.  The
default is not to re-encode.  This can be any encoding recognized by
\code{\LinkA{iconv}{iconv}}: in a Western UTF-8 locale you probably want to
select an 8-bit encoding such as \code{latin1}, and in an East Asian
locale an \code{EUC} encoding.  If re-encoding fails, the text
strings will be written in the current encoding with a warning.
\item[\code{paper}] the size of paper region.  The choices
are \code{"A4"}, \code{"Letter"} and \code{"Legal"} (and these
can be lowercase).  A further choice is \code{"default"}, which
is the default.  If this is selected, the papersize is taken
from the option \code{"papersize"} if that is set to a non-empty
value, otherwise \code{"A4"}.
\item[\code{horizontal}] the orientation of the printed image, a
logical.  Defaults to true, that is landscape orientation.
\item[\code{width, height}] the width and height of the
graphics region in inches.  The default is to use the entire
page less a 0.5 inch overall margin in each direction.  (See
\code{\LinkA{postscript}{postscript}} for further details.)
\item[\code{family}] the font family to be used.  This must be one
of \code{"AvantGarde"}, \code{"Bookman"}, \code{"Courier"},
\code{"Helvetica"} (the default), \code{"Helvetica-Narrow"},
\code{"NewCenturySchoolbook"}, \code{"Palatino"} or
\code{"Times"}.  Any other value is replaced by
\code{"Helvetica"}, with a warning.
\item[\code{pointsize}] the default point size to be used.
\item[\code{bg}] the initial background color to be used.
\item[\code{fg}] the initial foreground color to be used.
\item[\code{pagecentre}] logical: should the device region be centred on the
page?
\item[\code{defaultfont}] logical: should the device use xfig's default
font?
\item[\code{textspecial}] logical: should the device set the textspecial flag
for all text elements. This is useful when generating pstex from xfig
figures.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
Although \code{xfig} can produce multiple plots in one file, the XFig
format does not say how to separate or view them.  So
\code{onefile = FALSE} is the default.

The \code{file} argument is interpreted as a C integer format as used
by \code{\LinkA{sprintf}{sprintf}}, with integer argument the page number.
The default gives files \file{Rplot001.fig}, \dots, \file{Rplot999.fig},
\file{Rplot1000.fig}, \dots.  

Line widths as controlled by \code{par(lwd=)} are in multiples of
5/6*1/72 inch.  Multiples less than 1 are allowed.  \code{pch="."} with
\code{cex = 1} corresponds to a square of side 1/72 inch.  

Windows users can make use of WinFIG
(\url{http://www.schmidt-web-berlin.de/WinFIG.htm}, shareware), or
XFig under Cygwin.
\end{Details}
%
\begin{Section}{Conventions}
This section describes the implementation of the conventions for
graphics devices set out in the ``R Internals Manual''.

\begin{itemize}

\item The default device size is the paper size with a 0.25 inch
border on all sides.
\item Font sizes are in big points.
\item The default font family is Helvetica.
\item Line widths are integers, multiples of 5/432 inch.
\item Circle radii are multiples of 1/1200 inch.
\item Colours are interpreted by the viewing/printing application.

\end{itemize}

\end{Section}
%
\begin{Note}\relax
Only some line textures (\code{0 <= lty < 4}) are used.  Eventually this
may be partially remedied, but the XFig file format does not allow as
general line textures as the \R{} model.  Unimplemented line textures
are displayed as \emph{dash-double-dotted}.

There is a limit of 512 colours (plus white and black) per file.
\end{Note}
%
\begin{Author}\relax
Brian Ripley.  Support for \code{defaultFont} and \code{textSpecial}
contributed by Sebastian Fischmeister.
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{Devices}{Devices}},
\code{\LinkA{postscript}{postscript}},
\code{\LinkA{ps.options}{ps.options}}.
\end{SeeAlso}
\HeaderA{xy.coords}{Extracting Plotting Structures}{xy.coords}
\keyword{dplot}{xy.coords}
%
\begin{Description}\relax
\code{xy.coords} is used by many functions to obtain
x and y coordinates for plotting.  The use of this common mechanism
across all relevant \R{} functions produces a measure of consistency.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xy.coords(x, y = NULL, xlab = NULL, ylab = NULL, log = NULL,
          recycle = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y}] the x and y coordinates of a set of points.
Alternatively, a single argument \code{x} can be provided.
\item[\code{xlab,ylab}] names for the x and y variables to be extracted.
\item[\code{log}] character, \code{"x"}, \code{"y"} or both, as for
\code{\LinkA{plot}{plot}}.  Sets negative values to \code{\LinkA{NA}{NA}} and
gives a warning.
\item[\code{recycle}] logical; if \code{TRUE}, recycle (\code{\LinkA{rep}{rep}})
the shorter of \code{x} or \code{y} if their lengths differ.
\end{ldescription}
\end{Arguments}
%
\begin{Details}\relax
An attempt is made to interpret the arguments \code{x} and \code{y} in
a way suitable for bivariate plotting (or other bivariate procedures).

If \code{y} is \code{NULL} and \code{x} is a
\begin{description}

\item[formula:] of the form \code{yvar \textasciitilde{} xvar}. \code{xvar} and
\code{yvar} are used as x and y variables.

\item[list:] containing components \code{x} and \code{y}, these are
used to define plotting coordinates.

\item[time series:] the x values are taken to be
\code{\LinkA{time}{time}(x)} and the y values to be the time series.

\item[matrix or \code{\LinkA{data.frame}{data.frame}} with two or more
columns:] the first is assumed to contain the x values and the
second the y values.  \emph{Note} that is also true if \code{x}
has columns named \code{"x"} and \code{"y"}; these names will be
irrelevant here.

\end{description}

In any other case, the \code{x} argument is coerced to a vector and
returned as \bold{y} component where the resulting \code{x} is just
the index vector \code{1:n}.  In this case, the resulting \code{xlab}
component is set to \code{"Index"}.

If \code{x} (after transformation as above) inherits from class
\code{"POSIXt"} it is coerced to class \code{"POSIXct"}.
\end{Details}
%
\begin{Value}
A list with the components
\begin{ldescription}
\item[\code{x}] numeric (i.e., \code{"double"}) vector of abscissa values.
\item[\code{y}] numeric vector of the same length as \code{x}.
\item[\code{xlab}] \code{character(1)} or \code{NULL}, the `label' of
\code{x}.
\item[\code{ylab}] \code{character(1)} or \code{NULL}, the `label' of
\code{y}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{plot.default}{plot.default}}, \code{\LinkA{lines}{lines}}, \code{\LinkA{points}{points}}
and \code{\LinkA{lowess}{lowess}} are examples of functions which use this mechanism.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
xy.coords(stats::fft(c(1:9)), NULL)

with(cars, xy.coords(dist ~ speed, NULL)$xlab ) # = "speed"

xy.coords(1:3, 1:2, recycle=TRUE)
xy.coords(-2:10,NULL, log="y")
##> warning: 3 y values <=0 omitted ..
\end{ExampleCode}
\end{Examples}
\HeaderA{xyTable}{Multiplicities of (x,y) Points, e.g., for a Sunflower Plot}{xyTable}
\keyword{dplot}{xyTable}
%
\begin{Description}\relax
Given (x,y) points, determine their multiplicity -- checking for
equality only up to some (crude kind of) noise.  Note that this is
special kind of 2D binning.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xyTable(x, y = NULL, digits)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x,y}] numeric vectors of the same length; alternatively other
(x,y) argument combinations as allowed by \code{\LinkA{xy.coords}{xy.coords}(x,y)}.
\item[\code{digits}] integer specifying the significant digits to be used for
determining equality of coordinates.  These are compared after
rounding them via \code{\LinkA{signif}{signif}(*,digits)}.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list with three components of same length,
\begin{ldescription}
\item[\code{x}] x coordinates, rounded and sorted.
\item[\code{y}] y coordinates, rounded (and sorted within \code{x}).
\item[\code{number}] multiplicities (positive integers); i.e.,
\code{number[i]} is the multiplicity of \code{(x[i],y[i])}.
\end{ldescription}
\end{Value}
%
\begin{SeeAlso}\relax
\code{\LinkA{sunflowerplot}{sunflowerplot}} which typically uses
\code{xyTable()}; \code{\LinkA{signif}{signif}}.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
xyTable(iris[,3:4], digits = 6)

## Discretized uncorrelated Gaussian:

require(stats)
xy <- data.frame(x = round(sort(rnorm(100))), y = rnorm(100))
xyTable(xy, digits = 1)
\end{ExampleCode}
\end{Examples}
\HeaderA{xyz.coords}{Extracting Plotting Structures}{xyz.coords}
\keyword{dplot}{xyz.coords}
%
\begin{Description}\relax
Utility for obtaining consistent x, y and z coordinates and labels
for three dimensional (3D) plots.
\end{Description}
%
\begin{Usage}
\begin{verbatim}
xyz.coords(x, y = NULL, z = NULL,
           xlab = NULL, ylab = NULL, zlab = NULL,
           log = NULL, recycle = FALSE)
\end{verbatim}
\end{Usage}
%
\begin{Arguments}
\begin{ldescription}
\item[\code{x, y, z}] the x, y and z coordinates of a set of points.
Both \code{y} and \code{z} can be left at \code{NULL}.  In this
case, an attempt is made to interpret \code{x} in a way suitable for
plotting.

If the argument is a formula \code{zvar \textasciitilde{} xvar + yvar},
\code{xvar}, \code{yvar} and \code{zvar} are used as x, y and z
variables;
if the argument is a list containing components \code{x},
\code{y} and \code{z}, these are assumed to define plotting coordinates;
if the argument is a matrix or \code{\LinkA{data.frame}{data.frame}} with three
or more columns, the first is
assumed to contain the x values, the 2nd the y ones, and the 3rd the
z ones -- independently of any column names that \code{x} may have.

Alternatively two arguments \code{x} and \code{y} can be provided
(leaving \code{z = NULL}).  One may be real, the other complex;
in any other case, the arguments are coerced to vectors
and the values plotted against their indices.

\item[\code{xlab, ylab, zlab}] names for the x, y and z variables to be extracted.
\item[\code{log}] character, \code{"x"}, \code{"y"}, \code{"z"} or combinations.
Sets negative values to \code{\LinkA{NA}{NA}} and gives a warning.
\item[\code{recycle}] logical; if \code{TRUE}, recycle (\code{\LinkA{rep}{rep}}) the
shorter ones of \code{x}, \code{y} or \code{z} if their lengths differ.
\end{ldescription}
\end{Arguments}
%
\begin{Value}
A list with the components
\begin{ldescription}
\item[\code{x}] numeric (i.e., \code{\LinkA{double}{double}}) vector of abscissa values.
\item[\code{y}] numeric vector of the same length as \code{x}.
\item[\code{z}] numeric vector of the same length as \code{x}.
\item[\code{xlab}] \code{character(1)} or \code{NULL}, the axis label of \code{x}.
\item[\code{ylab}] \code{character(1)} or \code{NULL}, the axis label of \code{y}.
\item[\code{zlab}] \code{character(1)} or \code{NULL}, the axis label of \code{z}.
\end{ldescription}
\end{Value}
%
\begin{Author}\relax
Uwe Ligges and Martin Maechler
\end{Author}
%
\begin{SeeAlso}\relax
\code{\LinkA{xy.coords}{xy.coords}} for 2D.
\end{SeeAlso}
%
\begin{Examples}
\begin{ExampleCode}
xyz.coords(data.frame(10*1:9, -4), y = NULL, z = NULL)

xyz.coords(1:5, stats::fft(1:5), z = NULL, xlab = "X", ylab = "Y")

y <- 2 * (x2 <- 10 + (x1 <- 1:10))
xyz.coords(y ~ x1 + x2, y = NULL, z = NULL)

xyz.coords(data.frame(x = -1:9, y = 2:12, z = 3:13), y = NULL, z = NULL,
           log = "xy")
##> Warning message: 2 x values <= 0 omitted ...
\end{ExampleCode}
\end{Examples}
\clearpage
